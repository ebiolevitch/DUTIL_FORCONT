<%@ page language="java" contentType="text/html; charset=UTF-8"	pageEncoding="UTF-8"%><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="fr_FR" xml:lang="fr_FR">	<head>		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />		<title>Kit php pour customisation graphique</title>		<link rel="shortcut icon" type="image/x-icon" href="http://www.univ-nantes.fr/images/favicon.ico" />		<link rel="icon" type="image/png" href="http://www.univ-nantes.fr/images/favicon.png" />		<meta http-equiv="pragma" content="no-cache" />		<meta http-equiv="imagetoolbar" content="no" />		<meta name="mssmarttagspreventparsing" content="true" />		<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />		<meta name="DC.Title" content="Universit&eacute; de Nantes - Les actualit&eacute;s sur les formations, l'orientation, l'insertion professionnelle" />		<meta name="DC.Creator" content="Anne-Christelle SUIRE" />		<meta name="DC.Subject" lang="fr-FR" content="formation,recherche,universite,university,france,nantes" />		<meta name="DC.Description" lang="fr-FR" content="" />		<meta name="DC.Publisher" content="Anne-Christelle SUIRE" />		<meta name="DC.Date.created" scheme="W3CDTF" content="20081212" />		<meta name="DC.Date.modified" scheme="W3CDTF" content="20111214" />		<meta name="DC.Language" scheme="RFC3066" content="fr-FR" />		<meta name="DC.Rights" content="Copyright &copy; Universit&eacute; de Nantes" />		<meta name="author" lang="fr-FR" content="Anne-Christelle SUIRE" />		<meta name="keywords" content="formation,recherche,universite,university,france,nantes" />		<meta name="Date-Creation-yyyymmdd" content="20081212" />		<meta name="Date-Revision-yyyymmdd" content="20111214" />		<meta name="copyright" content="Copyright &copy; Universit&eacute; de Nantes" />		<meta name="reply-to" content="webmaster@univ-nantes.fr" />		<meta name="category" content="Internet" />		<meta name="robots" content="index, follow" />		<meta name="distribution" content="global" />		<meta name="identifier-url" content="http://www.univ-nantes.fr/" />		<meta name="resource-type" content="document" />		<meta name="expires" content="-1" />		<meta name="Generator" content="K-Sup" />		<meta name="Formatter" content="K-Sup" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/reset.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/police.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/ecran.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/scroll.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/formulaires.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/degrades.css" title="defaut" />		<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/social.css" title="defaut" />			<link rel="stylesheet" type="text/css" media="screen" href="custom.css" title="defaut" /><!---->                		<!--[if lte IE 9]>     	<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/lte_ie9.css" title="defaut" />		<![endif]-->		<!--[if lte IE 8]>     	<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/lte_ie8.css" title="defaut" />			<script type="text/javascript" src="http://www.univ-nantes.fr/jsp/scripts/DD_roundies_0.0.2a.js"></script>			<script type="text/javascript">		  	// DD_roundies.addRule('#profils', '10px 0 0 0');			</script>		<![endif]-->		<!--[if lte IE 7]>     	<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/lte_ie7.css" title="defaut" />		<![endif]-->				<script style="text/javascript" ><!--		document.write('<link rel="stylesheet" type="text/css" media="screen" href="http://www.univ-nantes.fr/jsp/styles/defaut/institutionnel/couleur_formation.css" title="defaut" />');//--></script>								        		<link rel="stylesheet" type="text/css" media="print" href="http://www.univ-nantes.fr/jsp/styles/defaut/impression.css" title="defaut" />		<script type="text/javascript">    	//<![CDATA[			if (window!=top){				top.location.href=location.href;			}			//]]>		</script>		<style type="text/css" media="screen">		</style>		<script type="text/javascript"  style="display:none"><!--/* 	ED - 12.07.2006	Fonction AddEvent de John Resig 	http://ejohn.org/projects/flexible-javascript-events/*/ function addEvent( obj, type, fn ) {   if ( obj.attachEvent ) {     obj['e'+type+fn] = fn;     obj[type+fn] = function(){obj['e'+type+fn]( window.event );}     obj.attachEvent( 'on'+type, obj[type+fn] );   } else     obj.addEventListener( type, fn, false ); }  function removeEvent( obj, type, fn ) {  if ( obj.detachEvent ) {    obj.detachEvent( 'on'+type, obj[type+fn] );    obj[type+fn] = null;  } else    obj.removeEventListener( type, fn, false );}var nomForm = "";/* Affichage d'une image type plan d'accï¿½s */function ouvrirFenetrePlan(url, nom) {   window.open(url, nom, "width=520,height=500,scrollbars=yes, status=yes");}function showMessageField(typeAide, f1, f2) {	showMessageField2(typeAide, f1, f2, '');}/* Demande d'affichage d'une fenetre par un champ */function showMessageField2(typeAide, f1, f2, form) {	numToolbox = '';	nomForm = form;	field1 = f1;	field2 = f2;	fieldRequete = '';	texte = '';	nomApplet = '';	// Type d'insertion (liste)	typeInsertion = '';	//AM 200309 : L'arbre des structures doit prendre en compte la langue courante dans le front office	if (typeAide.indexOf('structure') != -1) {	   	var indexSlash1 = typeAide.indexOf('/');		var lg = '';		var filtre = '';		if (indexSlash1 != -1)		{			var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);			if (indexSlash2 != -1)			{				lg = typeAide.substring(indexSlash1 + 1, indexSlash2);				filtre = typeAide.substring(indexSlash2 + 1);			}			else			{				lg = typeAide.substring(indexSlash1 + 1);			}		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&LANGUE='+lg+'&FILTRE='+filtre, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//JSS 20040419 : affichage arbre structure en fonction du perimetre (back-office)	else if (typeAide.indexOf('strbo/') != -1) {		// formatte comme suit strbo/type/objet/action/langue		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var indexSlash4 = typeAide.indexOf('/', indexSlash3 + 1);		var indexSlash5 = typeAide.indexOf('/', indexSlash4 + 1);		var permission = typeAide.substring(indexSlash1+1, indexSlash4);		var lg = typeAide.substring(indexSlash4+1, indexSlash5);		var filtre = typeAide.substring(indexSlash5+1, typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&PERMISSION='+permission+'&LANGUE='+lg+'&FILTRE='+filtre, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//FBI 20051110 : affichage arbre structure en front (filtre sur les structures non visibles)	else if (typeAide.indexOf('strfo') != -1) {	   	var indexSlash1 = typeAide.indexOf('/');		var lg = '';		var filtre = '';		if (indexSlash1 != -1)		{			var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);			if (indexSlash2 != -1)			{				lg = typeAide.substring(indexSlash1 + 1, indexSlash2);				filtre = typeAide.substring(indexSlash2 + 1);			}			else			{				lg = typeAide.substring(indexSlash1 + 1);			}		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&LANGUE='+lg+'&FILTRE='+filtre+'&FRONT=true', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	else if (typeAide == 'rubrique' || typeAide.indexOf('rubrique') != -1) {		if (typeAide == 'rubrique') {			 sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');		}		else {			 var lg = typeAide.substring(typeAide.indexOf('rubrique')+8,typeAide.length);			 if (lg != null && lg.length > 0)				 sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE&LANGUE='+lg, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');			 else				 sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');		 }	}	//JSS 20040419 : affichage arbre rubrique en fonction du perimetre (back-office)	else if (typeAide.indexOf('rubbo/') != -1)	{		// formatte comme suit rubbo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var permission = typeAide.substring(indexSlash1+1,typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE&PERMISSION='+permission, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}/* FBI : utiliser 'saisie_annuaire'	else if (typeAide == 'annuaire') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_ANNUAIRE&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "annuaire2", "width=500,height=400,top=210,left=310,scrollbars=yes,resizable=yes, status=yes");	}*/	else if (typeAide.indexOf('fichefil') != -1) {		var proc = typeAide.substring(typeAide.indexOf('fichefil')+8,typeAide.length).toUpperCase();		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC="+proc+"&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE", "fichefil", "width=500,height=500,top=210,left=310,scrollbars=yes, status=yes");	}	else if (typeAide == 'pagelibre') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PAGELIBRE&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=0", "pagelibre", "width=500,height=330,top=210,left=310,scrollbars=yes, status=yes");	}	/* AM 200309 creation de page libre */	else if (typeAide == ('pagelibre_creation')){		 field2="LIBELLE_CODE_PAGE_TETE";		 sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_PAGELIBRE&ACTION=AJOUTER&LANGUE=0&CODE_RUBRIQUE="+f2, "pagelibre_creation", "width=500,height=330,top=210,left=310,scrollbars=yes, status=yes");	}	// JSS 20040419 : arbre des groupes	else if (typeAide == 'groupe_dsi') {		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320,resizable=yes,status=yes');	}	//JSS 20040419 : affichage arbre groupe en fonction du perimetre (back-office)	else if (typeAide.indexOf('groupebo/') != -1)	{		// formatte comme suit groupebo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var permission = typeAide.substring(indexSlash1+1,typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&PERMISSION='+permission, 'menu2', 'scrollbars=yes,,resizable=yes,width=350,height=210,top=320,left=320, resizable=yes,status=yes');	}	else if (typeAide == 'public_vise_dsi') {		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&PUBLIC_VISE=1', 'menu2', 'scrollbars=yes,width=420,height=210,top=320,left=320, resizable=yes,status=yes');	}	// JSS 20040419 : arbre des groupes	else if (typeAide.indexOf('publicbo/') != -1)	{		// formatte comme suit publicbo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var permission = typeAide.substring(indexSlash1+1,typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&PUBLIC_VISE=1&PERMISSION='+permission, 'menu2', 'scrollbars=yes,width=420,height=210,top=320,left=320, resizable=yes,status=yes');	}	else if (typeAide == 'utilisateur') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=RECHERCHE_UTILISATEUR&ACTION=RECHERCHER", "annuaire2", "width=450,height=500,top=210,left=290,scrollbars=yes,resizable=yes,status=yes");	}/* FBI : utiliser 'saisie_formation'	else if (typeAide == 'formation') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_FORMATION&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "formation", "width=500,height=330,top=150,left=150,scrollbars=yes, status=yes");	}/* FBI : utiliser 'saisie_ueup'	else if (typeAide == 'ueup') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_UEUP&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "ueup", "width=500,height=330,top=150,left=150,scrollbars=yes, status=yes");	}*/	else if (typeAide == 'parcours') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_UEUP&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&TYPE=PARCOURS&LANGUE_ARTICLE=-1", "parcours", "width=500,height=330,top=150,left=150,scrollbars=yes, status=yes");	}	else if (typeAide.indexOf('parcoursM') != -1) {		var codeUe = typeAide.substring(9);		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_PARCOURS&ACTION=MODIFIER&CODE_UEUP_PARCOURS="+codeUe+"&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "parcours", "width=500,height=330,top=150,left=150,scrollbars=yes, status=yes");	}/* FBI : utiliser 'saisie_cours'	else if (typeAide == 'cours') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_COURS&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "ueup", "width=500,height=330,top=150,left=150,scrollbars=yes, status=yes");	}*/	else if (typeAide == 'photo') {		indice='';		if (f1=='' && f2=='')		{			indice = window.document.forms[indiceForm].NB_FICHIER_JOINT.value;			eval('window.document.forms[indiceForm].NO_FICHIER_JOINT.value = '+indice+'');		}		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=SELECTION&NO_FICHIER_JOINT="+indice, "photo", "width=650,height=535,top=20,left=100,scrollbars=yes, status=yes");	}	else if (typeAide == 'image') {       sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=SAISIE", "photo", "width=650,height=535,top=20,left=100,scrollbars=yes, status=yes");	}	else if (typeAide == 'document') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOCUMENT&ACTION=INSERER", "document", "width=400, height=200, top=20, left=100, scrollbars=yes, status=yes, status=yes");	}	else if (typeAide == 'documentfront') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOCUMENT_FRONT&ACTION=INSERER&SAISIE_FRONT=true", "document", "width=400, height=130, top=20, left=100, scrollbars=yes, status=yes");	}/* FBI : 20060109 : @deprecated	else if (typeAide == 'evenements')		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_EVENEMENTS&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "evenements", "width=350,height=300,top=150,left=150,scrollbars=yes, status=yes");*//* FBI : utiliser 'saisie_actualite'	else if (typeAide == 'actualites') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_ACTUALITE&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "actualites", "width=400,height=380,top=150,left=150,scrollbars=yes, status=yes");	}/* FBI : 20060109 : @deprecated	else if (typeAide == 'sites')		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_SITESLIEUX&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "sites", "width=350,height=300,top=150,left=150,scrollbars=yes, status=yes");*/	else if (typeAide == 'pagetete') {		sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=PAGE_TETE", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		pageTete = true;	}	else if (typeAide == 'commentaire') {    		sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=COMMENTAIRE", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		pageTete = true;	}	else if (typeAide == 'requete') {		field1 = "";		field2 = f2;		nomForm = "";		fieldRequete = f1;		if (field2 == 'STATS') {			field2 = "";			sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=LIEN_REQUETE&RESTRICTION=STATS", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		}		else {			field2 = "";			sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=LIEN_REQUETE&RESTRICTION=XML", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		}	}}/* Traitement des donnees resultats renvoyees par la fenetre mere */function saveField(objet, code, libelle) {	/* Cas de l'administration */	if (inBackOffice())	{		if (!pageTete) {				/* Cas de l'administration */				if (field1 != "")					eval( "window.document.forms[0]."+field1+".value = code;");				if (field2 != "")					eval( "window.document.forms[0]."+field2+".value = libelle;");								//AM 200501: parcours LMD				if(ajoutAuto != ""){					eval("ajouter"+ajoutAuto+"();");					ajoutAuto = "";				}				//AM 200501: parcours LMD				if(modifAuto != ""){					eval("validmodif"+modifAuto+"();");					modifAuto = "";				}							}else{				/* Cas d'une page de tete : on ajoute le type d'objet au code*/				if (field1 != "")					eval( "window.document.forms[0]."+field1+".value = code+',TYPE='+objet;");				if (field2 != "")					eval( "window.document.forms[0]."+field2+".value = objet + ' : ' +libelle;");			}	} else	{		/* Cas particulier du WEB */			var formCourant = "RECHERCHE_WEB";			if( nomForm.length > 0)				formCourant = nomForm;		if (field1 != "")			eval( "window.document."+formCourant+"."+field1+".value = code;");		if (field2 != "")			eval( "window.document."+formCourant+"."+field2+".value = libelle;");	}		if( fieldRequete != "") {		chaine = "\"OBJET="+objet;		if( code.length > 0)		{			chaine = chaine +"&"+code;		}		chaine = chaine +"\"";		eval( "window.document.forms[0]."+fieldRequete+".value = "+ chaine );	}  field1 = "";  field2 = "";  nomForm = "";  fieldRequete = "";  numToolbox = "";  texte = "";  nomApplet = "";    // JSS 20020612-001 Type d'insertion (liste)  typeInsertion="";		}function inBackOffice () {	for (i = 0; i < window.document.forms.length; i++)	{		if ( (window.document.forms[i].name == 'RECHERCHE_WEB' || window.document.forms[i].name == nomForm )			&& window.document.forms[i].name != "")			return false;	}	return true;}/* Affichage d'un calendrier pour les formulaires avec recherche par date */function affiche_calendrier(nom, form) {	if (document.getElementById) {		document.write("<a href=\"#\" onclick=\"window.open('/adminsite/calendrier/calendrierjs.html?champ=" + nom + "&form=" + form +"', 'calendrier', 'width=135, height=138, toolbar=no, location=no, status=yes, resizable=yes'); return false;\"><img src=\"/images/calendrier.png\" alt=\"calendrier\" title=\"choisir une date\"></a>");	}}/* Effacement du libelle d'un champ de recherche */function effacerTextField (zoneSaisie, zoneLibelle, value, libelle)	{	if (inBackOffice() )	{		/* Cas de l'administration */		eval( "window.document.forms[0]."+zoneSaisie+".value = value;");		eval( "window.document.forms[0]."+zoneLibelle+".value = libelle;");	} else	{		eval( "window.document.RECHERCHE_WEB."+zoneSaisie+".value = value;");		eval( "window.document.RECHERCHE_WEB."+zoneLibelle+".value = libelle;");	}}/* Activation du service selectionnï¿½ dans la liste des services */function activerService() {	var index = window.document.getElementById('selectservices').selectedIndex;	if( index == 0)		return;	var url = window.document.getElementById('selectservices').options[index].value;	/* Analyse target */	var indexTarget = url.indexOf(';');	if (indexTarget > 0) {		var target =  url.substring(0,indexTarget);		url = url.substring(indexTarget + 1);		window.open(url, target);	} else {		window.location.href=url.substring(1);	}}/* Affichage d'une image dans une popup */function afficheImage(source) {	// Ouverture du pop-up	window.open(source,'pop','status=no,directories=no,toolbar=no,location=no,menubar=no,scrollbars=yes,resizable=yes');}function atteindreAncre(ancre) {	if (ancre != 'null'){		window.location.href += '#' + ancre;	}}/* Fonction utilisï¿½e dans la recherche avancï¿½e pour rï¿½initialiser les formulaires */function viderFormulaire(criteres) {	criteres = criteres.split(";");	var champReinit = "";	var valeurChamp = "";		for (var i=0; i < (criteres.length); i++) {		champReinit = eval("document.RECHERCHE_WEB." + criteres[i].substring(0, criteres[i].indexOf("=")));		valeurChamp = criteres[i].substring(criteres[i].indexOf("=")+1);				champReinit.value = valeurChamp	}}function afficherBoutonImprimer(intitule) {	document.write('<span id="imprimer" onclick="window.print(); return false;">' + intitule + '</span>');}/* fonction permettant d'afficher ou de cacher un element par id (specific ï¿½ la fiche formation) */function montrerCacher_div(intitule) {	var oDiv = document.getElementById(intitule);	var oSpan =  document.getElementById(intitule + '_s');	var blksem = intitule.substr(0,6);		if (oDiv != null){		if (oDiv.style.display == 'none'){			oDiv.style.display = 'block';			if (oSpan != null){								if (blksem == 'blksem'){					oSpan.className = 'titre_ouvert_vert';				} else {					oSpan.className = 'titre_ouvert';				}				oSpan.title='Masquer les infos';			}		} else if (oDiv.style.display == 'block'){			oDiv.style.display = 'none';			if (oSpan != null){				if (blksem == 'blksem'){					oSpan.className = 'titre_cache_vert';				} else {					oSpan.className = 'titre_cache';				}				oSpan.title='Afficher les infos';			}		}			}}/* * Cache tous les divs ayant le mï¿½me prï¿½fixe */ function closeOpenAll() {	 var ouverture = true;	 var verifEtat = document.getElementById('tout_derouler');	 if (verifEtat !=null ){		 if (verifEtat.className == 'tout_derouler'){			 ouverture = true;		 } else {			 ouverture = false;		 } 		 var contenu_deco = document.getElementById('page');		   	 // on prend tous les fils 	   	 var filsContenu_deco = contenu_deco.getElementsByTagName("*");	   	 if (ouverture == true){			 for(var i=0; i<filsContenu_deco.length; i++){				if (filsContenu_deco[i].className == 'cache' || filsContenu_deco[i].className == 'ouvert' ){					filsContenu_deco[i].style.display = 'block';					filsContenu_deco[i].className = 'ouvert';														} 				if (filsContenu_deco[i].className == 'titre_cache'){					filsContenu_deco[i].className = 'titre_ouvert'					filsContenu_deco[i].title = 'Masquer les infos';				}				verifEtat.className = 'tout_fermer';				verifEtat.innerHTML = 'Masquer toutes les infos';				verifEtat.title = 'Masquer toutes les infos';			 }	   	 } else {	   		 for(var i=0; i<filsContenu_deco.length; i++){				 if (filsContenu_deco[i].className == 'cache' || filsContenu_deco[i].className == 'ouvert' ){					filsContenu_deco[i].style.display = 'none';					filsContenu_deco[i].className = 'cache';				}				 if (filsContenu_deco[i].className == 'titre_ouvert'){						filsContenu_deco[i].className = 'titre_cache';						filsContenu_deco[i].title = 'Afficher les infos';				}				 verifEtat.className = 'tout_derouler';				 verifEtat.innerHTML = 'Afficher toutes les infos';				 verifEtat.title = 'Afficher toutes les infos';			 }	   	 }	 }  }  /* fonction permettant d'affiche une combo specific ï¿½ la rechercher fiche formation */ function affiner_recherche() {	 var oAffinerRech2 = document.getElementById('affiner_recherche_2');	 var oAffinerRech3 = document.getElementById('affiner_recherche_3');	  	if (oAffinerRech2 != null && oAffinerRech2.style.display == 'none'){ 		oAffinerRech2.style.display = 'block'; 	} else if (oAffinerRech3 != null && oAffinerRech3.style.display == 'none'){ 		oAffinerRech3.style.display = 'block';	} else {		alert('3 débouchés naturels maximum')	} 		} /* fonction permettant de selectionner le type d'objet qui doivent ï¿½tre recherchï¿½s avec le formulaire de recherche */	 function rechercherTypeObjet(objet) {		 var oRechercherType = document.getElementById('RECHERCHER_TYPE_OBJET');		 var oLabelAnnuaire = document.getElementById('lab_recherche_annuaire');		 var oLabelSite = document.getElementById('lab_recherche_site');		 if (oRechercherType != null) {			 if (objet == 'ANNUAIREKSUP') {				 oRechercherType.value = objet;				 oLabelAnnuaire.className  = 'encours';				 oLabelSite.className  = '';			 } else {				 oRechercherType.value = 'TOUS';				 oLabelAnnuaire.className  = '';				 oLabelSite.className  = 'encours';			 }		 }}	  /* Activation du service selectionnï¿½ dans la liste des services */ function rechercherAutreObjet() { 	var index = window.document.getElementById('selecttyperecherche').selectedIndex; 	var url = window.document.getElementById('selecttyperecherche').options[index].value; 		window.location.href=url; } /* Affiche le type de choix de recherche (tout le site / annuaire) du service selectionnï¿½ dans la liste des services */ function afficherChoixTypeRecherche() {	 var oRechercherType = document.getElementById('RECHERCHER_TYPE_OBJET');	 if (oRechercherType != null) {		 rechercherTypeObjet(oRechercherType.value);	 }	 var zoneBouton = window.document.getElementById('type_recherche');	 if (zoneBouton != null) {		 zoneBouton.style.visibility = 'visible';	 } }//--></script>		<script type="text/javascript"  style="display:none"><!--/*	ED - 12.07.2006		Script pour gerer les menus deroulants structures comme des listes <ul> imbriquees.	Les listes <ul> parentes (ou le menu de plus haut niveau) doient avoir une classe dont	la valeur est definie ici par la variable : classeMenuDeroulant		initMenus() parcour le document a la recherche des listes <ul> possedant cette classe	et attache des gestionnaires d evenements aux <li> qui contiennent des sous menus	pour les faire apparaitre et disparaitre au survol		Attention: la fonction addEvent() definie dans defaut.js est requise !*/var classeMenuDeroulant = /menu_deroulant/;/*	Attache les gestionnaires d evenements aux lis qui ont des sous menus*/function initMenus() {	var menu, menus, lis, liSousMenus;	if(document.getElementById && document.getElementsByTagName){			menus = document.getElementsByTagName("ul");			if(menus.length > 0 ){				for(var j=0; j<menus.length; j++){					if(menus[j].className.match(classeMenuDeroulant)){						menu = menus[j];						lis = menu.getElementsByTagName("li");						for(var i=0; i<lis.length; i++){							liSousMenus = lis[i].getElementsByTagName("ul");							if(liSousMenus.length > 0){								// a un sous-menu								addEvent(lis[i],"mouseover", montrePremierSousMenu);								addEvent(lis[i],"focus", montrePremierSousMenu);								addEvent(lis[i],"mouseout", cachePremierSousMenu);									addEvent(lis[i],"blur", cachePremierSousMenu);								}						}					} 				}			}	}}/*	Montre et cache les sous menus*/function montrePremierSousMenu(){	this.getElementsByTagName("ul")[0].style.display = "block";	/*this.style.backgroundColor = "#EDF4F9";*/}function cachePremierSousMenu(){	this.getElementsByTagName("ul")[0].style.display = "none";	/*this.style.backgroundColor = "#fff";*/}/*	Appelle initMenus() au chargement de la page*/addEvent(window,"load", initMenus);//--></script>		<script type="text/javascript"  style="display:none"><!--/** * SWFObject v1.5: Flash Player detection and embed - http://blog.deconcept.com/swfobject/ * * SWFObject is (c) 2007 Geoff Stearns and is released under the MIT License: * http://www.opensource.org/licenses/mit-license.php * */if(typeof deconcept=="undefined"){var deconcept=new Object();}if(typeof deconcept.util=="undefined"){deconcept.util=new Object();}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object();}deconcept.SWFObject=function(_1,id,w,h,_5,c,_7,_8,_9,_a){if(!document.getElementById){return;}this.DETECT_KEY=_a?_a:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(_1){this.setAttribute("swf",_1);}if(id){this.setAttribute("id",id);}if(w){this.setAttribute("width",w);}if(h){this.setAttribute("height",h);}if(_5){this.setAttribute("version",new deconcept.PlayerVersion(_5.toString().split(".")));}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true;}if(c){this.addParam("bgcolor",c);}var q=_7?_7:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var _c=(_8)?_8:window.location;this.setAttribute("xiRedirectUrl",_c);this.setAttribute("redirectUrl","");if(_9){this.setAttribute("redirectUrl",_9);}};deconcept.SWFObject.prototype={useExpressInstall:function(_d){this.xiSWFPath=!_d?"expressinstall.swf":_d;this.setAttribute("useExpressInstall",true);},setAttribute:function(_e,_f){this.attributes[_e]=_f;},getAttribute:function(_10){return this.attributes[_10];},addParam:function(_11,_12){this.params[_11]=_12;},getParams:function(){return this.params;},addVariable:function(_13,_14){this.variables[_13]=_14;},getVariable:function(_15){return this.variables[_15];},getVariables:function(){return this.variables;},getVariablePairs:function(){var _16=new Array();var key;var _18=this.getVariables();for(key in _18){_16[_16.length]=key+"="+_18[key];}return _16;},getSWFHTML:function(){var _19="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath);}_19="<embed type=\"application/x-shockwave-flash\" src=\""+this.getAttribute("swf")+"\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\"";_19+=" id=\""+this.getAttribute("id")+"\" name=\""+this.getAttribute("id")+"\" ";var _1a=this.getParams();for(var key in _1a){_19+=[key]+"=\""+_1a[key]+"\" ";}var _1c=this.getVariablePairs().join("&");if(_1c.length>0){_19+="flashvars=\""+_1c+"\"";}_19+="/>";}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath);}_19="<object id=\""+this.getAttribute("id")+"\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\">";_19+="<param name=\"movie\" value=\""+this.getAttribute("swf")+"\" />";var _1d=this.getParams();for(var key in _1d){_19+="<param name=\""+key+"\" value=\""+_1d[key]+"\" />";}var _1f=this.getVariablePairs().join("&");if(_1f.length>0){_19+="<param name=\"flashvars\" value=\""+_1f+"\" />";}_19+="</object>";}return _19;},write:function(_20){if(this.getAttribute("useExpressInstall")){var _21=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(_21)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=(typeof _20=="string")?document.getElementById(_20):_20;n.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"));}}return false;}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var _23=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_23=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _26=3;while(axo){try{_26++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_26);_23=new deconcept.PlayerVersion([_26,0,0]);}catch(e){axo=null;}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_23=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always";}catch(e){if(_23.major==6){return _23;}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(e){}}if(axo!=null){_23=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));}}}return _23;};deconcept.PlayerVersion=function(_29){this.major=_29[0]!=null?parseInt(_29[0]):0;this.minor=_29[1]!=null?parseInt(_29[1]):0;this.rev=_29[2]!=null?parseInt(_29[2]):0;};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major){return false;}if(this.major>fv.major){return true;}if(this.minor<fv.minor){return false;}if(this.minor>fv.minor){return true;}if(this.rev<fv.rev){return false;}return true;};deconcept.util={getRequestParameter:function(_2b){var q=document.location.search||document.location.hash;if(_2b==null){return q;}if(q){var _2d=q.substring(1).split("&");for(var i=0;i<_2d.length;i++){if(_2d[i].substring(0,_2d[i].indexOf("="))==_2b){return _2d[i].substring((_2d[i].indexOf("=")+1));}}}return "";}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var _2f=document.getElementsByTagName("OBJECT");for(var i=_2f.length-1;i>=0;i--){_2f[i].style.display="none";for(var x in _2f[i]){if(typeof _2f[i][x]=="function"){_2f[i][x]=function(){};}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true;}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id];};}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;//--></script>		<script type="text/javascript"  style="display:none"><!--var field1 = "";var field2 = "";var fieldRequete = "";var texte = "";var nomApplet = "";var nomForm = "";var pageTete = false;//AM200501 : parcours LMDvar ajoutAuto="", modifAuto="";// JSS 20020612-001 Type d'insertion (liste)var typeInsertion="";/* ouverture d'une fenêtre centrée */function ouvrirPhoto(urlPhoto,largeur,hauteur) {  x = (screen.availWidth - largeur)/2;  y = (screen.availHeight - 30 - hauteur)/2;  attrs = "height="+ hauteur +", width="+ largeur +", left="+ x +", top="+ y;  if (y<0)  {	 attrs += ",scrollbars=yes"  }  fenetre = window.open(urlPhoto,'photo',attrs);}/* Demande d'affichage d'une fenetre au niveau du front office */function ouvrirFenetrePlan(url, nom) {   window.open(url, nom, "width=520,height=500,scrollbars=yes, status=yes, resizable=1");}/* Affichage de la phototheque */function showPhototheque( ) {        //EL 20051221 rajout resizable=yes   window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=ADMINISTRATION", "photo", "width=650,height=535,top=20,left=100,scrollbars=yes, status=yes,resizable=yes");}function showMessageField(typeAide, f1, f2) {	showMessageField2(typeAide, f1, f2, '');}/* Demande d'affichage d'une fenetre par un champ */function showMessageField2(typeAide, f1, f2, form) {	nomForm = form;	field1 = f1;	field2 = f2;	fieldRequete = '';	texte = '';	nomApplet = '';	// Type d'insertion (liste)	typeInsertion = '';	var oForm;	if (inBackOffice())	{		oForm = document.forms[0];	}	else {		if (form.length > 0) {			oForm = document.forms[form];		}		else {			oForm = document.forms['RECHERCHE_WEB'];		}	}	var value = oForm.elements[f1].value;	if (!value)           value="";	//AM 200309 : L'arbre des structures doit prendre en compte la langue courante dans le front office	if (typeAide.indexOf('structure') != -1) {	   	var indexSlash1 = typeAide.indexOf('/');		var lg = '';		var filtre = '';		if (indexSlash1 != -1)		{			var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);			if (indexSlash2 != -1)			{				lg = typeAide.substring(indexSlash1 + 1, indexSlash2);				filtre = typeAide.substring(indexSlash2 + 1);			}			else			{				lg = typeAide.substring(indexSlash1 + 1);			}		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&CODE='+value+'&LANGUE='+lg+'&FILTRE='+filtre, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//JSS 20040419 : affichage arbre structure en fonction du perimetre (back-office)	else if (typeAide.indexOf('strbo/') != -1) {		// formatte comme suit strbo/type/objet/action/langue		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var indexSlash4 = typeAide.indexOf('/', indexSlash3 + 1);		var indexSlash5 = typeAide.indexOf('/', indexSlash4 + 1);		var permission = typeAide.substring(indexSlash1+1, indexSlash4);		var lg = typeAide.substring(indexSlash4+1, indexSlash5);		var filtre = typeAide.substring(indexSlash5+1, typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&CODE='+value+'&PERMISSION='+permission+'&LANGUE='+lg+'&FILTRE='+filtre, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//FBI 20051110 : affichage arbre structure en front (filtre sur les structures non visibles)	else if (typeAide.indexOf('strfo') != -1) {	   	var indexSlash1 = typeAide.indexOf('/');		var lg = '';		var filtre = '';		if (indexSlash1 != -1)		{			var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);			if (indexSlash2 != -1)			{				lg = typeAide.substring(indexSlash1 + 1, indexSlash2);				filtre = typeAide.substring(indexSlash2 + 1);			}			else			{				lg = typeAide.substring(indexSlash1 + 1);			}		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=STRUCTURE&CODE='+value+'&LANGUE='+lg+'&FILTRE='+filtre+'&FRONT=true', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	else if (typeAide == 'rubrique' || typeAide.indexOf('rubrique') != -1) {		var lg = '';		var racine = '';		if (typeAide != 'rubrique') {			var indexSlash = typeAide.indexOf('/');			if (indexSlash != -1) { //typeAide du type rubrique/racine ou rubriquelangue/racine				racine = typeAide.substring(indexSlash + 1, typeAide.length);				lg = typeAide.substring(typeAide.indexOf('rubrique')+8, indexSlash);			}			else { //typeAide du type rubriquelangue				lg = typeAide.substring(typeAide.indexOf('rubrique')+8, typeAide.length);			}		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE&CODE='+value+'&LANGUE='+lg+'&RACINE='+racine, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//JSS 20040419 : affichage arbre rubrique en fonction du perimetre (back-office)	else if (typeAide.indexOf('rubbo/') != -1)	{		// formatte comme suit rubbo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var indexSlash4 = typeAide.indexOf('/', indexSlash3 + 1);		var permission = '';		var racine = '';		if( indexSlash3 != -1 ){ //typeAide du type rubbo/FICHE/OO15/C/racine			permission = typeAide.substring(indexSlash1+1,indexSlash4);			racine = typeAide.substring(indexSlash4+1,typeAide.length);		}		else if( indexSlash2 != -1) { //typeAide du type rubbo//racine			permission = typeAide.substring(indexSlash1+1,indexSlash2);			racine = typeAide.substring(indexSlash2+1,typeAide.length);		}		else {			permission = typeAide.substring(indexSlash1+1,typeAide.length);		}		sList = window.open('/adminsite/menu/menu.jsp?MODE=RUBRIQUE&CODE='+value+'&PERMISSION='+permission+'&RACINE='+racine, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	// JSS 20040419 : arbre des groupes	else if (typeAide == 'groupe_dsi') {		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&CODE='+value, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	//JSS 20040419 : affichage arbre groupe en fonction du perimetre (back-office)	else if (typeAide.indexOf('groupebo/') != -1)	{		// formatte comme suit groupebo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var permission = typeAide.substring(indexSlash1+1,typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&CODE='+value+'&PERMISSION='+permission, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	else if (typeAide == 'public_vise_dsi') {		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&CODE='+value+'&PUBLIC_VISE=1', 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	// JSS 20040419 : arbre des groupes	else if (typeAide.indexOf('publicbo/') != -1) {		// formatte comme suit publicbo/type/objet/action		var indexSlash1 = typeAide.indexOf('/');		var indexSlash2 = typeAide.indexOf('/', indexSlash1 + 1);		var indexSlash3 = typeAide.indexOf('/', indexSlash2 + 1);		var permission = typeAide.substring(indexSlash1+1,typeAide.length);		sList = window.open('/adminsite/menu/menu.jsp?MODE=GROUPE&CODE='+value+'&PUBLIC_VISE=1&PERMISSION='+permission, 'menu2', 'scrollbars=yes, resizable=yes, status=yes, width=600, height=400, top=320, left=320');	}	else if (typeAide.indexOf('fichefil') != -1) {		var proc = typeAide.substring(typeAide.indexOf('fichefil')+8,typeAide.length).toUpperCase();		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC="+proc+"&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE", "fichefil", "width=500,height=500,top=210,left=310,scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'pagelibre') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PAGELIBRE&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=0", "pagelibre", "width=500,height=330,top=210,left=310, scrollbars=yes, resizable=yes, status=yes");	}	/* AM 200309 creation de page libre */	else if (typeAide == ('pagelibre_creation')){		 field2="LIBELLE_CODE_PAGE_TETE";		 sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_PAGELIBRE&ACTION=AJOUTER&LANGUE=0&CODE_RUBRIQUE="+f2, "pagelibre_creation", "width=500,height=330,top=210,left=310, scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'utilisateur') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_UTILISATEUR&ACTION=RECHERCHER&MODE=RECHERCHE", "utilisateur", "width=550, height=500, top=210, left=290, scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'phototheque') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=PHOTOTHEQUE", "photo", "width=650,height=535,top=20,left=100, scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'photo') {		indice='';		if (f1=='' && f2=='')		{			indice = window.document.forms[indiceForm].NB_FICHIER_JOINT.value;			eval('window.document.forms[indiceForm].NO_FICHIER_JOINT.value = '+indice+'');		}		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=SELECTION&NO_FICHIER_JOINT="+indice, "photo", "width=650,height=535,top=20,left=100, scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'image') {		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=SAISIE", "photo", "width=650,height=535,top=20,left=100, scrollbars=yes, resizable=yes, status=yes");	}	else if (typeAide == 'pagetete') {		sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=PAGE_TETE", "list", "width=520,height=440,top=10,left=100, scrollbars=yes, resizable=yes, status=yes");		pageTete = true;	}	else if (typeAide == 'commentaire') {    		sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=COMMENTAIRE", "list", "width=500,height=330,top=100,left=100, scrollbars=yes, resizable=yes, status=yes");		pageTete = true;	}	else if (typeAide == 'requete') {		field1 = "";		field2 = f2;		nomForm = "";		fieldRequete = f1;		if (field2 == 'STATS') {			field2 = "";			sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=LIEN_REQUETE&RESTRICTION=STATS", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		}		else {			field2 = "";			sList = window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=LIEN_REQUETE&RESTRICTION=XML", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		}	}}/* Demande d'affichage d'une fenetre par un champ en front */function showMessageChamp(typeAide, f1, f2, nomFormulaire){	if (typeAide.indexOf('structure') != -1)	{		 typeAide = 'strfo' + typeAide.substring(typeAide.indexOf('structure')+9, typeAide.length);	}	showMessageField2 (typeAide, f1, f2, nomFormulaire);}/* Ouvre la popup de recherche d'un objet */function ouvrirFenetreRechercheParProcessus(processus, f1, f2) {	field1 = f1;	field2 = f2;	nomForm = "";	fieldRequete = "";	texte = "";	nomApplet = "";	typeInsertion="";	nomFenetre ="";	if (processus.indexOf('&')!=-1)	{		nomFenetre = processus.substring(0,processus.indexOf('&'));	}	sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC="+processus+"&ACTION=RECHERCHER&TOOLBOX=LIEN_INTERNE&LANGUE_ARTICLE=-1", "RECHERCHE_"+nomFenetre, "width=500, height=330, top=150, left=150, scrollbars=yes, resizable=yes, status=yes");}/* Demande d'affichage d'une fenetre par un textarea */function showMessageTextArea (typeAide, langue, toolboxName) {		nomApplet = "";	// JSS 20020612-001 Type d'insertion (liste)	typeInsertion="";	texte = toolboxName;	field1 = "";	field2 = "";	nomForm = "";	fieldRequete = "";	// JSS 20020612-001 Type d'insertion (liste)	if (typeAide == 'liste') {		sList =  window.open("/adminsite/toolbox/choix_objet.jsp?TOOLBOX=LIEN_REQUETE&LISTE_INCLUSE=1", "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");		typeInsertion = "liste";	}	if (typeAide == 'lien')		sList = window.open("/adminsite/toolbox/choix_lien.jsp?LANGUE_ARTICLE="+langue, "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");	if (typeAide == 'mailto')		sList = window.open("/adminsite/toolbox/mailto.jsp?LANGUE_ARTICLE="+langue, "list", "width=500,height=330,top=100,left=100,scrollbars=yes,status=yes");	if (typeAide == 'image')		sList = window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=SAISIE_PHOTO&ACTION=RECHERCHER&MODE_PHOTOTHEQUE=INSERTION", "photo", "width=650,height=535,top=20,left=100,scrollbars=yes");}function inBackOffice() {	for (i = 0; i < window.document.forms.length; i++)	{		if ( (window.document.forms[i].name == 'RECHERCHE_WEB' || window.document.forms[i].name == nomForm )			&& window.document.forms[i].name != "")			return false;	}	return true;}// JSS 20020612-001 Type d'insertion (liste)/* Remplacement des & par des # (plantage NetWord) */function conversionRequete (objet,  code)	{	do	{	  i =  code.indexOf('&');	  if (i != -1)	{		code = code.substring(0,i) + "#" + code.substring(i+1, code.length);	  }	}	while (i != -1);	param = "objet="+objet;	if (code.length > 0)	   param = param + "#" + code;	return param;}/* Effacement du libelle d'un champ de recherche */function effacerTextField (zoneSaisie, zoneLibelle, value, libelle)	{	if (inBackOffice()) {		/* Cas de l'administration */		eval( "window.document.forms[0]."+zoneSaisie+".value = value;");		eval( "window.document.forms[0]."+zoneLibelle+".value = libelle;");		eval( "window.document.forms[0]."+zoneLibelle+".title = '';");	}	else {		eval( "window.document.RECHERCHE_WEB."+zoneSaisie+".value = value;");		eval( "window.document.RECHERCHE_WEB."+zoneLibelle+".value = libelle;");		eval( "window.document.RECHERCHE_WEB."+zoneLibelle+".title = '';");	}}/* Effacement du libelle d'un champ de recherche */function effacerTextChamp( zoneSaisie, zoneLibelle, value, libelle, nomForm)	{		eval( "window.document."+nomForm+"."+zoneSaisie+".value = value;");		eval( "window.document."+nomForm+"."+zoneLibelle+".value = libelle;");}/* Renvoyer des valeurs a la fenetre fille */function renvoyerNewLien(nouveauLien)	{	window.opener.modifieLien(nouveauLien);	window.close();}/* Renvoyer des valeurs a la fenetre fille */function renvoyerValeurs(objet, code, libelle, sInfobulle){	if (window.opener && ! window.opener.closed)	{		// cas d'une modification de lien		if (window.opener.liendanskt)		{			window.opener.modifieLien(objet, code, libelle);		}		// cas d'un rattachement rubrique par exemple		else if (window.opener.field1 != "" || window.opener.field2 != "" || window.opener.fieldRequete != "")		{			window.opener.saveField(objet, code, libelle, sInfobulle);		}		// cas d'un lien dans la toolbox		else		{			window.opener.save(objet, code, libelle); // tag kportal dans la toolbox		}	}	window.close();}/* Traitement des donnees resultats renvoyees par la fenetre mere */function saveField(objet, code, libelle, sInfobulle) {	/* Cas de l'administration */	if (inBackOffice())	{		if (! pageTete) {			/* Cas de l'administration */			if (field1 != "")				eval( "window.document.forms[0]."+field1+".value = code;");			if (field2 != "")			{				var oLabelField = window.document.forms[0].elements[field2];				oLabelField.value = libelle;				oLabelField.title = (sInfobulle ? sInfobulle : libelle);			}			/*AM 200501: parcours LMD			if (ajoutAuto != "") {				eval("ajouter"+ajoutAuto+"();");				ajoutAuto = "";			}			//AM 200501: parcours LMD			if (modifAuto != "") {				eval("validmodif"+modifAuto+"();");				modifAuto = "";			}*/		}		else {			/* Cas d'une page de tete : on ajoute le type d'objet au code */			if (field1 != "")				eval( "window.document.forms[0]."+field1+".value = code+',TYPE='+objet;");			if (field2 != "")				eval( "window.document.forms[0]."+field2+".value = objet + ' : ' +libelle;");		}	}	else {		/* Cas particulier du WEB */			var formCourant = "RECHERCHE_WEB";			if( nomForm.length > 0)				formCourant = nomForm;		if (field1 != "")			eval( "window.document."+formCourant+"."+field1+".value = code;");		if (field2 != "")		{			var oLabelField = window.document.forms[formCourant].elements[field2];			oLabelField.value = libelle;			/*if (sFilAriane)			{				oLabelField.title = sFilAriane;			}*/			oLabelField.title = (sInfobulle ? sInfobulle : libelle);		}	}		if (fieldRequete != "") {		chaine = "\"OBJET="+objet;		if( code.length > 0)		{			chaine = chaine +"&"+code;		}		chaine = chaine +"\"";		eval( "window.document.forms[0]."+fieldRequete+".value = "+ chaine );	}	field1 = "";	field2 = "";	nomForm = "";	fieldRequete = "";	texte = "";	nomApplet = "";	// JSS 20020612-001 Type d'insertion (liste)	typeInsertion="";			pageTete = false;}/* Renvoyer des valeurs a la fenetre fille */function renvoyerImage(id, height, width, alt, border, hspace, vspace, align){	if (window.opener && ! window.opener.closed)	{		window.opener.renvoyerImagePopup( id, height, width, alt, border, hspace, vspace, align)	}	window.close();}function renvoyerFormulaire(code, style,element){	if (window.opener && !window.opener.closed && window.opener.nomApplet != "")	{		window.opener.saveFormulaire(code,style,element);	}		window.close();}function renvoyerPageLibre(code, titre, langue) {	if (window.opener && !window.opener.closed)		window.opener.savePageLibre(code, titre, langue);	window.close();}function renvoyerDocument(id, titre, NOM_FICHIER_JOINT, POIDS_FICHIER_JOINT, FORMAT_FICHIER_JOINT, PATH_FICHIER_JOINT, NOMFORM){	if (window.opener && ! window.opener.closed)	{		if (window.opener.liendanskt)			window.opener.modifieLien("", id, "");		else if (window.opener.nomApplet != "")			window.opener.saveDocument(id, titre, NOM_FICHIER_JOINT, POIDS_FICHIER_JOINT, FORMAT_FICHIER_JOINT, PATH_FICHIER_JOINT, NOMFORM);		else			window.opener.saveFormDocument(id, titre, NOM_FICHIER_JOINT, POIDS_FICHIER_JOINT, FORMAT_FICHIER_JOINT, PATH_FICHIER_JOINT, NOMFORM);	}	window.close();}function saveFormDocument(id, titre, NOM_FICHIER_JOINT, POIDS_FICHIER_JOINT, FORMAT_FICHIER_JOINT, PATH_FICHIER_JOINT, NOMFORM)	{	var nomForm = '0';	if (NOMFORM)		nomForm=NOMFORM;	if (field1 != "") {  		eval( "window.document.forms['"+nomForm+"']."+field1+".value = id;");  		eval( "window.document.forms['"+nomForm+"']."+field2+".value = titre;");  		eval( "window.document.forms['"+nomForm+"'].NOM_"+field1+".value = NOM_FICHIER_JOINT;");  		eval( "window.document.forms['"+nomForm+"'].POIDS_"+field1+".value = POIDS_FICHIER_JOINT;");  		eval( "window.document.forms['"+nomForm+"'].FORMAT_"+field1+".value = FORMAT_FICHIER_JOINT;");  		eval( "window.document.forms['"+nomForm+"'].PATH_"+field1+".value = PATH_FICHIER_JOINT;");	}	if( texte != "") {		var codeHtml = '<a';		codeHtml += " href=\"[id-document];"+id+"[/id-document]\" >";		codeHtml += titre+"</a>";		insererTexte( texte, codeHtml);	}	field1 = "";	field2 = "";	nomForm = "";	fieldRequete = "";	texte = "";	nomApplet = "";}/* Ouverture d'une nouvelle fenetre fille */function ouvrir_fen (url) {	Xmas95 =new Date();	secs = Xmas95.getSeconds();	var name = "win" + secs;        //EL 20051221 rajout resizable=yes pour IE :	window.open(url,name,'status=yes,toolbar=no,scrollbars=yes,width=600,height=550,resizable=yes');}function ouvrir_fen_web (url) {	Xmas95 =new Date();	secs = Xmas95.getSeconds();	var name = "win" + secs;	window.open(url,name,'status=yes,menubar=yes, toolbar=yes, resizable=yes, scrollbars=yes, width=600, height=400');}function ouvrir_fen_x_y (url, x, y) {	Xmas95 =new Date();	secs = Xmas95.getSeconds();	var name = "win" + secs;	window.open(url,name,'resizable=yes,status=yes,toolbar=no,scrollbars=yes,width='+x+',height='+y);}function ouvrir_fen_w_h_name(url, width, height, name){	window.open(url,name,'status=yes,toolbar=no,scrollbars=yes,width='+width+',height='+height);} /* Nettoyage du code HTML avant de l'envoyer dans l'url */function nettoyerCodeHTML ( s) {	/* Suppression des caracteres dont code > 255 : fait planter url 	   (peuvent etre inseres par coller)	*/	s2 = s;	for (i=0; i<s2.length;i++){		var charCode = s2.charCodeAt ( i);		if ( charCode > 255) {			// Traitement special pour caractere 8217			if( charCode == 8217)				s2 = s2.substring( 0, i) + "'" + s2.substring( i+1, s2.length);			else if( charCode == 8364)				s2 = s2.substring( 0, i) + "&euro;" + s2.substring( i+1, s2.length);			else if( charCode == 8211)				s2 = s2.substring( 0, i) + "-" + s2.substring( i+1, s2.length);			else if( charCode == 8230)				s2 = s2.substring( 0, i) + "..." + s2.substring( i+1, s2.length);						else if( charCode == 339) 				s2 = s2.substring( 0, i) + "&oelig;" + s2.substring( i+1, s2.length);			else				s2 = s2.substring( 0, i) + s2.substring( i+1, s2.length);			//JSS 20020923-001			i=i-1;		}	}	if (s2 == '<p>&nbsp;</p>' || s2 == '<br />')	{		s2 = '';	}	return s2;}// RP 20041611 ajout fonctions collaboratif /* Gestion des fichiers joints */var arrayFichiergw = new Array(); var arrayFichierJointUnique = new Array();var modeFichier = "";var espace = "";var indiceForm = "";// constructeur de la classefunction Fichiergw(p1, p2, p3, p4, p5, p6){	this.id = p1;	this.nom = p2;	this.format = p3;	this.version = p4;	this.date = p5;	this.poids = p6;}// ajout d'un fichier// appel du processus TRAITEMENT_FICHIERGW_FRONTfunction ajouterFichiergw(indice,saisieFront){	if (saisieFront==null)		 saisieFront= '';	if (indice && indice!=''){		eval( "window.document.forms[0].NO_FICHIER_JOINT.value = "+indice+"");	}	else{		indice = window.document.forms[indiceForm].NB_FICHIER_JOINT.value;		eval('window.document.forms[indiceForm].NO_FICHIER_JOINT.value = '+indice+'');	}	if (modeFichier.indexOf('document') !=-1){		window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_FICHIERGW_FRONT&ACTION=INSERER"+saisieFront+"&NO_FICHIER_JOINT="+indice+"&MODE="+modeFichier+"&ESPACE="+espace+"", "fichiergw", "width=600, height=300, resizable=yes, scrollbars=yes, status=no");	}	else{		window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_FICHIERGW_FRONT&ACTION=INSERER"+saisieFront+"&NO_FICHIER_JOINT="+indice+"&MODE="+modeFichier+"&ESPACE="+espace+"", "fichiergw", "width=600, height=300, resizable=yes, scrollbars=yes, status=no");	}}// suppression d'un fichier uniquement javascript// traitement physique a la validationfunction supprimerFichiergw(indice){	reponse=confirm("Supprimer définitivement le fichier?");	if (reponse){				//mise à jour du poids total des fichiers ajoutés		if( window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS) {			var totalPoids = parseInt(window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS.value)-parseInt(arrayFichiergw[indice].poids);			eval('window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS.value = '+totalPoids+'');		}				arrayFichiergw[indice] = null;		preparerFichiergw();	}}// renvoi du fichier a la fin du processus TRAITEMENT_FICHIERGW_FRONTfunction renvoyerFichiergw(ID_FICHIER_JOINT, NOM_FICHIER_JOINT, FORMAT_FICHIER_JOINT, VERSION_FICHIER_JOINT, DATE_FICHIER_JOINT, NO_FICHIER_JOINT,MODE, POIDS_FICHIER) {	window.opener.saveFormFichiergw(ID_FICHIER_JOINT, NOM_FICHIER_JOINT, FORMAT_FICHIER_JOINT, VERSION_FICHIER_JOINT, DATE_FICHIER_JOINT, NO_FICHIER_JOINT,MODE, POIDS_FICHIER);	window.close();}function saveFormFichiergw(ID_FICHIER_JOINT, NOM_FICHIER_JOINT, FORMAT_FICHIER_JOINT, VERSION_FICHIER_JOINT, DATE_FICHIER_JOINT, NO_FICHIER_JOINT,MODE, POIDS_FICHIER)	{		var fic = new Fichiergw(ID_FICHIER_JOINT,NOM_FICHIER_JOINT,FORMAT_FICHIER_JOINT,VERSION_FICHIER_JOINT,DATE_FICHIER_JOINT,POIDS_FICHIER);		if (MODE.indexOf('simple') !=-1){			arrayFichierJointUnique[NO_FICHIER_JOINT]=fic;			preparerFichiergwUnique(NO_FICHIER_JOINT);		}		else{			arrayFichiergw[NO_FICHIER_JOINT]=fic;			preparerFichiergw();			if( window.document.forms[indiceForm].NB_FICHIER_JOINT){				t = parseInt(window.document.forms[indiceForm].NB_FICHIER_JOINT.value)+1;				eval('window.document.forms[indiceForm].NB_FICHIER_JOINT.value = '+t+'');			}						//mise à jour du poids total des fichiers ajoutés			if( window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS){				var totalPoids = parseInt(window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS.value)+parseInt(POIDS_FICHIER);				eval('window.document.forms[indiceForm].POIDS_TOTAL_FICHIERS.value = '+totalPoids+'');			}		}}// preparation pre-validation// concatenation du tableau de fichiers pour sauvegardefunction preparerFichiergw(){		var temp = '';		for (i=0;i<arrayFichiergw.length;i++){				if(arrayFichiergw[i]){				if (temp.length>0){					temp += "|";				}				temp += arrayFichiergw[i].id+";"+arrayFichiergw[i].nom+";"+arrayFichiergw[i].format+";"+arrayFichiergw[i].version+";"+arrayFichiergw[i].date+";"+arrayFichiergw[i].poids;			}		}		window.document.forms[indiceForm].TOTAL_FICHIER_JOINT.value = temp;	affichageFichiergw();}// affichage des fichiers// soit une liste si n fichiers// soit un fichier unique (ex:logo)function affichageFichiergw(){	var temp = '';	var div = document.getElementById('inner-fichier');	if (modeFichier.indexOf('document') !=-1)	{		// specifique pour les fichiers avec gestion de version		for (i=0;i<arrayFichiergw.length;i++){				if(arrayFichiergw[i]){				temp += "<tr><td><input type=\"input\" id=\"version-fichier\" class=\"champ-saisie\" readonly=\"readonly\" name=\"VERSION_FICHIER_JOINT_"+i+"\" size=\"1\" value=\""+arrayFichiergw[i].version+"\" /></td>";				temp += "<td><input type=\"input\" id=\"date-fichier\" class=\"champ-saisie\" readonly=\"readonly\" name=\"DATE_FICHIER_JOINT_"+i+"\" size=\"6\" value=\""+arrayFichiergw[i].date+"\" /></td>";				temp += "<td><input type=\"input\" id=\"libelle-fichier\" class=\"champ-saisie\" readonly=\"readonly\" name=\"LIBELLE_FICHIER_JOINT_"+i+"\" size=\"30\" value=\""+arrayFichiergw[i].nom+"\" /></td>";				temp += "<td><input type=\"button\" class=\"bouton\" value=\"Supprimer\" onclick=\"supprimerFichiergw('"+i+"');\" /></td></tr>";			}		}	}	else{		// liste de fichiers par defaut		for (i=0;i<arrayFichiergw.length;i++){				if(arrayFichiergw[i]){				temp += "<tr><td><input type=\"input\" id=\"libelle-fichier\" class=\"champ-saisie\" readonly=\"readonly\" name=\"LIBELLE_FICHIER_JOINT_"+i+"\" size=\"30\" value=\""+arrayFichiergw[i].nom+"\" /></td>";				temp += "<td><input type=\"button\" id=\"supprimer-fichier\" class=\"bouton\" value=\"Supprimer\" onclick=\"supprimerFichiergw('"+i+"');\" /></td></tr>";			}		}	}	if (is.ie){		div.outerHTML = '<table id ="inner-fichier">'+temp.toString()+'</table>';	}	else{		div.innerHTML = temp.toString();	}}// preparation pre-validation// concatenation du fichier jointfunction preparerFichiergwUnique(indice){	if (arrayFichierJointUnique[indice]){		fichierJointUnique = arrayFichierJointUnique[indice];		temp = fichierJointUnique.id+";"+fichierJointUnique.nom+";"+fichierJointUnique.format+";"+fichierJointUnique.version+";"+fichierJointUnique.date;		zoneFichier = 'FICHIER_UNIQUE_'+indice;		zoneLibelle = 'LIBELLE_FICHIER_'+indice;		eval("window.document.forms[indiceForm]."+zoneFichier+".value = '"+temp+"';");		eval("window.document.forms[indiceForm]."+zoneLibelle+".value = '"+fichierJointUnique.nom+"';");}	}//specifique fichier unique ex:logo espace collaoboratif// attention l'index du formulaire est variable selon les pagefunction effacerFichier(indice){	if (arrayFichierJointUnique[indice]){			arrayFichierJointUnique[indice]=null;			zoneFichier = 'FICHIER_UNIQUE_'+indice;			zoneLibelle = 'LIBELLE_FICHIER_'+indice;			eval("window.document.forms[indiceForm]."+zoneFichier+".value = '';");			eval("window.document.forms[indiceForm]."+zoneLibelle+".value = 'Cliquer sur parcourir';");	}}/* Gestion des dossiers */var arrayDossiergw = new Array(); //constructeur de la classefunction Dossiergw(p1, p2, p3, p4, p5){	this.id = p1;	this.code = p2;	this.parent = p3;	this.nom = p4;	this.espace = p5;}function visualiserDossiergw(idfiche, typefiche, espace){	window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOSSIERGW_FRONT&ACTION=VISUALISER&SAISIE_FRONT=true&ESPACE="+espace+"&ID_FICHE="+idfiche+"&TYPE_FICHE="+typefiche+"", "dossiergw", "width=400, height=400, scrollbars=yes, resizable=yes, status=no");}function ajouterDossiergw(nomForm){	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	if (d.aNodes[d.selectedNode]){		codeParent = d.aNodes[d.selectedNode].id;		espace = '';		if (document.forms[nomForm].ESPACE.value)		{			espace = document.forms[nomForm].ESPACE.value;		}		window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOSSIERGW_FRONT&ACTION=INSERER&SAISIE_FRONT=true&ESPACE="+espace+"&CODE_PARENT="+codeParent+"", "Dossiergw", "width=400, height=200, status=no");	}else{		alert("Veuillez sélectionner un emplacement!");	}}function supprimerDossiergw(nomForm){	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	if (d.aNodes[d.selectedNode]){		code = d.aNodes[d.selectedNode].id;		if (code==0){			alert("Vous ne pouvez pas supprimer la racine!");		}else{			espace = '';			if (document.forms[nomForm].ESPACE.value){				espace = document.forms[nomForm].ESPACE.value;			}			idfiche = '';			if (document.forms[nomForm].ID_FICHE.value)			{				idfiche = document.forms[nomForm].ID_FICHE.value;			}			typefiche = '';			if (document.forms[nomForm].TYPE_FICHE.value)			{				typefiche = document.forms[nomForm].TYPE_FICHE.value;			}			window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOSSIERGW_FRONT&ACTION=SUPPRIMER&SAISIE_FRONT=true&ESPACE="+espace+"&CODE_DOSSIER="+code+"&ID_FICHE="+idfiche+"&TYPE_FICHE="+typefiche+"", "Dossiergw", "width=400, height=200, status=no"); 		}	}else{		alert("Veuillez sélectionner un dossier!");	}}function renommerDossiergw(nomForm){	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	if (d.aNodes[d.selectedNode]){		code = d.aNodes[d.selectedNode].id;		if (code==0){			alert("Vous ne pouvez pas modidier la racine!");		}else{			espace = '';			if (document.forms[nomForm].ESPACE.value){				espace = document.forms[nomForm].ESPACE.value;			}			window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOSSIERGW_FRONT&ACTION=MODIFIER&SAISIE_FRONT=true&ESPACE="+espace+"&CODE_DOSSIER="+code+"", "Dossiergw", "width=400, height=200, status=no"); 		}	}else{		alert("Veuillez sélectionner un dossier!");	}}function deplacerDossiergw(nomForm){	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	if (d.aNodes[d.selectedNode]){		code = d.aNodes[d.selectedNode].id;		if (code==0){			alert("Vous ne pouvez pas modidier la racine!");		}else{			espace = '';			if (document.forms[nomForm].ESPACE.value){				espace = document.forms[nomForm].ESPACE.value;			}			window.open("/servlet/com.jsbsoft.jtf.core.SG?PROC=TRAITEMENT_DOSSIERGW_FRONT&ACTION=DEPLACER&SAISIE_FRONT=true&ESPACE="+espace+"&CODE_DOSSIER="+code+"", "Dossiergw", "width=400, height=400, resizable=yes, status=no"); 		}	}else{		alert("Veuillez sélectionner un dossier!");	}}function synchroniserDossiergw(nomForm) {	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	if (d.aNodes[d.selectedNode]){		code =d.aNodes[d.selectedNode].id;		window.opener.arrayDossiergw = arrayDossiergw;		window.close();		if (code==0){			window.opener.document.forms[nomForm].LIBELLE_DOSSIER.value="Racine (par défaut)";			window.opener.document.forms[nomForm].NOM_DOSSIER.value="";			window.opener.document.forms[nomForm].DOSSIER.value="";		}else{			window.opener.document.forms[nomForm].DOSSIER.value=code;			if (arrayDossiergw.length>0)			{				for (i=0;i<arrayDossiergw.length;i++)				{					if(arrayDossiergw[i])					{						if (arrayDossiergw[i].code==code)						{							window.opener.document.forms[nomForm].LIBELLE_DOSSIER.value=arrayDossiergw[i].nom;							window.opener.document.forms[nomForm].NOM_DOSSIER.value=arrayDossiergw[i].nom;						}					}				}			}		}	}else{		window.opener.arrayDossiergw = arrayDossiergw;		window.close();		window.opener.document.forms[nomForm].DOSSIER.value="";		window.opener.document.forms[nomForm].LIBELLE_DOSSIER.value="Racine (par défaut)";		window.opener.document.forms[nomForm].NOM_DOSSIER.value="";	}}function fermerDossiergw(nomForm){	if (!nomForm && indiceForm){		nomForm = indiceForm;	}	window.opener.arrayDossiergw = arrayDossiergw;	window.close();	if (window.opener.document.forms[nomForm].NOM_DOSSIER.value=="")	{		window.opener.document.forms[nomForm].LIBELLE_DOSSIER.value="Racine (par défaut)";		window.opener.document.forms[nomForm].NOM_DOSSIER.value="";	}}function affichageDtreeDossiergw(url){	if (url == '')		url = '#';	d = new dTree('d');			d.add(0,-1,'Racine',url,'','','/adminsite/utils/dtree/img/dd.gif','/adminsite/utils/dtree/img/dd.gif');	if (arrayDossiergw.length>0)	{		for (i=0;i<arrayDossiergw.length;i++)		{			if(arrayDossiergw[i])			{				if (arrayDossiergw[i].parent != "")				{					d.add(arrayDossiergw[i].code,arrayDossiergw[i].parent,arrayDossiergw[i].nom,url,'','','/adminsite/utils/dtree/img/folder.gif','/adminsite/utils/dtree/img/folderopen.gif');				}				else				{					d.add(arrayDossiergw[i].code,0,arrayDossiergw[i].nom,url,'','','/adminsite/utils/dtree/img/folder.gif','/adminsite/utils/dtree/img/folderopen.gif');				}			}		}				}	document.write(d);	d.openAll();}/* Gestion de la palette des couleurs */function popup_color_picker(nom1,nom2){	titreCouleur = nom1;	titreExemple = nom2;	var width = 400;	var height = 260;	window.open('/adminsite/utils/colpick/color_picker.jsp?COULEUR='+titreCouleur+'&EXEMPLE='+titreExemple+'&FORM='+indiceForm+'', 'cp', 'resizable=no, location=no, width='				+width+', height='+height+', menubar=no, status=yes, scrollbars=no, menubar=no');}function effacerCouleur(nom1,nom2){	window.document.forms[indiceForm].elements[nom2].style.borderColor = '';	window.document.forms[indiceForm].elements[nom2].style.backgroundColor = '';	window.document.forms[indiceForm].elements[nom1].value = '';}/* Gestion des documents */var arrayDocumentgw = new Array(); //constructeur de la classefunction Documentgw(p1, p2, p3, p4, p5){	this.id = p1;	this.code = p2;	this.url = p3;	this.libelle = p4;	this.dossier = p5}function affichageDtreeDocumentgw(){	ddoc = new dTree('ddoc');			ddoc.add(0,-1,'Liste des fichiers','#','','','','');	// gestion des dossiers	if (arrayDossiergw.length>0)	{		for (i=0;i<arrayDossiergw.length;i++)		{			if(arrayDossiergw[i])			{				if (arrayDossiergw[i].parent != "")				{					ddoc.add(arrayDossiergw[i].code,arrayDossiergw[i].parent,arrayDossiergw[i].nom,'#','','','/adminsite/utils/dtree/img/folder.gif','/adminsite/utils/dtree/img/folderopen.gif');				}				else				{					ddoc.add(arrayDossiergw[i].code,0,arrayDossiergw[i].nom,'#','','','/adminsite/utils/dtree/img/folder.gif','/adminsite/utils/dtree/img/folderopen.gif');				}			}		}	}	// gestion des documents	if (arrayDocumentgw.length>0)	{		for (i=0;i<arrayDocumentgw.length;i++)		{			if (arrayDocumentgw[i])			{				ddoc.add(arrayDocumentgw[i].code,arrayDocumentgw[i].dossier,arrayDocumentgw[i].libelle,arrayDocumentgw[i].url,'','','/adminsite/utils/dtree/img/page.gif','/adminsite/utils/dtree/img/page.gif');			}		}	}	document.write(ddoc);	ddoc.openAll();	}function afficher_calendrier(nom, form, url_image) {	if (! url_image)	{		url_image = "/adminsite/images/calendrier.png";	}	if (document.getElementById) {		document.write("<a href=\"#\" onclick=\"window.open('/adminsite/calendrier/calendrierjs.html?champ=" + nom + "&form=" + form +"', 'calendrier', 'width=135, height=138, toolbar=no, location=no, status=yes, resizable=yes'); return false;\"><img src=\""+url_image+"\" border=\"0\" alt=\"choisir une date\"></a>");	}}function afficher_actions(){	if (d.aNodes[d.selectedNode]){		code =d.aNodes[d.selectedNode].id;		if (code==0){			window.document.getElementById('folder_links').style.display = 'none';			window.document.getElementById('root_links').style.display = 'inline';					}else{			window.document.getElementById('root_links').style.display = 'none';			window.document.getElementById('folder_links').style.display = 'inline';		}	}}function selectionner_dossier(){	oNode = d.aNodes[d.selectedNode];	oForm = document.forms["RECHERCHE_WEB"];	oForm.CODE_DOSSIER_PARENT.value = oNode.id;	oForm.submit();}function replaceAll(str, search, repl) {	while (str.indexOf(search) != -1)		str = str.replace(search, repl);	return str;}/* =============================================== *//*   METHODES DE GESTION DES LISTES MULTIVALUEES   *//* =============================================== */var INPUT_FIELD = 0;var COMBO_BOX = 1;var ZONE_FIELD = 2;function MultivalueFieldItem(sCode, sLabel, sTitle){	this.sCode = sCode;	if (sLabel == '')	{		this.sLabel = sCode;	}	else	{		this.sLabel = sLabel;	}	this.sTitle = sTitle;	this.toString = function()	{		var s = 'sCode = ' + this.sCode;		s += ', sLabel = ' + this.sLabel;		if (this.sTitle)		{			s += ', sTitle = ' + this.sTitle;		}		return s;	}}function MultivalueField(oForm, sName, iTypeField){	//this.oForm = oForm;	// verrue kdecole pour liste en front	this.oForm = window.document.forms['RECHERCHE_WEB'] ? window.document.forms['RECHERCHE_WEB'] : oForm;	this.sName = sName;	this.iTypeField = iTypeField;	this.aItemList = new Array();	this.iSelectedItem = -1;	// Initialise le champ de saisie multiple	this.Init = function()	{		this.oCodesHiddenField = this.oForm.elements[sName];                 // champ caché contenant la liste des codes		this.oLabelsHiddenField = this.oForm.elements['LIBELLE_' + sName];   // champ caché contenant la liste des libellés		this.oTitlesHiddenField = this.oForm.elements['INFOBULLE_' + sName]; // champ caché contenant la liste des infobulles		this.oField = this.oForm.elements['TMP_' + sName];                   // champ de saisie (input, combo, ou zone)		if (this.iTypeField == ZONE_FIELD)		{			this.oLabelField = this.oForm.elements['LIBELLE_TMP_' + sName];  // champ contenant le libellé pour un champ zone		}		this.oSelect = this.oForm.elements['SELECT_' + sName];               // champ select multiple contenant les différentes valeurs		this.LoadData(); // charge le contenu de la liste multivaluée		if (this.aItemList.length > 0)		{			this.iSelectedItem = 0;		}		this.UpdateDisplay();	}	// Teste si l'élément est présent dans la liste	this.ContainsItem = function(oItem)	{		// parcourt la liste		var inList = false;		for (var i = 0; i < this.aItemList.length; i++)		{			if (oItem.sCode == this.aItemList[i].sCode)			{				inList = true;			}		}		return inList;	}	// Ajoute éventuellement un nouvel élément à la liste	this.Add = function()	{		// lit la saisie ou l'élément sélectionné (suivant le type de champ)		var sCode = ''; // TODO		var sLabel = '';		var sTitle;		if (this.iTypeField == INPUT_FIELD) // champ de saisie		{			sCode = this.oField.value;		}		else if (this.iTypeField == COMBO_BOX) // combo box		{			if (this.oField.selectedIndex > 0) // on n'est pas sur le premier élément (code != '0000')			{				sCode = this.oField.value;				sLabel = this.oField.options[this.oField.selectedIndex].text;				if (sLabel.charAt(0) == '-')				{					sCode = '';				}				sTitle = sLabel;			}		}		else if (this.iTypeField == ZONE_FIELD) // zone de saisie		{			sCode = this.oField.value;			sLabel = this.oLabelField.value;			sTitle = this.oLabelField.title;		}		if (sCode != '') // si il y a qqch à ajouter		{			var oItem = new MultivalueFieldItem(sCode, sLabel, sTitle);			//alert(oItem);			if (! this.ContainsItem(oItem)) // si l'élément n'est pas dans la liste			{				// ajoute l'élément à la fin de la liste				this.aItemList[this.aItemList.length] = oItem;				// sélectionne l'élément ajouté				this.iSelectedItem = this.aItemList.length-1;				// met à jour l'affichage				this.UpdateDisplay();				// met à jour le champ caché				this.SaveData();				// réinitialise le champ de saisie				if (this.iTypeField == INPUT_FIELD) // champ de saisie				{					this.oField.value = '';				}				else if (this.iTypeField == COMBO_BOX) // combo box				{					this.oField.selectedIndex = 0;				}				/*else if (this.iTypeField == ZONE_FIELD) // zone de saisie				{					effacerTextField('TMP_' + this.sName, 'LIBELLE_TMP_' + this.sName, '', 'Cliquer sur parcourir');				}*/			}			else			{				alert('Cette valeur a déjà été insérée.');			}		}	}	// Supprime l'élément sélectionné	this.Remove = function()	{		if (this.aItemList.length > 0) // la liste n'est pas vide		{			if (this.iSelectedItem != -1) // un élément est sélectionné			{				// décale les éléments suivants				for (var i = this.iSelectedItem; i < this.aItemList.length-1; i++)				{					this.aItemList[i] = this.aItemList[i+1];				}				// supprime le dernier élément en double				//this.aItemList[this.aItemList.length-1] = null;				this.aItemList.length--;				// met à jour la sélection				if (this.iSelectedItem == this.aItemList.length)				{					this.iSelectedItem--;				}				// met à jour l'affichage				this.UpdateDisplay();				// met à jour le champ caché				this.SaveData();			}			else			{				alert('Sélectionnez la valeur à supprimer.');			}		}	}	// Modifie l'élément sélectionné ( !!!! spécifique pour chaque type d'élément)	this.Modify = function()	{		if (this.aItemList.length > 0) // la liste n'est pas vide		{			if (this.iSelectedItem != -1) // un élément est sélectionné			{				specificModifyItem(this);			}			else			{				alert('Sélectionnez la valeur à modifier.');			}		}	}	// Met à jour l'élément sélectionné ( !!!! spécifique pour chaque type d'élément)	this.UpdateItem = function(item)	{		if (this.aItemList.length > 0) // la liste n'est pas vide		{			if (this.iSelectedItem != -1) // un élément est sélectionné			{				// met à jour l'élément selectionné				this.aItemList[this.iSelectedItem] = item;				// met à jour l'affichage				this.UpdateDisplay();				// met à jour le champ caché				this.SaveData();			}			else			{				alert('Sélectionnez la valeur à modifier.');			}		}	}	// Remonte l'élément sélectionné	this.MoveUp = function()	{		if (this.aItemList.length > 1 && // la liste contient plusieurs éléments,		    this.iSelectedItem != -1 &&  // un des éléments est sélectionné,		    this.iSelectedItem > 0)      // ce n'est pas le premier élément de la liste		{			// intervertit l'élément avec son précédent			var oItemTmp = this.aItemList[this.iSelectedItem];			this.aItemList[this.iSelectedItem] = this.aItemList[this.iSelectedItem - 1];			this.aItemList[this.iSelectedItem - 1] = oItemTmp;			// met à jour la sélection			this.iSelectedItem--;			// met à jour l'affichage			this.UpdateDisplay();			// met à jour le champ caché			this.SaveData();		}	}	// Descend l'élément sélectionné	this.MoveDown = function()	{		if (this.aItemList.length > 1 &&                    // la liste contient plusieurs éléments,		    this.iSelectedItem != -1 &&                     // un des éléments est sélectionné,		    this.iSelectedItem < this.aItemList.length - 1) // ce n'est pas le dernier élément de la liste		{			// intervertit l'élément avec son suivant			var oItemTmp = this.aItemList[this.iSelectedItem];			this.aItemList[this.iSelectedItem] = this.aItemList[this.iSelectedItem + 1];			this.aItemList[this.iSelectedItem + 1] = oItemTmp;			// met à jour la sélection			this.iSelectedItem++;			// met à jour l'affichage			this.UpdateDisplay();			// met à jour le champ caché			this.SaveData();		}	}	// Sélectionne un élément (à associer au onclick sur un élément)	this.SelectItem = function()	{		if (this.aItemList.length == 0)		{			this.iSelectedItem = -1;		}		else		{			this.iSelectedItem = this.oSelect.selectedIndex;		}	}	// Met à jour l'affichage HTML	this.UpdateDisplay = function()	{		this.oSelect.options.length = 0;		if (this.aItemList.length == 0)		{			this.oSelect.options[0] = new Option('--', -1);			this.oSelect.selectedIndex = 0;		}		else		{			var oItem;			for (var i = 0; i < this.aItemList.length; i++)			{				oItem = this.aItemList[i];				this.oSelect.options[i] = new Option(oItem.sLabel);				if (oItem.sTitle)				{					this.oSelect.options[i].title = oItem.sTitle;				}			}			this.oSelect.selectedIndex = this.iSelectedItem;		}	}	// Charge le contenu existant du champ	this.LoadData = function()	{		var aCodes = this.oCodesHiddenField.value.split(';');		var aLabels = this.oLabelsHiddenField.value.split(';');		var aTitles;		if (this.oTitlesHiddenField)		{			aTitles = this.oTitlesHiddenField.value.split(';');		}		for (var i = 0; i < aCodes.length; i++)		{			if (aCodes[i] != '' && aCodes[i] != '0000')			{				if (aTitles)				{					oItem = new MultivalueFieldItem(aCodes[i], aLabels[i], aTitles[i]);				}				else				{					oItem = new MultivalueFieldItem(aCodes[i], aLabels[i]);				}				//alert(oItem);				if (! this.ContainsItem(oItem)) // si l'élément n'est pas dans la liste				{					// ajoute l'élément à la fin de la liste					this.aItemList[this.aItemList.length] = oItem;				}			}		}	}	// Sauve le contenu existant du champ	this.SaveData = function()	{		this.oCodesHiddenField.value = '';		this.oLabelsHiddenField.value = '';		if (this.oTitlesHiddenField)		{			this.oTitlesHiddenField.value = '';		}		var oItem;		for (var i = 0; i < this.aItemList.length; i++)		{			oItem = this.aItemList[i];			if (i > 0)			{				this.oCodesHiddenField.value += ';';				this.oLabelsHiddenField.value += ';';				if (this.oTitlesHiddenField)				{					this.oTitlesHiddenField.value += ';';				}			}			this.oCodesHiddenField.value += oItem.sCode;			this.oLabelsHiddenField.value += oItem.sLabel;			if (this.oTitlesHiddenField)			{				this.oTitlesHiddenField.value += oItem.sTitle;			}		}	}}/* ============================================= *//*   METHODES DE GESTION DES OBJETS TECHNIQUES   *//* ============================================= */function soumettreAjoutSousObjet(nomObjet) {	nettoyerDonnees();	window.document.forms[0].ACTION.value = 'NOCTRL_AJOUTER_' + nomObjet;	window.document.forms[0].submit();}function soumettreModificationSousObjet(nomObjet, indice) {	nettoyerDonnees();	window.document.forms[0].ACTION.value = 'NOCTRL_MODIFIER_' + nomObjet + '#' + indice;	window.document.forms[0].submit();}function soumettreSuppressionSousObjet(nomObjet, indice) {	nettoyerDonnees();	window.document.forms[0].ACTION.value = 'NOCTRL_SUPPRIMER_' + nomObjet + '#' + indice;	window.document.forms[0].submit();}function soumettreValidationSousObjet(nomObjet) {	nettoyerDonnees();	window.document.forms[0].ACTION.value = 'VALIDER_' + nomObjet;	window.document.forms[0].submit();}function soumettreAnnulationSousObjet(nomObjet) {	nettoyerDonnees();	window.document.forms[0].ACTION.value= 'NOCTRL_ANNULER_' + nomObjet;	window.document.forms[0].submit();}//--></script>		<script type="text/javascript"  style="display:none"><!--/** * div, id = menuId, class = scroll_container * div/ul, id = subMenuId, class = scroll_content */function Carrousel(){    var oThis = this; 					// création d'une référence vers l'objet courant	this.sIdCarrousel = '';	this.iDuree = 2;					// duree en seconde pour le fade	this.bBoucleAuto = true;			// boolean	this.iPos = 0;						// element en cours	this.iNbItems = 0;					// nombre de li 	this.bActionable = true;		this.Init = function(sIdCarrousel)	{		// Attributs du composant		this.sIdCarrousel = sIdCarrousel;		var ulListe = document.getElementById(sIdCarrousel); 		// ul contenaut les actus renvoie la classe caroussel		// recuper nb items			 var filsUlListe = ulListe.getElementsByTagName("*");			 for(var i=0; i<filsUlListe.length; i++){			if( filsUlListe[i].id.indexOf(sIdCarrousel)>-1) {				this.iNbItems = this.iNbItems +1;			}    	 }	}	this.AfficheUnique = function(iIndex)	{		if (this.bActionable && iIndex <= this.iNbItems-1 && iIndex!=this.iPos )		{							this.SetActive(false);				new Effect.Fade(this.sIdCarrousel +'_' + this.iPos,{ duration: this.iDuree });				new Effect.Appear(this.sIdCarrousel +'_' + iIndex,{ duration: this.iDuree });				setTimeout(function() { oThis.SetActive(true); }, this.iDuree*1000);				this.iPos = iIndex;				this.ActualiserPositionPlayer(iIndex);				this.bBoucleAuto = false;		}	}		this.Affiche = function(iIndex)	{		// on ne peut pas afficher plus d'éléments que ce qu'on a dans la liste et on n'agit pas sur l'élément déjà affiché				if (this.bActionable && iIndex <= this.iNbItems-1 && iIndex!=this.iPos )		{							this.SetActive(false);				new Effect.Fade(this.sIdCarrousel +'_' + this.iPos,{ duration: this.iDuree });				new Effect.Appear(this.sIdCarrousel +'_' + iIndex,{ duration: this.iDuree });				setTimeout(function() { oThis.SetActive(true); }, this.iDuree*1000);				this.iPos = iIndex;				this.ActualiserPositionPlayer(iIndex);				//document.getElementById('position_courante').innerHTML=this.iPos+1 + '/'+ this.iNbItems;		}	}		this.ActualiserPositionPlayer = function(iIndex)	{		var ulPlayer = document.getElementById('player_slideshow_' + this.sIdCarrousel);		if (ulPlayer != null) {			 var filsulPlayer = ulPlayer.getElementsByTagName("*");			for(var i=0; i<filsulPlayer.length; i++){									filsulPlayer[i].className = 'lien_slideshow';	    	 }		}				var liPlayer = document.getElementById(this.sIdCarrousel + '_player_' + this.iPos);		if (liPlayer != null) {			liPlayer.className = liPlayer.className + " actif";		}	}	this.SetActive = function(actif) {		this.bActionable = actif;	}	this.Defile = function()	{		// gerer defilement		if (this.bBoucleAuto)		{			if (this.iPos < this.iNbItems-1) {				this.Affiche(this.iPos+1);			}			else {				this.Affiche(0);				this.bBoucleAuto=true;								//this.MasquerPause();			}			// gerer recursif			setTimeout(function() { oThis.Defile(); }, 7000);		}	}	this.Play = function(auto) 	{		if (this.bActionable){			this.bBoucleAuto = true;			this.MasquerPlay();			this.Defile();		}	}	this.Pause = function()	{		this.bBoucleAuto = false;		this.MasquerPause();	}	this.Suivant = function()	{		if (this.bActionable && this.iPos < this.iNbItems-1){					this.bBoucleAuto = false;			this.Affiche(this.iPos+1);			this.MasquerPause();		}	}	this.Precedent = function()	{		if (this.bActionable && this.iPos > 0){			this.bBoucleAuto = false;			this.Affiche(this.iPos-1);			this.MasquerPause();		}	}	this.MasquerPlay = function()	{		document.getElementById('bouton_pause').style.display='block';		document.getElementById('bouton_play').style.display='none';	}		this.MasquerPause = function()	{		document.getElementById('bouton_pause').style.display='none';		document.getElementById('bouton_play').style.display='block';	}		this.hauteurImage = function(sIdCarrousel)	{		var docPere = document.getElementById(sIdCarrousel);		var docFils = docPere.getElementsByTagName("*");							if (document.all) // ok I.E			{				H = docFils[0].currentStyle.height;			}			else // ok firefox.0.9.2 , pas mozilla.1.0 ni netscape.7.02			{				H = document.defaultView.getComputedStyle(docFils[0], null).height;			}						docPere.style.height= H ;			}}//--></script>		<script type="text/javascript"  style="display:none"><!--/** * div, id = menuId, class = scroll_container * div/ul, id = subMenuId, class = scroll_content */function Scroller(){	var oThis = this; 				this.Init = function(sScrollContainerId, sScrollingItemId, bVertical, iScrollingStep)	{		// Attributs du composant					this.oScrollContainer = $(sScrollContainerId);                 // container fenêtre de défilement (div)		this.oScrollingItem = $(sScrollingItemId);                     // zone de contenu défilant (div ou ul)		this.bVertical = bVertical;                                    // défilement horizontal ou vertical ?		this.iScrollingStep = (iScrollingStep ? iScrollingStep : 25);  // pas de défilement (en px)		this.iScrollContainerSize = 0;                                 // largeur/hauteur de la fenêtre de défilement (en px)		this.iScrollingItemSize = 0;                                   // largeur/hauteur de la zone de contenu défilant (en px)		this.iOffset = 0;                                              // position (en px)		this.iStartPositionOffset = 0;                                 // décalage de la position initiale de la zone défilante (en px)		this.iEndPositionOffset = 0;                                   // décalage de la position finale de la zone défilante (en px)		this.bActionable = true;		this.iDuration = 0.2 * this.iScrollingStep / 100;				//this.iOffset = Math.floor(oScrollingItem.getStyle('top').split('px')[0]);		if (this.bVertical) {			this.iScrollContainerSize = Math.floor(this.oScrollContainer.getStyle('height').split('px')[0]);			this.iScrollingItemSize = Math.floor(this.oScrollingItem.getStyle('height').split('px')[0]);		}		else {			this.iScrollContainerSize = Math.floor(this.oScrollContainer.getStyle('width').split('px')[0]);			this.iScrollingItemSize = Math.floor(this.oScrollingItem.getStyle('width').split('px')[0]);		}	}	this.SetPadding = function(paddingLeft, paddingRight)	{		this.iStartPositionOffset  = paddingLeft;		this.iEndPositionOffset = paddingRight;	}		// Renvoie une représentation de l'élément sous forme de chaine	this.ToString = function()	{		var s = '[sScrollContainerId=' + this.oScrollContainer.id + '; ';		s += 'sScrollingItemId=' + this.oScrollingItem.id + '; ';		s += 'bVertical=' + this.bVertical + '; ';		s += 'iScrollingStep=' + this.iScrollingStep + '; ';		s += 'iScrollContainerSize=' + this.iScrollContainerSize + '; ';		s += 'iScrollingItemSize=' + this.iScrollingItemSize + '; ';		s += 'iOffset=' + this.iOffset + '; ';		s += 'iStartPositionOffset =' + this.iStartPositionOffset  + '; ';		s += 'iEndPositionOffset=' + this.iEndPositionOffset + ']';		return s;	}	this.Move = function(iScrollingStep)	{		//alert('Move: ' + this.iOffset + ' + ' + iScrollingStep);		// calcul du déplacement		if (this.iOffset == 0) this.iOffset = - this.iStartPositionOffset ; // premier forward		this.iOffset += iScrollingStep; // cas moyen		if (this.iOffset == this.iStartPositionOffset ) this.iOffset = 0; // dernier back		// déplacement selon axe		if (this.bVertical) {			new Effect.Move(this.oScrollingItem, { x: 0, y: iScrollingStep, mode: 'relative', duration: this.iDuration });			//this.oScrollingItem.setStyle({top: this.iOffset+'px'});		}		else {			new Effect.Move(this.oScrollingItem, { x: iScrollingStep, y: 0, mode: 'relative', duration: this.iDuration });			//this.oScrollingItem.setStyle({left: this.iOffset+'px'});		}	}	this.GoForward = function()	{		//alert('debug : ' + this.ToString());		// alert('GoForward: ' + this.iScrollingItemSize + ' + ' + this.iOffset + ' > ' + this.iScrollContainerSize  - this.iEndPositionOffset);		var btSuivantAv = document.getElementById('bt_suivant');		var btPrecedentAv = document.getElementById('bt_precedent');		if (this.bActionable && this.iScrollingItemSize + this.iOffset > this.iScrollContainerSize + this.iEndPositionOffset) {			this.SetActive(false);			this.Move(- this.iScrollingStep);			setTimeout(function() { oThis.SetActive(true); }, this.iDuration*1000);			if (this.iScrollingItemSize + this.iOffset < this.iScrollContainerSize + this.iEndPositionOffset) {				btSuivantAv.style.display = 'none';			} 					}		btPrecedentAv.style.display = '';	}	this.GoBack = function()	{		//alert(this.iOffset + ' < -' + this.iStartPositionOffset );		var btSuivant = document.getElementById('bt_suivant');		var btPrecedent = document.getElementById('bt_precedent');		if (this.bActionable && this.iOffset < - this.iStartPositionOffset ) {			this.SetActive(false);			this.Move(this.iScrollingStep);			setTimeout(function() { oThis.SetActive(true); }, this.iDuration*1000);			if (this.iOffset == - this.iStartPositionOffset) {				btPrecedent.style.display = 'none';			}		}		btSuivant.style.display = '';	}		this.SetActive = function(actif) {		this.bActionable = actif;	}}//--></script>		<script type="text/javascript"  style="display:none"><!--/*  Prototype JavaScript framework, version 1.6.0.3 *  (c) 2005-2008 Sam Stephenson * *  Prototype is freely distributable under the terms of an MIT-style license. *  For details, see the Prototype web site: http://www.prototypejs.org/ * *--------------------------------------------------------------------------*/var Prototype = {  Version: '1.6.0.3',  Browser: {    IE:     !!(window.attachEvent &&      navigator.userAgent.indexOf('Opera') === -1),    Opera:  navigator.userAgent.indexOf('Opera') > -1,    WebKit: navigator.userAgent.indexOf('AppleWebKit/') > -1,    Gecko:  navigator.userAgent.indexOf('Gecko') > -1 &&      navigator.userAgent.indexOf('KHTML') === -1,    MobileSafari: !!navigator.userAgent.match(/Apple.*Mobile.*Safari/)  },  BrowserFeatures: {    XPath: !!document.evaluate,    SelectorsAPI: !!document.querySelector,    ElementExtensions: !!window.HTMLElement,    SpecificElementExtensions:      document.createElement('div')['__proto__'] &&      document.createElement('div')['__proto__'] !==        document.createElement('form')['__proto__']  },  ScriptFragment: '<script[^>]*>([\\S\\s]*?)<\/script>',  JSONFilter: /^\/\*-secure-([\s\S]*)\*\/\s*$/,  emptyFunction: function() { },  K: function(x) { return x }};if (Prototype.Browser.MobileSafari)  Prototype.BrowserFeatures.SpecificElementExtensions = false;/* Based on Alex Arnell's inheritance implementation. */var Class = {  create: function() {    var parent = null, properties = $A(arguments);    if (Object.isFunction(properties[0]))      parent = properties.shift();    function klass() {      this.initialize.apply(this, arguments);    }    Object.extend(klass, Class.Methods);    klass.superclass = parent;    klass.subclasses = [];    if (parent) {      var subclass = function() { };      subclass.prototype = parent.prototype;      klass.prototype = new subclass;      parent.subclasses.push(klass);    }    for (var i = 0; i < properties.length; i++)      klass.addMethods(properties[i]);    if (!klass.prototype.initialize)      klass.prototype.initialize = Prototype.emptyFunction;    klass.prototype.constructor = klass;    return klass;  }};Class.Methods = {  addMethods: function(source) {    var ancestor   = this.superclass && this.superclass.prototype;    var properties = Object.keys(source);    if (!Object.keys({ toString: true }).length)      properties.push("toString", "valueOf");    for (var i = 0, length = properties.length; i < length; i++) {      var property = properties[i], value = source[property];      if (ancestor && Object.isFunction(value) &&          value.argumentNames().first() == "$super") {        var method = value;        value = (function(m) {          return function() { return ancestor[m].apply(this, arguments) };        })(property).wrap(method);        value.valueOf = method.valueOf.bind(method);        value.toString = method.toString.bind(method);      }      this.prototype[property] = value;    }    return this;  }};var Abstract = { };Object.extend = function(destination, source) {  for (var property in source)    destination[property] = source[property];  return destination;};Object.extend(Object, {  inspect: function(object) {    try {      if (Object.isUndefined(object)) return 'undefined';      if (object === null) return 'null';      return object.inspect ? object.inspect() : String(object);    } catch (e) {      if (e instanceof RangeError) return '...';      throw e;    }  },  toJSON: function(object) {    var type = typeof object;    switch (type) {      case 'undefined':      case 'function':      case 'unknown': return;      case 'boolean': return object.toString();    }    if (object === null) return 'null';    if (object.toJSON) return object.toJSON();    if (Object.isElement(object)) return;    var results = [];    for (var property in object) {      var value = Object.toJSON(object[property]);      if (!Object.isUndefined(value))        results.push(property.toJSON(</script + value);    }    return '{' + results.join(', ') + '}';  },  toQueryString: function(object) {    return $H(object).toQueryString();  },  toHTML: function(object) {    return object && object.toHTML ? object.toHTML() : String.interpret(object);  },  keys: function(object) {    var keys = [];    for (var property in object)      keys.push(property);    return keys;  },  values: function(object) {    var values = [];    for (var property in object)      values.push(object[property]);    return values;  },  clone: function(object) {    return Object.extend({ }, object);  },  isElement: function(object) {    return !!(object && object.nodeType == 1);  },  isArray: function(object) {    return object != null && typeof object == "object" &&      'splice' in object && 'join' in object;  },  isHash: function(object) {    return object instanceof Hash;  },  isFunction: function(object) {    return typeof object == "function";  },  isString: function(object) {    return typeof object == "string";  },  isNumber: function(object) {    return typeof object == "number";  },  isUndefined: function(object) {    return typeof object == "undefined";  }});Object.extend(Function.prototype, {  argumentNames: function() {    var names = this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1]      .replace(/\s+/g, '').split(',');    return names.length == 1 && !names[0] ? [] : names;  },  bind: function() {    if (arguments.length < 2 && Object.isUndefined(arguments[0])) return this;    var __method = this, args = $A(arguments), object = args.shift();    return function() {      return __method.apply(object, args.concat($A(arguments)));    }  },  bindAsEventListener: function() {    var __method = this, args = $A(arguments), object = args.shift();    return function(event) {      return __method.apply(object, [event || window.event].concat(args));    }  },  curry: function() {    if (!arguments.length) return this;    var __method = this, args = $A(arguments);    return function() {      return __method.apply(this, args.concat($A(arguments)));    }  },  delay: function() {    var __method = this, args = $A(arguments), timeout = args.shift() * 1000;    return window.setTimeout(function() {      return __method.apply(__method, args);    }, timeout);  },  defer: function() {    var args = [0.01].concat($A(arguments));    return this.delay.apply(this, args);  },  wrap: function(wrapper) {    var __method = this;    return function() {      return wrapper.apply(this, [__method.bind(this)].concat($A(arguments)));    }  },  methodize: function() {    if (this._methodized) return this._methodized;    var __method = this;    return this._methodized = function() {      return __method.apply(null, [this].concat($A(arguments)));    };  }});Date.prototype.toJSON = function() {  return '"' + this.getUTCFullYear() + '-' +    (this.getUTCMonth() + 1).toPaddedString(2) + '-' +    this.getUTCDate().toPaddedString(2) + 'T' +    this.getUTCHours().toPaddedString(2) + ':' +    this.getUTCMinutes().toPaddedString(2) + ':' +    this.getUTCSeconds().toPaddedString(2) + 'Z"';};var Try = {  these: function() {    var returnValue;    for (var i = 0, length = arguments.length; i < length; i++) {      var lambda = arguments[i];      try {        returnValue = lambda();        break;      } catch (e) { }    }    return returnValue;  }};RegExp.prototype.match = RegExp.prototype.test;RegExp.escape = function(str) {  return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');};/*--------------------------------------------------------------------------*/var PeriodicalExecuter = Class.create({  initialize: function(callback, frequency) {    this.callback = callback;    this.frequency = frequency;    this.currentlyExecuting = false;    this.registerCallback();  },  registerCallback: function() {    this.timer = setInterval(this.onTimerEvent.bind(this), this.frequency * 1000);  },  execute: function() {    this.callback(this);  },  stop: function() {    if (!this.timer) return;    clearInterval(this.timer);    this.timer = null;  },  onTimerEvent: function() {    if (!this.currentlyExecuting) {      try {        this.currentlyExecuting = true;        this.execute();      } finally {        this.currentlyExecuting = false;      }    }  }});Object.extend(String, {  interpret: function(value) {    return value == null ? '' : String(value);  },  specialChar: {    '\b': '\\b',    '\t': '\\t',    '\n': '\\n',    '\f': '\\f',    '\r': '\\r',    '\\': '\\\\'  }});Object.extend(String.prototype, {  gsub: function(pattern, replacement) {    var result = '', source = this, match;    replacement = arguments.callee.prepareReplacement(replacement);    while (source.length > 0) {      if (match = source.match(pattern)) {        result += source.slice(0, match.index);        result += String.interpret(replacement(match));        source  = source.slice(match.index + match[0].length);      } else {        result += source, source = '';      }    }    return result;  },  sub: function(pattern, replacement, count) {    replacement = this.gsub.prepareReplacement(replacement);    count = Object.isUndefined(count) ? 1 : count;    return this.gsub(pattern, function(match) {      if (--count < 0) return match[0];      return replacement(match);    });  },  scan: function(pattern, iterator) {    this.gsub(pattern, iterator);    return String(this);  },  truncate: function(length, truncation) {    length = length || 30;    truncation = Object.isUndefined(truncation) ? '...' : truncation;    return this.length > length ?      this.slice(0, length - truncation.length) + truncation : String(this);  },  strip: function() {    return this.replace(/^\s+/, '').replace(/\s+$/, '');  },  stripTags: function() {    return this.replace(/<\/?[^>]+>/gi, '');  },  stripScripts: function() {    return this.replace(new RegExp(Prototype.ScriptFragment, 'img'), '');  },  extractScripts: function() {    var matchAll = new RegExp(Prototype.ScriptFragment, 'img');    var matchOne = new RegExp(Prototype.ScriptFragment, 'im');    return (this.match(matchAll) || []).map(function(scriptTag) {      return (scriptTag.match(matchOne) || ['', ''])[1];    });  },  evalScripts: function() {    return this.extractScripts().map(function(script) { return eval(script) });  },  escapeHTML: function() {    var self = arguments.callee;    self.text.data = this;    return self.div.innerHTML;  },  unescapeHTML: function() {    var div = new Element('div');    div.innerHTML = this.stripTags();    return div.childNodes[0] ? (div.childNodes.length > 1 ?      $A(div.childNodes).inject('', function(memo, node) { return memo+node.nodeValue }) :      div.childNodes[0].nodeValue) : '';  },  toQueryParams: function(separator) {    var match = this.strip().match(/([^?#]*)(#.*)?$/);    if (!match) return { };    return match[1].split(separator || '&').inject({ }, function(hash, pair) {      if ((pair = pair.split('='))[0]) {        var key = decodeURIComponent(pair.shift());        var value = pair.length > 1 ? pair.join('=') : pair[0];        if (value != undefined) value = decodeURIComponent(value);        if (key in hash) {          if (!Object.isArray(hash[key])) hash[key] = [hash[key]];          hash[key].push(value);        }        else hash[key] = value;      }      return hash;    });  },  toArray: function() {    return this.split('');  },  succ: function() {    return this.slice(0, this.length - 1) +      String.fromCharCode(this.charCodeAt(this.length - 1) + 1);  },  times: function(count) {    return count < 1 ? '' : new Array(count + 1).join(this);  },  camelize: function() {    var parts = this.split('-'), len = parts.length;    if (len == 1) return parts[0];    var camelized = this.charAt(0) == '-'      ? parts[0].charAt(0).toUpperCase() + parts[0].substring(1)      : parts[0];    for (var i = 1; i < len; i++)      camelized += parts[i].charAt(0).toUpperCase() + parts[i].substring(1);    return camelized;  },  capitalize: function() {    return this.charAt(0).toUpperCase() + this.substring(1).toLowerCase();  },  underscore: function() {    return this.gsub(/::/, '/').gsub(/([A-Z]+)([A-Z][a-z])/,'#{1}_#{2}').gsub(/([a-z\d])([A-Z])/,'#{1}_#{2}').gsub(/-/,'_').toLowerCase();  },  dasherize: function() {    return this.gsub(/_/,'-');  },  inspect: function(useDoubleQuotes) {    var escapedString = this.gsub(/[\x00-\x1f\\]/, function(match) {      var character = String.specialChar[match[0]];      return character ? character : '\\u00' + match[0].charCodeAt().toPaddedString(2, 16);    });    if (useDoubleQuotes) return '"' + escapedString.replace(/"/g, '\\"') + '"';    return "'" + escapedString.replace(/'/g, '\\\'') + "'";  },  toJSON: function() {    return this.inspect(true);  },  unfilterJSON: function(filter) {    return this.sub(filter || Prototype.JSONFilter, '#{1}');  },  isJSON: function() {    var str = this;    if (str.blank()) return false;    str = this.replace(/\\./g, '@').replace(/"[^"\\\n\r]*"/g, '');    return (/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str);  },  evalJSON: function(sanitize) {    var json = this.unfilterJSON();    try {      if (!sanitize || json.isJSON()) return eval('(' + json + ')');    } catch (e) { }    throw new SyntaxError('Badly formed JSON string: ' + this.inspect());  },  include: function(pattern) {    return this.indexOf(pattern) > -1;  },  startsWith: function(pattern) {    return this.indexOf(pattern) === 0;  },  endsWith: function(pattern) {    var d = this.length - pattern.length;    return d >= 0 && this.lastIndexOf(pattern) === d;  },  empty: function() {    return this == '';  },  blank: function() {    return /^\s*$/.test(this);  },  interpolate: function(object, pattern) {    return new Template(this, pattern).evaluate(object);  }});if (Prototype.Browser.WebKit || Prototype.Browser.IE) Object.extend(String.prototype, {  escapeHTML: function() {    return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');  },  unescapeHTML: function() {    return this.stripTags().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>');  }});String.prototype.gsub.prepareReplacement = function(replacement) {  if (Object.isFunction(replacement)) return replacement;  var template = new Template(replacement);  return function(match) { return template.evaluate(match) };};String.prototype.parseQuery = String.prototype.toQueryParams;Object.extend(String.prototype.escapeHTML, {  div:  document.createElement('div'),  text: document.createTextNode('')});String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);var Template = Class.create({  initialize: function(template, pattern) {    this.template = template.toString();    this.pattern = pattern || Template.Pattern;  },  evaluate: function(object) {    if (Object.isFunction(object.toTemplateReplacements))      object = object.toTemplateReplacements();    return this.template.gsub(this.pattern, function(match) {      if (object == null) return '';      var before = match[1] || '';      if (before == '\\') return match[2];      var ctx = object, expr = match[3];      var pattern = /^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;      match = pattern.exec(expr);      if (match == null) return before;      while (match != null) {        var comp = match[1].startsWith('[') ? match[2].gsub('\\\\]', ']') : match[1];        ctx = ctx[comp];        if (null == ctx || '' == match[3]) break;        expr = expr.substring('[' == match[3] ? match[1].length : match[0].length);        match = pattern.exec(expr);      }      return before + String.interpret(ctx);    });  }});Template.Pattern = /(^|.|\r|\n)(#\{(.*?)\})/;var $break = { };var Enumerable = {  each: function(iterator, context) {    var index = 0;    try {      this._each(function(value) {        iterator.call(context, value, index++);      });    } catch (e) {      if (e != $break) throw e;    }    return this;  },  eachSlice: function(number, iterator, context) {    var index = -number, slices = [], array = this.toArray();    if (number < 1) return array;    while ((index += number) < array.length)      slices.push(array.slice(index, index+number));    return slices.collect(iterator, context);  },  all: function(iterator, context) {    iterator = iterator || Prototype.K;    var result = true;    this.each(function(value, index) {      result = result && !!iterator.call(context, value, index);      if (!result) throw $break;    });    return result;  },  any: function(iterator, context) {    iterator = iterator || Prototype.K;    var result = false;    this.each(function(value, index) {      if (result = !!iterator.call(context, value, index))        throw $break;    });    return result;  },  collect: function(iterator, context) {    iterator = iterator || Prototype.K;    var results = [];    this.each(function(value, index) {      results.push(iterator.call(context, value, index));    });    return results;  },  detect: function(iterator, context) {    var result;    this.each(function(value, index) {      if (iterator.call(context, value, index)) {        result = value;        throw $break;      }    });    return result;  },  findAll: function(iterator, context) {    var results = [];    this.each(function(value, index) {      if (iterator.call(context, value, index))        results.push(value);    });    return results;  },  grep: function(filter, iterator, context) {    iterator = iterator || Prototype.K;    var results = [];    if (Object.isString(filter))      filter = new RegExp(filter);    this.each(function(value, index) {      if (filter.match(value))        results.push(iterator.call(context, value, index));    });    return results;  },  include: function(object) {    if (Object.isFunction(this.indexOf))      if (this.indexOf(object) != -1) return true;    var found = false;    this.each(function(value) {      if (value == object) {        found = true;        throw $break;      }    });    return found;  },  inGroupsOf: function(number, fillWith) {    fillWith = Object.isUndefined(fillWith) ? null : fillWith;    return this.eachSlice(number, function(slice) {      while(slice.length < number) slice.push(fillWith);      return slice;    });  },  inject: function(memo, iterator, context) {    this.each(function(value, index) {      memo = iterator.call(context, memo, value, index);    });    return memo;  },  invoke: function(method) {    var args = $A(arguments).slice(1);    return this.map(function(value) {      return value[method].apply(value, args);    });  },  max: function(iterator, context) {    iterator = iterator || Prototype.K;    var result;    this.each(function(value, index) {      value = iterator.call(context, value, index);      if (result == null || value >= result)        result = value;    });    return result;  },  min: function(iterator, context) {    iterator = iterator || Prototype.K;    var result;    this.each(function(value, index) {      value = iterator.call(context, value, index);      if (result == null || value < result)        result = value;    });    return result;  },  partition: function(iterator, context) {    iterator = iterator || Prototype.K;    var trues = [], falses = [];    this.each(function(value, index) {      (iterator.call(context, value, index) ?        trues : falses).push(value);    });    return [trues, falses];  },  pluck: function(property) {    var results = [];    this.each(function(value) {      results.push(value[property]);    });    return results;  },  reject: function(iterator, context) {    var results = [];    this.each(function(value, index) {      if (!iterator.call(context, value, index))        results.push(value);    });    return results;  },  sortBy: function(iterator, context) {    return this.map(function(value, index) {      return {        value: value,        criteria: iterator.call(context, value, index)      };    }).sort(function(left, right) {      var a = left.criteria, b = right.criteria;      return a < b ? -1 : a > b ? 1 : 0;    }).pluck('value');  },  toArray: function() {    return this.map();  },  zip: function() {    var iterator = Prototype.K, args = $A(arguments);    if (Object.isFunction(args.last()))      iterator = args.pop();    var collections = [this].concat(args).map($A);    return this.map(function(value, index) {      return iterator(collections.pluck(index));    });  },  size: function() {    return this.toArray().length;  },  inspect: function() {    return '#<Enumerable:' + this.toArray().inspect() + '>';  }};Object.extend(Enumerable, {  map:     Enumerable.collect,  find:    Enumerable.detect,  select:  Enumerable.findAll,  filter:  Enumerable.findAll,  member:  Enumerable.include,  entries: Enumerable.toArray,  every:   Enumerable.all,  some:    Enumerable.any});function $A(iterable) {  if (!iterable) return [];  if (iterable.toArray) return iterable.toArray();  var length = iterable.length || 0, results = new Array(length);  while (length--) results[length] = iterable[length];  return results;}if (Prototype.Browser.WebKit) {  $A = function(iterable) {    if (!iterable) return [];    // In Safari, only use the `toArray` method if it's not a NodeList.    // A NodeList is a function, has an function `item` property, and a numeric    // `length` property. Adapted from Google Doctype.    if (!(typeof iterable === 'function' && typeof iterable.length ===        'number' && typeof iterable.item === 'function') && iterable.toArray)      return iterable.toArray();    var length = iterable.length || 0, results = new Array(length);    while (length--) results[length] = iterable[length];    return results;  };}Array.from = $A;Object.extend(Array.prototype, Enumerable);if (!Array.prototype._reverse) Array.prototype._reverse = Array.prototype.reverse;Object.extend(Array.prototype, {  _each: function(iterator) {    for (var i = 0, length = this.length; i < length; i++)      iterator(this[i]);  },  clear: function() {    this.length = 0;    return this;  },  first: function() {    return this[0];  },  last: function() {    return this[this.length - 1];  },  compact: function() {    return this.select(function(value) {      return value != null;    });  },  flatten: function() {    return this.inject([], function(array, value) {      return array.concat(Object.isArray(value) ?        value.flatten() : [value]);    });  },  without: function() {    var values = $A(arguments);    return this.select(function(value) {      return !values.include(value);    });  },  reverse: function(inline) {    return (inline !== false ? this : this.toArray())._reverse();  },  reduce: function() {    return this.length > 1 ? this : this[0];  },  uniq: function(sorted) {    return this.inject([], function(array, value, index) {      if (0 == index || (sorted ? array.last() != value : !array.include(value)))        array.push(value);      return array;    });  },  intersect: function(array) {    return this.uniq().findAll(function(item) {      return array.detect(function(value) { return item === value });    });  },  clone: function() {    return [].concat(this);  },  size: function() {    return this.length;  },  inspect: function() {    return '[' + this.map(Object.inspect).join(', ') + ']';  },  toJSON: function() {    var results = [];    this.each(function(object) {      var value = Object.toJSON(object);      if (!Object.isUndefined(value)) results.push(value);    });    return '[' + results.join(', ') + ']';  }});// use native browser JS 1.6 implementation if availableif (Object.isFunction(Array.prototype.forEach))  Array.prototype._each = Array.prototype.forEach;if (!Array.prototype.indexOf) Array.prototype.indexOf = function(item, i) {  i || (i = 0);  var length = this.length;  if (i < 0) i = length + i;  for (; i < length; i++)    if (this[i] === item) return i;  return -1;};if (!Array.prototype.lastIndexOf) Array.prototype.lastIndexOf = function(item, i) {  i = isNaN(i) ? this.length : (i < 0 ? this.length + i : i) + 1;  var n = this.slice(0, i).reverse().indexOf(item);  return (n < 0) ? n : i - n - 1;};Array.prototype.toArray = Array.prototype.clone;function $w(string) {  if (!Object.isString(string)) return [];  string = string.strip();  return string ? string.split(/\s+/) : [];}if (Prototype.Browser.Opera){  Array.prototype.concat = function() {    var array = [];    for (var i = 0, length = this.length; i < length; i++) array.push(this[i]);    for (var i = 0, length = arguments.length; i < length; i++) {      if (Object.isArray(arguments[i])) {        for (var j = 0, arrayLength = arguments[i].length; j < arrayLength; j++)          array.push(arguments[i][j]);      } else {        array.push(arguments[i]);      }    }    return array;  };}Object.extend(Number.prototype, {  toColorPart: function() {    return this.toPaddedString(2, 16);  },  succ: function() {    return this + 1;  },  times: function(iterator, context) {    $R(0, this, true).each(iterator, context);    return this;  },  toPaddedString: function(length, radix) {    var string = this.toString(radix || 10);    return '0'.times(length - string.length) + string;  },  toJSON: function() {    return isFinite(this) ? this.toString() : 'null';  }});$w('abs round ceil floor').each(function(method){  Number.prototype[method] = Math[method].methodize();});function $H(object) {  return new Hash(object);};var Hash = Class.create(Enumerable, (function() {  function toQueryPair(key, value) {    if (Object.isUndefined(value)) return key;    return key + '=' + encodeURIComponent(String.interpret(value));  }  return {    initialize: function(object) {      this._object = Object.isHash(object) ? object.toObject() : Object.clone(object);    },    _each: function(iterator) {      for (var key in this._object) {        var value = this._object[key], pair = [key, value];        pair.key = key;        pair.value = value;        iterator(pair);      }    },    set: function(key, value) {      return this._object[key] = value;    },    get: function(key) {      // simulating poorly supported hasOwnProperty      if (this._object[key] !== Object.prototype[key])        return this._object[key];    },    unset: function(key) {      var value = this._object[key];      delete this._object[key];      return value;    },    toObject: function() {      return Object.clone(this._object);    },    keys: function() {      return this.pluck('key');    },    values: function() {      return this.pluck('value');    },    index: function(value) {      var match = this.detect(function(pair) {        return pair.value === value;      });      return match && match.key;    },    merge: function(object) {      return this.clone().update(object);    },    update: function(object) {      return new Hash(object).inject(this, function(result, pair) {        result.set(pair.key, pair.value);        return result;      });    },    toQueryString: function() {      return this.inject([], function(results, pair) {        var key = encodeURIComponent(pair.key), values = pair.value;        if (values && typeof values == 'object') {          if (Object.isArray(values))            return results.concat(values.map(toQueryPair.curry(key)));        } else results.push(toQueryPair(key, values));        return results;      }).join('&');    },    inspect: function() {      return '#<Hash:{' + this.map(function(pair) {        return pair.map(Object.inspect).join(': ');      }).join(', ') + '}>';    },    toJSON: function() {      return Object.toJSON(this.toObject());    },    clone: function() {      return new Hash(this);    }  }})());Hash.prototype.toTemplateReplacements = Hash.prototype.toObject;Hash.from = $H;var ObjectRange = Class.create(Enumerable, {  initialize: function(start, end, exclusive) {    this.start = start;    this.end = end;    this.exclusive = exclusive;  },  _each: function(iterator) {    var value = this.start;    while (this.include(value)) {      iterator(value);      value = value.succ();    }  },  include: function(value) {    if (value < this.start)      return false;    if (this.exclusive)      return value < this.end;    return value <= this.end;  }});var $R = function(start, end, exclusive) {  return new ObjectRange(start, end, exclusive);};var Ajax = {  getTransport: function() {    return Try.these(      function() {return new XMLHttpRequest()},      function() {return new ActiveXObject('Msxml2.XMLHTTP')},      function() {return new ActiveXObject('Microsoft.XMLHTTP')}    ) || false;  },  activeRequestCount: 0};Ajax.Responders = {  responders: [],  _each: function(iterator) {    this.responders._each(iterator);  },  register: function(responder) {    if (!this.include(responder))      this.responders.push(responder);  },  unregister: function(responder) {    this.responders = this.responders.without(responder);  },  dispatch: function(callback, request, transport, json) {    this.each(function(responder) {      if (Object.isFunction(responder[callback])) {        try {          responder[callback].apply(responder, [request, transport, json]);        } catch (e) { }      }    });  }};Object.extend(Ajax.Responders, Enumerable);Ajax.Responders.register({  onCreate:   function() { Ajax.activeRequestCount++ },  onComplete: function() { Ajax.activeRequestCount-- }});Ajax.Base = Class.create({  initialize: function(options) {    this.options = {      method:       'post',      asynchronous: true,      contentType:  'application/x-www-form-urlencoded',      encoding:     'UTF-8',      parameters:   '',      evalJSON:     true,      evalJS:       true    };    Object.extend(this.options, options || { });    this.options.method = this.options.method.toLowerCase();    if (Object.isString(this.options.parameters))      this.options.parameters = this.options.parameters.toQueryParams();    else if (Object.isHash(this.options.parameters))      this.options.parameters = this.options.parameters.toObject();  }});Ajax.Request = Class.create(Ajax.Base, {  _complete: false,  initialize: function($super, url, options) {    $super(options);    this.transport = Ajax.getTransport();    this.request(url);  },  request: function(url) {    this.url = url;    this.method = this.options.method;    var params = Object.clone(this.options.parameters);    if (!['get', 'post'].include(this.method)) {      // simulate other verbs over post      params['_method'] = this.method;      this.method = 'post';    }    this.parameters = params;    if (params = Object.toQueryString(params)) {      // when GET, append parameters to URL      if (this.method == 'get')        this.url += (this.url.include('?') ? '&' : '?') + params;      else if (/Konqueror|Safari|KHTML/.test(navigator.userAgent))        params += '&_=';    }    try {      var response = new Ajax.Response(this);      if (this.options.onCreate) this.options.onCreate(response);      Ajax.Responders.dispatch('onCreate', this, response);      this.transport.open(this.method.toUpperCase(), this.url,        this.options.asynchronous);      if (this.options.asynchronous) this.respondToReadyState.bind(this).defer(1);      this.transport.onreadystatechange = this.onStateChange.bind(this);      this.setRequestHeaders();      this.body = this.method == 'post' ? (this.options.postBody || params) : null;      this.transport.send(this.body);      /* Force Firefox to handle ready state 4 for synchronous requests */      if (!this.options.asynchronous && this.transport.overrideMimeType)        this.onStateChange();    }    catch (e) {      this.dispatchException(e);    }  },  onStateChange: function() {    var readyState = this.transport.readyState;    if (readyState > 1 && !((readyState == 4) && this._complete))      this.respondToReadyState(this.transport.readyState);  },  setRequestHeaders: function() {    var headers = {      'X-Requested-With': 'XMLHttpRequest',      'X-Prototype-Version': Prototype.Version,      'Accept': 'text/javascript, text/html, application/xml, text/xml, */*'    };    if (this.method == 'post') {      headers['Content-type'] = this.options.contentType +        (this.options.encoding ? '; charset=' + this.options.encoding : '');      /* Force "Connection: close" for older Mozilla browsers to work       * around a bug where XMLHttpRequest sends an incorrect       * Content-length header. See Mozilla Bugzilla #246651.       */      if (this.transport.overrideMimeType &&          (navigator.userAgent.match(/Gecko\/(\d{4})/) || [0,2005])[1] < 2005)            headers['Connection'] = 'close';    }    // user-defined headers    if (typeof this.options.requestHeaders == 'object') {      var extras = this.options.requestHeaders;      if (Object.isFunction(extras.push))        for (var i = 0, length = extras.length; i < length; i += 2)          headers[extras[i]] = extras[i+1];      else        $H(extras).each(function(pair) { headers[pair.key] = pair.value });    }    for (var name in headers)      this.transport.setRequestHeader(name, headers[name]);  },  success: function() {    var status = this.getStatus();    return !status || (status >= 200 && status < 300);  },  getStatus: function() {    try {      return this.transport.status || 0;    } catch (e) { return 0 }  },  respondToReadyState: function(readyState) {    var state = Ajax.Request.Events[readyState], response = new Ajax.Response(this);    if (state == 'Complete') {      try {        this._complete = true;        (this.options['on' + response.status]         || this.options['on' + (this.success() ? 'Success' : 'Failure')]         || Prototype.emptyFunction)(response, response.headerJSON);      } catch (e) {        this.dispatchException(e);      }      var contentType = response.getHeader('Content-type');      if (this.options.evalJS == 'force'          || (this.options.evalJS && this.isSameOrigin() && contentType          && contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))        this.evalResponse();    }    try {      (this.options['on' + state] || Prototype.emptyFunction)(response, response.headerJSON);      Ajax.Responders.dispatch('on' + state, this, response, response.headerJSON);    } catch (e) {      this.dispatchException(e);    }    if (state == 'Complete') {      // avoid memory leak in MSIE: clean up      this.transport.onreadystatechange = Prototype.emptyFunction;    }  },  isSameOrigin: function() {    var m = this.url.match(/^\s*https?:\/\/[^\/]*/);    return !m || (m[0] == '#{protocol}//#{domain}#{port}'.interpolate({      protocol: location.protocol,      domain: document.domain,      port: location.port ? ':' + location.port : ''    }));  },  getHeader: function(name) {    try {      return this.transport.getResponseHeader(name) || null;    } catch (e) { return null }  },  evalResponse: function() {    try {      return eval((this.transport.responseText || '').unfilterJSON());    } catch (e) {      this.dispatchException(e);    }  },  dispatchException: function(exception) {    (this.options.onException || Prototype.emptyFunction)(this, exception);    Ajax.Responders.dispatch('onException', this, exception);  }});Ajax.Request.Events =  ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];Ajax.Response = Class.create({  initialize: function(request){    this.request = request;    var transport  = this.transport  = request.transport,        readyState = this.readyState = transport.readyState;    if((readyState > 2 && !Prototype.Browser.IE) || readyState == 4) {      this.status       = this.getStatus();      this.statusText   = this.getStatusText();      this.responseText = String.interpre</hashsport.responseText);      this.headerJSON   = this._getHeaderJSON();    }    if(readyState == 4) {      var xml = transport.responseXML;      this.responseXML  = Object.isUndefined(xml) ? null : xml;      this.responseJSON = this._getResponseJSON();    }  },  status:      0,  statusText: '',  getStatus: Ajax.Request.prototype.getStatus,  getStatusText: function() {    try {      return this.transport.statusText || '';    } catch (e) { return '' }  },  getHeader: Ajax.Request.prototype.getHeader,  getAllHeaders: function() {    try {      return this.getAllResponseHeaders();    } catch (e) { return null }  },  getResponseHeader: function(name) {    return this.transport.getResponseHeader(name);  },  getAllResponseHeaders: function() {    return this.transport.getAllResponseHeaders();  },  _getHeaderJSON: function() {    var json = this.getHeader('X-JSON');    if (!json) return null;    json = decodeURIComponent(escape(json));    try {      return json.evalJSON(this.request.options.sanitizeJSON ||        !this.request.isSameOrigin());    } catch (e) {      this.request.dispatchException(e);    }  },  _getResponseJSON: function() {    var options = this.request.options;    if (!options.evalJSON || (options.evalJSON != 'force' &&      !(this.getHeader('Content-type') || '').include('application/json')) ||        this.responseText.blank())          return null;    try {      return this.responseText.evalJSON(options.sanitizeJSON ||        !this.request.isSameOrigin());    } catch (e) {      this.request.dispatchException(e);    }  }});Ajax.Updater = Class.create(Ajax.Request, {  initialize: function($super, container, url, options) {    this.container = {      success: (container.success || container),      failure: (container.failure || (container.success ? null : container))    };    options = Object.clone(options);    var onComplete = options.onComplete;    options.onComplete = (function(response, json) {      this.updateContent(response.responseText);      if (Object.isFunction(onComplete)) onComplete(response, json);    }).bind(this);    $super(url, options);  },  updateContent: function(responseText) {    var receiver = this.container[this.success() ? 'success' : 'failure'],        options = this.options;    if (!options.evalScripts) responseText = responseText.stripScripts();    if (receiver = $(receiver)) {      if (options.insertion) {        if (Object.isString(options.insertion)) {          var insertion = { }; insertion[options.insertion] = responseText;          receiver.insert(insertion);        }        else options.insertion(receiver, responseText);      }      else receiver.update(responseText);    }  }});Ajax.PeriodicalUpdater = Class.create(Ajax.Base, {  initialize: function($super, container, url, options) {    $super(options);    this.onComplete = this.options.onComplete;    this.frequency = (this.options.frequency || 2);    this.decay = (this.options.decay || 1);    this.updater = { };    this.container = container;    this.url = url;    this.start();  },  start: function() {    this.options.onComplete = this.updateComplete.bind(this);    this.onTimerEvent();  },  stop: function() {    this.updater.options.onComplete = undefined;    clearTimeout(this.timer);    (this.onComplete || Prototype.emptyFunction).apply(this, arguments);  },  updateComplete: function(response) {    if (this.options.decay) {      this.decay = (response.responseText == this.lastText ?        this.decay * this.options.decay : 1);      this.lastText = response.responseText;    }    this.timer = this.onTimerEvent.bind(this).delay(this.decay * this.frequency);  },  onTimerEvent: function() {    this.updater = new Ajax.Updater(this.container, this.url, this.options);  }});function $(element) {  if (arguments.length > 1) {    for (var i = 0, elements = [], length = arguments.length; i < length; i++)      elements.push($(arguments[i]));    return elements;  }  if (Object.isString(element))    element = document.getElementById(element);  return Element.extend(element);}if (Prototype.BrowserFeatures.XPath) {  document._getElementsByXPath = function(expression, parentElement) {    var results = [];    var query = document.evaluate(expression, $(parentElement) || document,      null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);    for (var i = 0, length = query.snapshotLength; i < length; i++)      results.push(Element.extend(query.snapshotItem(i)));    return results;  };}/*--------------------------------------------------------------------------*/if (!window.Node) var Node = { };if (!Node.ELEMENT_NODE) {  // DOM level 2 ECMAScript Language Binding  Object.extend(Node, {    ELEMENT_NODE: 1,    ATTRIBUTE_NODE: 2,    TEXT_NODE: 3,    CDATA_SECTION_NODE: 4,    ENTITY_REFERENCE_NODE: 5,    ENTITY_NODE: 6,    PROCESSING_INSTRUCTION_NODE: 7,    COMMENT_NODE: 8,    DOCUMENT_NODE: 9,    DOCUMENT_TYPE_NODE: 10,    DOCUMENT_FRAGMENT_NODE: 11,    NOTATION_NODE: 12  });}(function() {  var element = this.Element;  this.Element = function(tagName, attributes) {    attributes = attributes || { };    tagName = tagName.toLowerCase();    var cache = Element.cache;    if (Prototype.Browser.IE && attributes.name) {      tagName = '<' + tagName + ' name="' + attributes.name + '">';      delete attributes.name;      return Element.writeAttribute(document.createElement(tagName), attributes);    }    if (!cache[tagName]) cache[tagName] = Element.extend(document.createElement(tagName));    return Element.writeAttribute(cache[tagName].cloneNode(false), attributes);  };  Object.extend(this.Element, element || { });  if (element) this.Element.prototype = element.prototype;}).call(window);Element.cache = { };Element.Methods = {  visible: function(element) {    return $(element).style.display != 'none';  },  toggle: function(element) {    element = $(element);    Element[Element.visible(element) ? 'hide' : 'show'](element);    return element;  },  hide: function(element) {    element = $(element);    element.style.display = 'none';    return element;  },  show: function(element) {    element = $(element);    element.style.display = '';    return element;  },  remove: function(element) {    element = $(element);    element.parentNode.removeChild(element);    return element;  },  update: function(element, content) {    element = $(element);    if (content && content.toElement) content = content.toElement();    if (Object.isElement(content)) return element.update().insert(content);    content = Object.toHTML(content);    element.innerHTML = content.stripScripts();    content.evalScripts.bind(content).defer();    return element;  },  replace: function(element, content) {    element = $(element);    if (content && content.toElement) content = content.toElement();    else if (!Object.isElement(cont</hash{      content = Object.toHTML(content);      var range = element.ownerDocument.createRange();      range.selectNode(element);      content.evalScripts.bind(content).defer();      content = range.createContextualFragment(content.stripScripts());    }    element.parentNode.replaceChild(content, element);    return element;  },  insert: function(element, insertions) {    element = $(element);    if (Object.isString(insertions) || Object.isNumber(insertions) ||        Object.isElement(insertions) || (insertions && (insertions.toElement || insertions.toHTML)))          insertions = {bottom:insertions};    var content, insert, tagName, childNodes;    for (var position in insertions) {      content  = insertions[position];      position = position.toLowerCase();      insert = Element._insertionTranslations[position];      if (content && content.toElement) content = content.toElement();      if (Object.isElement(content)) {        insert(element, content);        continue;      }      content = Object.toHTML(content);      tagName = ((position == 'before' || position == 'after')        ? element.parentNode : element).tagName.toUpperCase();      childNodes = Element._getContentFromAnonymousElement(tagName, content.stripScripts());      if (position == 'top' || position == 'after') childNodes.reverse();      childNodes.each(insert.curry(element));      content.evalScripts.bind(content).defer();    }    return element;  },  wrap: function(element, wrapper, attributes) {    element = $(element);    if (Object.isElement(wrapper))      $(wrapper).writeAttribute(attributes || { });    else if (Object.isString(wrapper)) wrapper = new Element(wrapper, attributes);    else wrapper = new Element('div', wrapper);    if (element.parentNode)      element.parentNode.replaceChild(wrapper, element);    wrapper.appendChild(element);    return wrapper;  },  inspect: function(element) {    element = $(element);    var result = '<' + element.tagName.toLowerCase();    $H({'id': 'id', 'className': 'class'}).each(function(pair) {      var property = pair.first(), attribute = pair.last();      var value = (element[property] || '').toString();      if (value) result += ' ' + attribute + '=' + value.inspect(true);    });    return result + '>';  },  recursivelyCollect: function(element, property) {    element = $(element);    var elements = [];    while (element = element[property])      if (element.nodeType == 1)        elements.push(Element.extend(element));    return elements;  },  ancestors: function(element) {    return $(element).recursivelyCollect('parentNode');  },  descendants: function(element) {    return $(element).select("*");  },  firstDescendant: function(element) {    element = $(element).firstChild;    while (element && element.nodeType != 1) element = element.nextSibling;    return $(element);  },  immediateDescendants: function(element) {    if (!(element = $(element).firstChild)) return [];    while (element && element.nodeType != 1) element = element.nextSibling;    if (element) return [element].concat($(element).nextSiblings());    return [];  },  previousSiblings: function(element) {    return $(element).recursivelyCollect('previousSibling');  },  nextSiblings: function(element) {    return $(element).recursivelyCollect('nextSibling');  },  siblings: function(element) {    element = $(element);    return element.previousSiblings().reverse().concat(element.nextSiblings());  },  match: function(element, selector) {    if (Object.isString(selector))      selector = new Selector(selector);    return selector.match($(element));  },  up: function(element, expression, index) {    element = $(element);    if (arguments.length == 1) return $(element.parentNode);    var ancestors = element.ancestors();    return Object.isNumber(expression) ? ancestors[expression] :      Selector.findElement(ancestors, expression, index);  },  down: function(element, expression, index) {    element = $(element);    if (arguments.length == 1) return element.firstDescendant();    return Object.isNumber(expression) ? element.descendants()[expression] :      Element.select(element, expression)[index || 0];  },  previous: function(element, expression, index) {    element = $(element);    if (arguments.length == 1) return $(Selector.handlers.previousElementSibling(element));    var previousSiblings = element.previousSiblings();    return Object.isNumber(expression) ? previousSiblings[expression] :      Selector.findElement(previousSiblings, expression, index);  },  next: function(element, expression, index) {    element = $(element);    if (arguments.length == 1) return $(Selector.handlers.nextElementSibling(element));    var nextSiblings = element.nextSiblings();    return Object.isNumber(expression) ? nextSiblings[expression] :      Selector.findElement(nextSiblings, expression, index);  },  select: function() {    var args = $A(arguments), element = $(args.shift());    return Selector.findChildElements(element, args);  },  adjacent: function() {    var args = $A(arguments), element = $(args.shift());    return Selector.findChildElements(element.parentNode, args).without(element);  },  identify: function(element) {    element = $(element);    var id = element.readAttribute('id'), self = arguments.callee;    if (id) return id;    do { id = 'anonymous_element_' + self.counter++ } while ($(id));    element.writeAttribute('id', id);    return id;  },  readAttribute: function(element, name) {    element = $(element);    if (Prototype.Browser.IE) {      var t = Element._attributeTranslations.read;      if (t.values[name]) return t.values[name](element, name);      if (t.names[name]) name = t.names[name];      if (name.include(':')) {        return (!element.attributes || !element.attributes[name]) ? null :         element.attributes[name].value;      }    }    return element.getAttribute(name);  },  writeAttribute: function(element, name, value) {    element = $(element);    var attributes = { }, t = Element._attributeTranslations.write;    if (typeof name == 'object') attributes = name;    else attributes[name] = Object.isUndefined(value) ? true : value;    for (var attr in attributes) {      name = t.names[attr] || attr;      value = attributes[attr];      if (t.values[attr]) name = t.values[attr](element, value);      if (value === false || value === null)        element.removeAttribute(name);      else if (value === true)        element.setAttribute(name, name);      else element.setAttribute(name, value);    }    return element;  },  getHeight: function(element) {    return $(element).getDimensions().height;  },  getWidth: function(element) {    return $(element).getDimensions().width;  },  classNames: function(element) {    return new Element.ClassNames(element);  },  hasClassName: function(element, className) {    if (!(element = $(element))) return;    var elementClassName = element.className;    return (elementClassName.length > 0 && (elementClassName == className ||      new RegExp("(^|\\s)" + className + "(\\s|$)").test(elementClassName)));  },  addClassName: function(element, className) {    if (!(element = $(element))) return;    if (!element.hasClassName(className))      element.className += (element.className ? ' ' : '') + className;    return element;  },  removeClassName: function(element, className) {    if (!(element = $(element))) return;    element.className = element.className.replace(      new RegExp("(^|\\s+)" + className + "(\\s+|$)"), ' ').strip();    return element;  },  toggleClassName: function(element, className) {    if (!(element = $(element))) return;    return element[element.hasClassName(className) ?      'removeClassName' : 'addClassName'](className);  },  // removes whitespace-only text node children  cleanWhitespace: function(element) {    element = $(element);    var node = element.firstChild;    while (node) {      var nextNode = node.nextSibling;      if (node.nodeType == 3 && !/\S/.test(node.nodeValue))        element.removeChild(node);      node = nextNode;    }    return element;  },  empty: function(element) {    return $(element).innerHTML.blank();  },  descendantOf: function(element, ancestor) {    element = $(element), ancestor = $(ancestor);    if (element.compareDocumentPosition)      return (element.compareDocumentPosition(ancestor) & 8) === 8;    if (ancestor.contains)      return ancestor.contains(element) && ancestor !== element;    while (element = element.parentNode)      if (element == ancestor) return true;    return false;  },  scrollTo: function(element) {    element = $(element);    var pos = element.cumulativeOffset();    window.scrollTo(pos[0], pos[1]);    return element;  },  getStyle: function(element, style) {    element = $(element);    style = style == 'float' ? 'cssFloat' : style.camelize();    var value = element.style[style];    if (!value || value == 'auto') {      var css = document.defaultView.getComputedStyle(element, null);      value = css ? css[style] : null;    }    if (style == 'opacity') return value ? parseFloat(value) : 1.0;    return value == 'auto' ? null : value;  },  getOpacity: function(element) {    return $(element).getStyle('opacity');  },  setStyle: function(element, styles) {    element = $(element);    var elementStyle = element.style, match;    if (Object.isString(styles)) {      element.style.cssText += ';' + styles;      return styles.include('opacity') ?        element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]) : element;    }    for (var property in styles)      if (property == 'opacity') element.setOpacity(styles[property]);      else        elementStyle[(property == 'float' || property == 'cssFloat') ?          (Object.isUndefined(elementStyle.styleFloat) ? 'cssFloat' : 'styleFloat') :            property] = styles[property];    return element;  },  setOpacity: function(element, value) {    element = $(element);    element.style.opacity = (value == 1 || value === '') ? '' :      (value < 0.00001) ? 0 : value;    return element;  },  getDimensions: function(element) {    element = $(element);    var display = element.getStyle('display');    if (display != 'none' && display != null) // Safari bug      return {width: element.offsetWidth, height: element.offsetHeight};    // All *Width and *Height properties give 0 on elements with display none,    // so enable the element temporarily    var els = element.style;    var originalVisibility = els.visibility;    var originalPosition = els.position;    var originalDisplay = els.display;    els.visibility = 'hidden';    els.position = 'absolute';    els.display = 'block';    var originalWidth = element.clientWidth;    var originalHeight = element.clientHeight;    els.display = originalDisplay;    els.position = originalPosition;    els.visibility = originalVisibility;    return {width: originalWidth, height: originalHeight};  },  makePositioned: function(element) {    element = $(element);    var pos = Element.getStyle(element, 'position');    if (pos == 'static' || !pos) {      element._madePositioned = true;      element.style.position = 'relative';      // Opera returns the offset relative to the positioning context, when an      // element is position relative but top and left have not been defined      if (Prototype.Browser.Opera) {        element.style.top = 0;        element.style.left = 0;      }    }    return element;  },  undoPositioned: function(element) {    element = $(element);    if (element._madePositioned) {      element._madePositioned = undefined;      element.style.position =        element.style.top =        element.style.left =        element.style.bottom =        element.style.right = '';    }    return element;  },  makeClipping: function(element) {    element = $(element);    if (element._overflow) return element;    element._overflow = Element.getStyle(element, 'overflow') || 'auto';    if (element._overflow !== 'hidden')      element.style.overflow = 'hidden';    return element;  },  undoClipping: function(element) {    element = $(element);    if (!element._overflow) return element;    element.style.overflow = element._overflow == 'auto' ? '' : element._overflow;    element._overflow = null;    return element;  },  cumulativeOffset: function(element) {    var valueT = 0, valueL = 0;    do {      valueT += element.offsetTop  || 0;      valueL += element.offsetLeft || 0;      element = element.offsetParent;    } while (element);    return Element._returnOffset(valueL, valueT);  },  positionedOffset: function(element) {    var valueT = 0, valueL = 0;    do {      valueT += element.offsetTop  || 0;      valueL += element.offsetLeft || 0;      element = element.offsetParent;      if (element) {        if (element.tagName.toUpperCase() == 'BODY') break;        var p = Element.getStyle(element, 'position');        if (p !== 'static') break;      }    } while (element);    return Element._returnOffset(valueL, valueT);  },  absolutize: function(element) {    element = $(element);    if (element.getStyle('position') == 'absolute') return element;    // Position.prepare(); // To be done manually by Scripty when it needs it.    var offsets = element.positionedOffset();    var top     = offsets[1];    var left    = offsets[0];    var width   = element.clientWidth;    var height  = element.clientHeight;    element._originalLeft   = left - parseFloat(element.style.left  || 0);    element._originalTop    = top  - parseFloat(element.style.top || 0);    element._originalWidth  = element.style.width;    element._originalHeight = element.style.height;    element.style.position = 'absolute';    element.style.top    = top + 'px';    element.style.left   = left + 'px';    element.style.width  = width + 'px';    element.style.height = height + 'px';    return element;  },  relativize: function(element) {    element = $(element);    if (element.getStyle('position') == 'relative') return element;    // Position.prepare(); // To be done manually by Scripty when it needs it.    element.style.position = 'relative';    var top  = parseFloat(element.style.top  || 0) - (element._originalTop || 0);    var left = parseFloat(element.style.left || 0) - (element._originalLeft || 0);    element.style.top    = top + 'px';    element.style.left   = left + 'px';    element.style.height = element._originalHeight;    element.style.width  = element._originalWidth;    return element;  },  cumulativeScrollOffset: function(element) {    var valueT = 0, valueL = 0;    do {      valueT += element.scrollTop  || 0;      valueL += element.scrollLeft || 0;      element = element.parentNode;    } while (element);    return Element._returnOffset(valueL, valueT);  },  getOffsetParent: function(element) {    if (element.offsetParent) return $(element.offsetParent);    if (element == document.body) return $(element);    while ((element = element.parentNode) && element != document.body)      if (Element.getStyle(element, 'position') != 'static')        return $(element);    return $(document.body);  },  viewportOffset: function(forElement) {    var valueT = 0, valueL = 0;    var element = forElement;    do {      valueT += element.offsetTop  || 0;      valueL += element.offsetLeft || 0;      // Safari fix      if (element.offsetParent == document.body &&        Element.getStyle(element, 'position') == 'absolute') break;    } while (element = element.offsetParent);    element = forElement;    do {      if (!Prototype.Browser.Opera || (element.tagName && (element.tagName.toUpperCase() == 'BODY'))) {        valueT -= element.scrollTop  || 0;        valueL -= element.scrollLeft || 0;      }    } while (element = element.parentNode);    return Element._returnOffset(valueL, valueT);  },  clonePosition: function(element, source) {    var options = Object.extend({      setLeft:    true,      setTop:     true,      setWidth:   true,      setHeight:  true,      offsetTop:  0,      offsetLeft: 0    }, arguments[2] || { });    // find page position of source    source = $(source);    var p = source.viewportOffset();    // find coordinate system to use    element = $(element);    var delta = [0, 0];    var parent = null;    // delta [0,0] will do fine with position: fixed elements,    // position:absolute needs offsetParent deltas    if (Element.getStyle(element, 'position') == 'absolute') {      parent = element.getOffsetParent();      delta = parent.viewportOffset();    }    // correct by body offsets (fixes Safari)    if (parent == document.body) {      delta[0] -= document.body.offsetLeft;      delta[1] -= document.body.offsetTop;    }    // set position    if (options.setLeft)   element.style.left  = (p[0] - delta[0] + options.offsetLeft) + 'px';    if (options.setTop)    element.style.top   = (p[1] - delta[1] + options.offsetTop) + 'px';    if (options.setWidth)  element.style.width = source.offsetWidth + 'px';    if (options.setHeight) element.style.height = source.offsetHeight + 'px';    return element;  }};Element.Methods.identify.counter = 1;Object.extend(Element.Methods, {  getElementsBySelector: Element.Methods.select,  childElements: Element.Methods.immediateDescendants});Element._attributeTranslations = {  write: {    names: {      className: 'class',      htmlFor:   'for'    },    values: { }  }};if (Prototype.Browser.Opera) {  Element.Methods.getStyle = Element.Methods.getStyle.wrap(    function(proceed, element, style) {      switch (style) {        case 'left': case 'top': case 'right': case 'bottom':          if (proceed(element, 'position') === 'static') return null;        case 'height': case 'width':          // returns '0px' for hidden elements; we want it to return null          if (!Element.visible(element)) return null;          // returns the border-box dimensions rather than the content-box          // dimensions, so we subtract padding and borders from the value          var dim = parseInt(proceed(element, style), 10);          if (dim !== element['offset' + style.capitalize()])            return dim + 'px';          var properties;          if (style === 'height') {            properties = ['border-top-width', 'padding-top',             'padding-bottom', 'border-bottom-width'];          }          else {            properties = ['border-left-width', 'padding-left',             'padding-right', 'border-right-width'];          }          return properties.inject(dim, function(memo, property) {            var val = proceed(element, property);            return val === null ? memo : memo - parseInt(val, 10);          }) + 'px';        default: return proceed(element, style);      }    }  );  Element.Methods.readAttribute = Element.Methods.readAttribute.wrap(    function(proceed, element, attribute) {      if (attribute === 'title') return element.title;      return proceed(element, attribute);    }  );}else if (Prototype.Browser.IE) {  // IE doesn't report offsets correctly for static elements, so we change them  // to "relative" to get the values, then change them back.  Element.Methods.getOffsetParent = Element.Methods.getOffsetParent.wrap(    function(proceed, element) {      element = $(element);      // IE throws an error if element is not in document      try { element.offsetParent }      catch(e) { return $(document.body) }      var position = element.getStyle('position');      if (position !== 'static') return proceed(element);      element.setStyle({ position: 'relative' });      var value = proceed(element);      element.setStyle({ position: position });      return value;    }  );  $w('positionedOffset viewportOffset').each(function(method) {    Element.Methods[method] = Element.Methods[method].wrap(      function(proceed, element) {        element = $(element);        try { element.offsetParent }        catch(e) { return Element._returnOffset(0,0) }        var position = element.getStyle('position');        if (position !== 'static') return proceed(element);        // Trigger hasLayout on the offset parent so that IE6 reports        // accurate offsetTop and offsetLeft values for position: fixed.        var offsetParent = element.getOffsetParent();        if (offsetParent && offsetParent.getStyle('position') === 'fixed')          offsetParent.setStyle({ zoom: 1 });        element.setStyle({ position: 'relative' });        var value = proceed(element);        element.setStyle({ position: position });        return value;      }    );  });  Element.Methods.cumulativeOffset = Element.Methods.cumulativeOffset.wrap(    function(proceed, element) {      try { element.offsetParent }      catch(e) { return Element._returnOffset(0,0) }      return proceed(element);    }  );  Element.Methods.getStyle = function(element, style) {    element = $(element);    style = (style == 'float' || style == 'cssFloat') ? 'styleFloat' : style.camelize();    var value = element.style[style];    if (!value && element.currentStyle) value = element.currentStyle[style];    if (style == 'opacity') {      if (value = (element.getStyle('filter') || '').match(/alpha\(opacity=(.*)\)/))        if (value[1]) return parseFloat(value[1]) / 100;      return 1.0;    }    if (value == 'auto') {      if ((style == 'width' || style == 'height') && (element.getStyle('display') != 'none'))        return element['offset' + style.capitalize()] + 'px';      return null;    }    return value;  };  Element.Methods.setOpacity = function(element, value) {    function stripAlpha(filter){      return filter.replace(/alpha\([^\)]*\)/gi,'');    }    element = $(element);    var currentStyle = element.currentStyle;    if ((currentStyle && !currentStyle.hasLayout) ||      (!currentStyle && element.style.zoom == 'normal'))        element.style.zoom = 1;    var filter = element.getStyle('filter'), style = element.style;    if (value == 1 || value === '') {      (filter = stripAlpha(filter)) ?        style.filter = filter : style.removeAttribute('filter');      return element;    } else if (value < 0.00001) value = 0;    style.filter = stripAlpha(filter) +      'alpha(opacity=' + (value * 100) + ')';    return element;  };  Element._attributeTranslations = {    read: {      names: {        'class': 'className',        'for':   'htmlFor'      },      values: {        _getAttr: function(element, attribute) {          return element.getAttribute(attribute, 2);        },        _getAttrNode: function(element, attribute) {          var node = element.getAttributeNode(attribute);          return node ? node.value : "";        },        _getEv: function(element, attribute) {          attribute = element.getAttribute(attribute);          return attribute ? attribute.toString().slice(23, -2) : null;        },        _flag: function(element, attribute) {          return $(element).hasAttribute(attribute) ? attribute : null;        },        style: function(element) {          return element.style.cssText.toLowerCase();        },        title: function(element) {          return element.title;        }      }    }  };  Element._attributeTranslations.write = {    names: Object.extend({      cellpadding: 'cellPadding',      cellspacing: 'cellSpacing'    }, Element._attributeTranslations.read.names),    values: {      checked: function(element, value) {        element.checked = !!value;      },      style: function(element, value) {        element.style.cssText = value ? value : '';      }    }  };  Element._attributeTranslations.has = {};  $w('colSpan rowSpan vAlign dateTime accessKey tabIndex ' +      'encType maxLength readOnly longDesc frameBorder').each(function(attr) {    Element._attributeTranslations.write.names[attr.toLowerCase()] = attr;    Element._attributeTranslations.has[attr.toLowerCase()] = attr;  });  (function(v) {    Object.extend(v, {      href:        v._getAttr,      src:         v._getAttr,      type:        v._getAttr,      action:      v._getAttrNode,      disabled:    v._flag,      checked:     v._flag,      readonly:    v._flag,      multiple:    v._flag,      onload:      v._getEv,      onunload:    v._getEv,      onclick:     v._getEv,      ondblclick:  v._getEv,      onmousedown: v._getEv,      onmouseup:   v._getEv,      onmouseover: v._getEv,      onmousemove: v._getEv,      onmouseout:  v._getEv,      onfocus:     v._getEv,      onblur:      v._getEv,      onkeypress:  v._getEv,      onkeydown:   v._getEv,      onkeyup:     v._getEv,      onsubmit:    v._getEv,      onreset:     v._getEv,      onselect:    v._getEv,      onchange:    v._getEv    });  })(Element._attributeTranslations.read.values);}else if (Prototype.Browser.Gecko && /rv:1\.8\.0/.test(navigator.userAgent)) {  Element.Methods.setOpacity = function(element, value) {    element = $(element);    element.style.opacity = (value == 1) ? 0.999999 :      (value === '') ? '' : (value < 0.00001) ? 0 : value;    return element;  };}else if (Prototype.Browser.WebKit) {  Element.Methods.setOpacity = function(element, value) {    element = $(element);    element.style.opacity = (value == 1 || value === '') ? '' :      (value < 0.00001) ? 0 : value;    if (value == 1)      if(element.tagName.toUpperCase() == 'IMG' && element.width) {        element.width++; element.width--;      } else try {        var n = document.createTextNode(' ');        element.appendChild(n);        element.removeChild(n);      } catch (e) { }    return element;  };  // Safari returns margins on body which is incorrect if the child is absolutely  // positioned.  For performance reasons, redefine Element#cumulativeOffset for  // KHTML/WebKit only.  Element.Methods.cumulativeOffset = function(element) {    var valueT = 0, valueL = 0;    do {      valueT += element.offsetTop  || 0;      valueL += element.offsetLeft || 0;      if (element.offsetParent == document.body)        if (Element.getStyle(element, 'position') == 'absolute') break;      element = element.offsetParent;    } while (element);    return Element._returnOffset(valueL, valueT);  };}if (Prototype.Browser.IE || Prototype.Browser.Opera) {  // IE and Opera are missing .innerHTML support for TABLE-related and SELECT elements  Element.Methods.update = function(element, content) {    element = $(element);    if (content && content.toElement) content = content.toElement();    if (Object.isElement(content)) return element.update().insert(content);    content = Object.toHTML(content);    var tagName = element.tagName.toUpperCase();    if (tagName in Element._insertionTranslations.tags) {      $A(element.childNodes).each(function(node) { element.removeChild(node) });      Element._getContentFromAnonymousElement(tagName, content.stripScripts())        .each(function(node) { element.appendChild(node) });    }    else element.innerHTML = content.stripScripts();    content.evalScripts.bind(content).defer();    return element;  };}if ('outerHTML' in document.createElement('div')) {  Element.Methods.replace = function(element, content) {    element = $(element);    if (content && content.toElement) content = content.toElement();    if (Object.isElement(content)) {      element.parentNode.replaceChild(content, element);      return element;    }    content = Object.toHTML(content);    var parent = element.parentNode, tagName = parent.tagName.toUpperCase();    if (Element._insertionTranslations.tags[tagName]) {      var nextSibling = element.next();      var fragments = Element._getContentFromAnonymousElement(tagName, content.stripScripts());      parent.removeChild(element);      if (nextSibling)        fragments.each(function(node) { parent.insertBefore(node, nextSibling) });      else        fragments.each(function(node) { parent.appendChild(node) });    }    else element.outerHTML = content.stripScripts();    content.evalScripts.bind(content).defer();    return element;  };}Element._returnOffset = function(l, t) {  var result = [l, t];  result.left = l;  result.top = t;  return result;};Element._getContentFromAnonymousElement = function(tagName, html) {  var div = new Element('div'), t = Element._insertionTranslations.tags[tagName];  if (t) {    div.innerHTML = t[0] + html + t[1];    t[2].times(function() { div = div.firstChild });  } else div.innerHTML = html;  return $A(div.childNodes);};Element._insertionTranslations = {  before: function(element, node) {    element.parentNode.insertBefore(node, element);  },  top: function(element, node) {    element.insertBefore(node, element.firstChild);  },  bottom: function(element, node) {    element.appendChild(node);  },  after: function(element, node) {    element.parentNode.insertBefore(node, element.nextSibling);  },  tags: {    TABLE:  ['<table>',                '</table>',                   1],    TBODY:  ['<table><tbody>',         '</tbody></table>',           2],    TR:     ['<table><tbody><tr>',     '</tr></tbody></table>',      3],    TD:     ['<table><tbody><tr><td>', '</td></tr></tbody></table>', 4],    SELECT: ['<select>',               '</select>',                  1]  }};(function() {  Object.extend(this.tags, {    THEAD: this.tags.TBODY,    TFOOT: this.tags.TBODY,    TH:    this.tags.TD  });}).call(Element._insertionTranslations);Element.Methods.Simulated = {  hasAttribute: function(element, attribute) {    attribute = Element._attributeTranslations.has[attribute] || attribute;    var node = $(element).getAttributeNode(attribute);    return !!(node && node.specified);  }};Element.Methods.ByTag = { };Object.extend(Element, Element.Methods);if (!Prototype.BrowserFeatures.ElementExtensions &&    document.createElement('div')['__proto__']) {  window.HTMLElement = { };  window.HTMLElement.prototype = document.createElement('div')['__proto__'];  Prototype.BrowserFeatures.ElementExtensions = true;}Element.extend = (function() {  if (Prototype.BrowserFeatures.SpecificElementExtensions)    return Prototype.K;  var Methods = { }, ByTag = Element.Methods.ByTag;  var extend = Object.extend(function(element) {    if (!element || element._extendedByPrototype ||        element.nodeType != 1 || element == window) return element;    var methods = Object.clone(Methods),      tagName = element.tagName.toUpperCase(), property, value;    // extend methods for specific tags    if (ByTag[tagName]) Object.extend(methods, ByTag[tagName]);    for (property in methods) {      value = methods[property];      if (Object.isFunction(value) && !(property in element))        element[property] = value.methodize();    }    element._extendedByPrototype = Prototype.emptyFunction;    return element;  }, {    refresh: function() {      // extend methods for all tags (Safari doesn't need this)      if (!Prototype.BrowserFeatures.ElementExtensions) {        Object.extend(Methods, Element.Methods);        Object.extend(Methods, Element.Methods.Simulated);      }    }  });  extend.refresh();  return extend;})();Element.hasAttribute = function(element, attribute) {  if (element.hasAttribute) return element.hasAttribute(attribute);  return Element.Methods.Simulated.hasAttribute(element, attribute);};Element.addMethods = function(methods) {  var F = Prototype.BrowserFeatures, T = Element.Methods.ByTag;  if (!methods) {    Object.extend(Form, Form.Methods);    Object.extend(Form.Element, Form.Element.Methods);    Object.extend(Element.Methods.ByTag, {      "FORM":     Object.clone(Form.Methods),      "INPUT":    Object.clone(Form.Element.Methods),      "SELECT":   Object.clone(Form.Element.Methods),      "TEXTAREA": Object.clone(Form.Element.Methods)    });  }  if (arguments.length == 2) {    var tagName = methods;    methods = arguments[1];  }  if (!tagName) Object.extend(Element.Methods, methods || { });  else {    if (Object.isArray(tagName)) tagName.each(extend);    else extend(tagName);  }  function extend(tagName) {    tagName = tagName.toUpperCase();    if (!Element.Methods.ByTag[tagName])      Element.Methods.ByTag[tagName] = { };    Object.extend(Element.Methods.ByTag[tagName], methods);  }  function copy(methods, destination, onlyIfAbsent) {    onlyIfAbsent = onlyIfAbsent || false;    for (var property in methods) {      var value = methods[property];      if (!Object.isFunction(value)) continue;      if (!onlyIfAbsent || !(property in destination))        destination[property] = value.methodize();    }  }  function findDOMClass(tagName) {    var klass;    var trans = {      "OPTGROUP": "OptGroup", "TEXTAREA": "TextArea", "P": "Paragraph",      "FIELDSET": "FieldSet", "UL": "UList", "OL": "OList", "DL": "DList",      "DIR": "Directory", "H1": "Heading", "H2": "Heading", "H3": "Heading",      "H4": "Heading", "H5": "Heading", "H6": "Heading", "Q": "Quote",      "INS": "Mod", "DEL": "Mod", "A": "Anchor", "IMG": "Image", "CAPTION":      "TableCaption", "COL": "TableCol", "COLGROUP": "TableCol", "THEAD":      "TableSection", "TFOOT": "TableSection", "TBODY": "TableSection", "TR":      "TableRow", "TH": "TableCell", "TD": "TableCell", "FRAMESET":      "FrameSet", "IFRAME": "IFrame"    };    if (trans[tagName]) klass = 'HTML' + trans[tagName] + 'Element';    if (window[klass]) return window[klass];    klass = 'HTML' + tagName + 'Element';    if (window[klass]) return window[klass];    klass = 'HTML' + tagName.capitalize() + 'Element';    if (window[klass]) return window[klass];    window[klass] = { };    window[klass].prototype = document.createElement(tagName)['__proto__'];    return window[klass];  }  if (F.ElementExtensions) {    copy(Element.Methods, HTMLElement.prototype);    copy(Element.Methods.Simulated, HTMLElement.prototype, true);  }  if (F.SpecificElementExtensions) {    for (var tag in Element.Methods.ByTag) {      var klass = findDOMClass(tag);      if (Object.isUndefined(klass)) continue;      copy(T[tag], klass.prototype);    }  }  Object.extend(Element, Element.Methods);  delete Element.ByTag;  if (Element.extend.refresh) Element.extend.refresh();  Element.cache = { };};document.viewport = {  getDimensions: function() {    var dimensions = { }, B = Prototype.Browser;    $w('width height').each(function(d) {      var D = d.capitalize();      if (B.WebKit && !document.evaluate) {        // Safari <3.0 needs self.innerWidth/Height        dimensions[d] = self['inner' + D];      } else if (B.Opera && parseFloat(window.opera.version()) < 9.5) {        // Opera <9.5 needs document.body.clientWidth/Height        dimensions[d] = document.body['client' + D]      } else {        dimensions[d] = document.documentElement['client' + D];      }    });    return dimensions;  },  getWidth: function() {    return this.getDimensions().width;  },  getHeight: function() {    return this.getDimensions().height;  },  getScrollOffsets: function() {    return Element._returnOffset(      window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,      window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop);  }};/* Portions of the Selector class are derived from Jack Slocum's DomQuery, * part of YUI-Ext version 0.40, distributed under the terms of an MIT-style * license.  Please see http://www.yui-ext.com/ for more information. */var Selector = Class.create({  initialize: function(expression) {    this.expression = expression.strip();    if (this.shouldUseSelectorsAPI()) {      this.mode = 'selectorsAPI';    } else if (this.shouldUseXPath()) {      this.mode = 'xpath';      this.compileXPathMatcher();    } else {      this.mode = "normal";      this.compileMatcher();    }  },  shouldUseXPath: function() {    if (!Prototype.BrowserFeatures.XPath) return false;    var e = this.expression;    // Safari 3 chokes on :*-of-type and :empty    if (Prototype.Browser.WebKit &&     (e.include("-of-type") || e.include(":empty")))      return false;    // XPath can't do namespaced attributes, nor can it read    // the "checked" property from DOM nodes    if ((/(\[[\w-]*?:|:checked)/).test(e))      return false;    return true;  },  shouldUseSelectorsAPI: function() {    if (!Prototype.BrowserFeatures.SelectorsAPI) return false;    if (!Selector._div) Selector._div = new Element('div');    // Make sure the browser treats the selector as valid. Test on an    // isolated element to minimize cost of this check.    try {      Selector._div.querySelector(this.expression);    } catch(e) {      return false;    }    return true;  },  compileMatcher: function() {    var e = this.expression, ps = Selector.patterns, h = Selector.handlers,        c = Selector.criteria, le, p, m;    if (Selector._cache[e]) {      this.matcher = Selector._cache[e];      return;    }    this.matcher = ["this.matcher = function(root) {",                    "var r = root, h = Selector.handlers, c = false, n;"];    while (e && le != e && (/\S/).test(e)) {      le = e;      for (var i in ps) {        p = ps[i];        if (m = e.match(p)) {          this.matcher.push(Object.isFunction(c[i]) ? c[i](m) :            new Template(c[i]).evaluate(m));          e = e.replace(m[0], '');          break;        }      }    }    this.matcher.push("return h.unique(n);\n}");    eval(this.matcher.join('\n'));    Selector._cache[this.expression] = this.matcher;  },  compileXPathMatcher: function() {    var e = this.expression, ps = Selector.patterns,        x = Selector.xpath, le, m;    if (Selector._cache[e]) {      this.xpath = Selector._cache[e]; return;    }    this.matcher = ['.//*'];    while (e && le != e && (/\S/).test(e)) {      le = e;      for (var i in ps) {        if (m = e.match(ps[i])) {          this.matcher.push(Object.isFunction(x[i]) ? x[i](m) :            new Template(x[i]).evaluate(m));          e = e.replace(m[0], '');          break;        }      }    }    this.xpath = this.matcher.join('');    Selector._cache[this.expression] = this.xpath;  },  findElements: function(root) {    root = root || document;    var e = this.expression, results;    switch (this.mode) {      case 'selectorsAPI':        // querySelectorAll queries document-wide, then filters to descendants        // of the context element. That's not what we want.        // Add an explicit context to the selector if necessary.        if (root !== document) {          var oldId = root.id, id = $(root).identify();          e = "#" + id + " " + e;        }        results = $A(root.querySelectorAll(e)).map(Element.extend);        root.id = oldId;        return results;      case 'xpath':        return document._getElementsByXPath(this.xpath, root);      default:       return this.matcher(root);    }  },  match: function(element) {    this.tokens = [];    var e = this.expression, ps = Selector.patterns, as = Selector.assertions;    var le, p, m;    while (e && le !== e && (/\S/).test(e)) {      le = e;      for (var i in ps) {        p = ps[i];        if (m = e.match(p)) {          // use the Selector.assertions methods unless the selector          // is too complex.          if (as[i]) {            this.tokens.push([i, Object.clone(m)]);            e = e.replace(m[0], '');          } else {            // reluctantly do a document-wide search            // and look for a match in the array            return this.findElements(document).include(element);          }        }      }    }    var match = true, name, matches;    for (var i = 0, token; token = this.tokens[i]; i++) {      name = token[0], matches = token[1];      if (!Selector.assertions[name](element, matches)) {        match = false; break;      }    }    return match;  },  toString: function() {    return this.expression;  },  inspect: function() {    return "#<Selector:" + this.expression.inspect() + ">";  }});Object.extend(Selector, {  _cache: { },  xpath: {    descendant:   "//*",    child:        "/*",    adjacent:     "/following-sibling::*[1]",    laterSibling: '/following-sibling::*',    tagName:      function(m) {      if (m[1] == '*') return '';      return "[local-name()='" + m[1].toLowerCase() +             "' or local-name()='" + m[1].toUpperCase() + "']";    },    className:    "[contains(concat(' ', @class, ' '), ' #{1} ')]",    id:           "[@id='#{1}']",    attrPresence: function(m) {      m[1] = m[1].toLowerCase();      return new Template("[@#{1}]").evaluate(m);    },    attr: function(m) {      m[1] = m[1].toLowerCase();      m[3] = m[5] || m[6];      return new Template(Selector.xpath.operators[m[2]]).evaluate(m);    },    pseudo: function(m) {      var h = Selector.xpath.pseudos[m[1]];      if (!h) return '';      if (Object.isFunction(h)) return h(m);      return new Template(Selector.xpath.pseudos[m[1]]).evaluate(m);    },    operators: {      '=':  "[@#{1}='#{3}']",      '!=': "[@#{1}!='#{3}']",      '^=': "[starts-with(@#{1}, '#{3}')]",      '$=': "[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']",      '*=': "[contains(@#{1}, '#{3}')]",      '~=': "[contains(concat(' ', @#{1}, ' '), ' #{3} ')]",      '|=': "[contains(concat('-', @#{1}, '-'), '-#{3}-')]"    },    pseudos: {      'first-child': '[not(preceding-sibling::*)]',      'last-child':  '[not(following-sibling::*)]',      'only-child':  '[not(preceding-sibling::* or following-sibling::*)]',      'empty':       "[count(*) = 0 and (count(text()) = 0)]",      'checked':     "[@checked]",      'disabled':    "[(@disabled) and (@type!='hidden')]",      'enabled':     "[not(@disabled) and (@type!='hidden')]",      'not': function(m) {        var e = m[6], p = Selector.patterns,            x = Selector.xpath, le, v;        var exclusion = [];        while (e && le != e && (/\S/).test(e)) {          le = e;          for (var i in p) {            if (m = e.match(p[i])) {              v = Object.isFunction(x[i]) ? x[i](m) : new Template(x[i]).evaluate(m);              exclusion.push("(" + v.substring(1, v.length - 1) + ")");              e = e.replace(m[0], '');              break;            }          }        }        return "[not(" + exclusion.join(" and ") + ")]";      },      'nth-child':      function(m) {        return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ", m);      },      'nth-last-child': function(m) {        return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ", m);      },      'nth-of-type':    function(m) {        return Selector.xpath.pseudos.nth("position() ", m);      },      'nth-last-of-type': function(m) {        return Selector.xpath.pseudos.nth("(last() + 1 - position()) ", m);      },      'first-of-type':  function(m) {        m[6] = "1"; return Selector.xpath.pseudos['nth-of-type'](m);      },      'last-of-type':   function(m) {        m[6] = "1"; return Selector.xpath.pseudos['nth-last-of-type'](m);      },      'only-of-type':   function(m) {        var p = Selector.xpath.pseudos; return p['first-of-type'](m) + p['last-of-type'](m);      },      nth: function(fragment, m) {        var mm, formula = m[6], predicate;        if (formula == 'even') formula = '2n+0';        if (formula == 'odd')  formula = '2n+1';        if (mm = formula.match(/^(\d+)$/)) // digit only          return '[' + fragment + "= " + mm[1] + ']';        if (mm = formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // an+b          if (mm[1] == "-") mm[1] = -1;          var a = mm[1] ? Number(mm[1]) : 1;          var b = mm[2] ? Number(mm[2]) : 0;          predicate = "[((#{fragment} - #{b}) mod #{a} = 0) and " +          "((#{fragment} - #{b}) div #{a} >= 0)]";          return new Template(predicate).evaluate({            fragment: fragment, a: a, b: b });        }      }    }  },  criteria: {    tagName:      'n = h.tagName(n, r, "#{1}", c);      c = false;',    className:    'n = h.className(n, r, "#{1}", c);    c = false;',    id:           'n = h.id(n, r, "#{1}", c);           c = false;',    attrPresence: 'n = h.attrPresence(n, r, "#{1}", c); c = false;',    attr: function(m) {      m[3] = (m[5] || m[6]);      return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;').evaluate(m);    },    pseudo: function(m) {      if (m[6]) m[6] = m[6].replace(/"/g, '\\"');      return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(m);    },    descendant:   'c = "descendant";',    child:        'c = "child";',    adjacent:     'c = "adjacent";',    laterSibling: 'c = "laterSibling";'  },  patterns: {    // combinators must be listed first    // (and descendant needs to be last combinator)    laterSibling: /^\s*~\s*/,    child:        /^\s*>\s*/,    adjacent:     /^\s*\+\s*/,    descendant:   /^\s/,    // selectors follow    tagName:      /^\s*(\*|[\w\-]+)(\b|$)?/,    id:           /^#([\w\-\*]+)(\b|$)/,    className:    /^\.([\w\-\*]+)(\b|$)/,    pseudo:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/,    attrPresence: /^\[((?:[\w]+:)?[\w]+)\]/,    attr:         /\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/  },  // for Selector.match and Element#match  assertions: {    tagName: function(element, matches) {      return matches[1].toUpperCase() == element.tagName.toUpperCase();    },    className: function(element, matches) {      return Element.hasClassName(element, matches[1]);    },    id: function(element, matches) {      return element.id === matches[1];    },    attrPresence: function(element, matches) {      return Element.hasAttribute(element, matches[1]);    },    attr: function(element, matches) {      var nodeValue = Element.readAttribute(element, matches[1]);      return nodeValue && Selector.operators[matches[2]](nodeValue, matches[5] || matches[6]);    }  },  handlers: {    // UTILITY FUNCTIONS    // joins two collections    concat: function(a, b) {      for (var i = 0, node; node = b[i]; i++)        a.push(node);      return a;    },    // marks an array of nodes for counting    mark: function(nodes) {      var _true = Prototype.emptyFunction;      for (var i = 0, node; node = nodes[i]; i++)        node._countedByPrototype = _true;      return nodes;    },    unmark: function(nodes) {      for (var i = 0, node; node = nodes[i]; i++)        node._countedByPrototype = undefined;      return nodes;    },    // mark each child node with its position (for nth calls)    // "ofType" flag indicates whether we're indexing for nth-of-type    // rather than nth-child    index: function(parentNode, reverse, ofType) {      parentNode._countedByPrototype = Prototype.emptyFunction;      if (reverse) {        for (var nodes = parentNode.childNodes, i = nodes.length - 1, j = 1; i >= 0; i--) {          var node = nodes[i];          if (node.nodeType == 1 && (!ofType || node._countedByPrototype)) node.nodeIndex = j++;        }      } else {        for (var i = 0, j = 1, nodes = parentNode.childNodes; node = nodes[i]; i++)          if (node.nodeType == 1 && (!ofType || node._countedByPrototype)) node.nodeIndex = j++;      }    },    // filters out duplicates and extends all nodes    unique: function(nodes) {      if (nodes.length == 0) return nodes;      var results = [], n;      for (var i = 0, l = nodes.length; i < l; i++)        if (!(n = nodes[i])._countedByPrototype) {          n._countedByPrototype = Prototype.emptyFunction;          results.push(Element.extend(n));        }      return Selector.handlers.unmark(results);    },    // COMBINATOR FUNCTIONS    descendant: function(nodes) {      var h = Selector.handlers;      for (var i = 0, results = [], node; node = nodes[i]; i++)        h.concat(results, node.getElementsByTagName('*'));      return results;    },    child: function(nodes) {      var h = Selector.handlers;      for (var i = 0, results = [], node; node = nodes[i]; i++) {        for (var j = 0, child; child = node.childNodes[j]; j++)          if (child.nodeType == 1 && child.tagName != '!') results.push(child);      }      return results;    },    adjacent: function(nodes) {      for (var i = 0, results = [], node; node = nodes[i]; i++) {        var next = this.nextElementSibling(node);        if (next) results.push(next);      }      return results;    },    laterSibling: function(nodes) {      var h = Selector.handlers;      for (var i = 0, results = [], node; node = nodes[i]; i++)        h.concat(results, Element.nextSiblings(node));      return results;    },    nextElementSibling: function(node) {      while (node = node.nextSibling)        if (node.nodeType == 1) return node;      return null;    },    previousElementSibling: function(node) {      while (node = node.previousSibling)        if (node.nodeType == 1) return node;      return null;    },    // TOKEN FUNCTIONS    tagName: function(nodes, root, tagName, combinator) {      var uTagName = tagName.toUpperCase();      var results = [], h = Selector.handlers;      if (nodes) {        if (combinator) {          // fastlane for ordinary descendant combinators          if (combinator == "descendant") {            for (var i = 0, node; node = nodes[i]; i++)              h.concat(results, node.getElementsByTagName(tagName));            return results;          } else nodes = this[combinator](nodes);          if (tagName == "*") return nodes;        }        for (var i = 0, node; node = nodes[i]; i++)          if (node.tagName.toUpperCase() === uTagName) results.push(node);        return results;      } else return root.getElementsByTagName(tagName);    },    id: function(nodes, root, id, combinator) {      var targetNode = $(id), h = Selector.handlers;      if (!targetNode) return [];      if (!nodes && root == document) return [targetNode];      if (nodes) {        if (combinator) {          if (combinator == 'child') {            for (var i = 0, node; node = nodes[i]; i++)              if (targetNode.parentNode == node) return [targetNode];          } else if (combinator == 'descendant') {            for (var i = 0, node; node = nodes[i]; i++)              if (Element.descendantOf(targetNode, node)) return [targetNode];          } else if (combinator == 'adjacent') {            for (var i = 0, node; node = nodes[i]; i++)              if (Selector.handlers.previousElementSibling(targetNode) == node)                return [targetNode];          } else nodes = h[combinator](nodes);        }        for (var i = 0, node; node = nodes[i]; i++)          if (node == targetNode) return [targetNode];        return [];      }      return (targetNode && Element.descendantOf(targetNode, root)) ? [targetNode] : [];    },    className: function(nodes, root, className, combinator) {      if (nodes && combinator) nodes = this[combinator](nodes);      return Selector.handlers.byClassName(nodes, root, className);    },    byClassName: function(nodes, root, className) {      if (!nodes) nodes = Selector.handlers.descendant([root]);      var needle = ' ' + className + ' ';      for (var i = 0, results = [], node, nodeClassName; node = nodes[i]; i++) {        nodeClassName = node.className;        if (nodeClassName.length == 0) continue;        if (nodeClassName == className || (' ' + nodeClassName + ' ').include(needle))          results.push(node);      }      return results;    },    attrPresence: function(nodes, root, attr, combinator) {      if (!nodes) nodes = root.getElementsByTagName("*");      if (nodes && combinator) nodes = this[combinator](nodes);      var results = [];      for (var i = 0, node; node = nodes[i]; i++)        if (Element.hasAttribute(node, attr)) results.push(node);      return results;    },    attr: function(nodes, root, attr, value, operator, combinator) {      if (!nodes) nodes = root.getElementsByTagName("*");      if (nodes && combinator) nodes = this[combinator](nodes);      var handler = Selector.operators[operator], results = [];      for (var i = 0, node; node = nodes[i]; i++) {        var nodeValue = Element.readAttribute(node, attr);        if (nodeValue === null) continue;        if (handler(nodeValue, value)) results.push(node);      }      return results;    },    pseudo: function(nodes, name, value, root, combinator) {      if (nodes && combinator) nodes = this[combinator](nodes);      if (!nodes) nodes = root.getElementsByTagName("*");      return Selector.pseudos[name](nodes, value, root);    }  },  pseudos: {    'first-child': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++) {        if (Selector.handlers.previousElementSibling(node)) continue;          results.push(node);      }      return results;    },    'last-child': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++) {        if (Selector.handlers.nextElementSibling(node)) continue;          results.push(node);      }      return results;    },    'only-child': function(nodes, value, root) {      var h = Selector.handlers;      for (var i = 0, results = [], node; node = nodes[i]; i++)        if (!h.previousElementSibling(node) && !h.nextElementSibling(node))          results.push(node);      return results;    },    'nth-child':        function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, formula, root);    },    'nth-last-child':   function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, formula, root, true);    },    'nth-of-type':      function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, formula, root, false, true);    },    'nth-last-of-type': function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, formula, root, true, true);    },    'first-of-type':    function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, "1", root, false, true);    },    'last-of-type':     function(nodes, formula, root) {      return Selector.pseudos.nth(nodes, "1", root, true, true);    },    'only-of-type':     function(nodes, formula, root) {      var p = Selector.pseudos;      return p['last-of-type'](p['first-of-type'](nodes, formula, root), formula, root);    },    // handles the an+b logic    getIndices: function(a, b, total) {      if (a == 0) return b > 0 ? [b] : [];      return $R(1, total).inject([], function(memo, i) {        if (0 == (i - b) % a && (i - b) / a >= 0) memo.push(i);        return memo;      });    },    // handles nth(-last)-child, nth(-last)-of-type, and (first|last)-of-type    nth: function(nodes, formula, root, reverse, ofType) {      if (nodes.length == 0) return [];      if (formula == 'even') formula = '2n+0';      if (formula == 'odd')  formula = '2n+1';      var h = Selector.handlers, results = [], indexed = [], m;      h.mark(nodes);      for (var i = 0, node; node = nodes[i]; i++) {        if (!node.parentNode._countedByPrototype) {          h.index(node.parentNode, reverse, ofType);          indexed.push(node.parentNode);        }      }      if (formula.match(/^\d+$/)) { // just a number        formula = Number(formula);        for (var i = 0, node; node = nodes[i]; i++)          if (node.nodeIndex == formula) results.push(node);      } else if (m = formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // an+b        if (m[1] == "-") m[1] = -1;        var a = m[1] ? Number(m[1]) : 1;        var b = m[2] ? Number(m[2]) : 0;        var indices = Selector.pseudos.getIndices(a, b, nodes.length);        for (var i = 0, node, l = indices.length; node = nodes[i]; i++) {          for (var j = 0; j < l; j++)            if (node.nodeIndex == indices[j]) results.push(node);        }      }      h.unmark(nodes);      h.unmark(indexed);      return results;    },    'empty': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++) {        // IE treats comments as element nodes        if (node.tagName == '!' || node.firstChild) continue;        results.push(node);      }      return results;    },    'not': function(nodes, selector, root) {      var h = Selector.handlers, selectorType, m;      var exclusions = new Selector(selector).findElements(root);      h.mark(exclusions);      for (var i = 0, results = [], node; node = nodes[i]; i++)        if (!node._countedByPrototype) results.push(node);      h.unmark(exclusions);      return results;    },    'enabled': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++)        if (!node.disabled && (!node.type || node.type !== 'hidden'))          results.push(node);      return results;    },    'disabled': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++)        if (node.disabled) results.push(node);      return results;    },    'checked': function(nodes, value, root) {      for (var i = 0, results = [], node; node = nodes[i]; i++)        if (node.checked) results.push(node);      return results;    }  },  operators: {    '=':  function(nv, v) { return nv == v; },    '!=': function(nv, v) { return nv != v; },    '^=': function(nv, v) { return nv == v || nv && nv.startsWith(v); },    '$=': function(nv, v) { return nv == v || nv && nv.endsWith(v); },    '*=': function(nv, v) { return nv == v || nv && nv.include(v); },    '$=': function(nv, v) { return nv.endsWith(v); },    '*=': function(nv, v) { return nv.include(v); },    '~=': function(nv, v) { return (' ' + nv + ' ').include(' ' + v + ' '); },    '|=': function(nv, v) { return ('-' + (nv || "").toUpperCase() +     '-').include('-' + (v || "").toUpperCase() + '-'); }  },  split: function(expression) {    var expressions = [];    expression.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/, function(m) {      expressions.push(m[1].strip());    });    return expressions;  },  matchElements: function(elements, expression) {    var matches = $$(expression), h = Selector.handlers;    h.mark(matches);    for (var i = 0, results = [], element; element = elements[i]; i++)      if (element._countedByPrototype) results.push(element);    h.unmark(matches);    return results;  },  findElement: function(elements, expression, index) {    if (Object.isNumber(expression)) {      index = expression; expression = false;    }    return Selector.matchElements(elements, expression || '*')[index || 0];  },  findChildElements: function(element, expressions) {    expressions = Selector.split(expressions.join(','));    var results = [], h = Selector.handlers;    for (var i = 0, l = expressions.length, selector; i < l; i++) {      selector = new Selector(expressions[i].strip());      h.concat(results, selector.findElements(element));    }    return (l > 1) ? h.unique(results) : results;  }});if (Prototype.Browser.IE) {  Object.extend(Selector.handlers, {    // IE returns comment nodes on getElementsByTagName("*").    // Filter them out.    concat: function(a, b) {      for (var i = 0, node; node = b[i]; i++)        if (node.tagName !== "!") a.push(node);      return a;    },    // IE improperly serializes _countedByPrototype in (inner|outer)HTML.    unmark: function(nodes) {      for (var i = 0, node; node = nodes[i]; i++)        node.removeAttribute('_countedByPrototype');      return nodes;    }  });}function $$() {  return Selector.findChildElements(document, $A(arguments));}var Form = {  reset: function(form) {    $(form).reset();    return form;  },  serializeElements: function(elements, options) {    if (typeof options != 'object') options = { hash: !!options };    else if (Object.isUndefined(options.hash)) options.hash = true;    var key, value, submitted = false, submit = options.submit;    var data = elements.inject({ }, function(result, element) {      if (!element.disabled && element.name) {        key = element.name; value = $(element).getValue();        if (value != null && element.type != 'file' && (element.type != 'submit' || (!submitted &&            submit !== false && (!submit || key == submit) && (submitted = true)))) {          if (key in result) {            // a key is already present; construct an array of values            if (!Object.isArray(result[key])) result[key] = [result[key]];            result[key].push(value);          }          else result[key] = value;        }      }      return result;    });    return options.hash ? data : Object.toQueryString(data);  }};Form.Methods = {  serialize: function(form, options) {    return Form.serializeElements(Form.getElements(form), options);  },  getElements: function(form) {    return $A($(form).getElementsByTagName('*')).inject([],      function(elements, child) {        if (Form.Element.Serializers[child.tagName.toLowerCase()])          elements.push(Element.extend(child));        return elements;      }    );  },  getInputs: function(form, typeName, name) {    form = $(form);    var inputs = form.getElementsByTagName('input');    if (!typeName && !name) return $A(inputs).map(Element.extend);    for (var i = 0, matchingInputs = [], length = inputs.length; i < length; i++) {      var input = inputs[i];      if ((typeName && input.type != typeName) || (name && input.name != name))        continue;      matchingInputs.push(Element.extend(input));    }    return matchingInputs;  },  disable: function(form) {    form = $(form);    Form.getElements(form).invoke('disable');    return form;  },  enable: function(form) {    form = $(form);    Form.getElements(form).invoke('enable');    return form;  },  findFirstElement: function(form) {    var elements = $(form).getElements().findAll(function(element) {      return 'hidden' != element.type && !element.disabled;    });    var firstByIndex = elements.findAll(function(element) {      return element.hasAttribute('tabIndex') && element.tabIndex >= 0;    }).sortBy(function(element) { return element.tabIndex }).first();    return firstByIndex ? firstByIndex : elements.find(function(element) {      return ['input', 'select', 'textarea'].include(element.tagName.toLowerCase());    });  },  focusFirstElement: function(form) {    form = $(form);    form.findFirstElement().activate();    return form;  },  request: function(form, options) {    form = $(form), options = Object.clone(options || { });    var params = options.parameters, action = form.readAttribute('action') || '';    if (action.blank()) action = window.location.href;    options.parameters = form.serialize(true);    if (params) {      if (Object.isString(params)) params = params.toQueryParams();      Object.extend(options.parameters, params);    }    if (form.hasAttribute('method') && !options.method)      options.method = form.method;    return new Ajax.Request(action, options);  }};/*--------------------------------------------------------------------------*/Form.Element = {  focus: function(element) {    $(element).focus();    return element;  },  select: function(element) {    $(element).select();    return element;  }};Form.Element.Methods = {  serialize: function(element) {    element = $(element);    if (!element.disabled && element.name) {      var value = element.getValue();      if (value != undefined) {        var pair = { };        pair[element.name] = value;        return Object.toQueryString(pair);      }    }    return '';  },  getValue: function(element) {    element = $(element);    var method = element.tagName.toLowerCase();    return Form.Element.Serializers[method](element);  },  setValue: function(element, value) {    element = $(element);    var method = element.tagName.toLowerCase();    Form.Element.Serializers[method](element, value);    return element;  },  clear: function(element) {    $(element).value = '';    return element;  },  present: function(element) {    return $(element).value != '';  },  activate: function(element) {    element = $(element);    try {      element.focus();      if (element.select && (element.tagName.toLowerCase() != 'input' ||          !['button', 'reset', 'submit'].include(element.type)))        element.select();    } catch (e) { }    return element;  },  disable: function(element) {    element = $(element);    element.disabled = true;    return element;  },  enable: function(element) {    element = $(element)</selectorent.disabled = false;    return element;  }};/*--------------------------------------------------------------------------*/var aField = Form.Element;var $F = Form.Element.Methods.getValue;/*--------------------------------------------------------------------------*/Form.Element.Serializers = {  input: function(element, value) {    switch (element.type.toLowerCase()) {      case 'checkbox':      case 'radio':        return Form.Element.Serializers.inputSelector(element, value);      default:        return Form.Element.Serializers.textarea(element, value);    }  },  inputSelector: function(element, value) {    if (Object.isUndefined(value)) return element.checked ? element.value : null;    else element.checked = !!value;  },  textarea: function(element, value) {    if (Object.isUndefined(value)) return element.value;    else element.value = value;  },  select: function(element, value) {    if (Object.isUndefined(value))      return this[element.type == 'select-one' ?        'selectOne' : 'selectMany'](element);    else {      var opt, currentValue, single = !Object.isArray(value);      for (var i = 0, length = element.length; i < length; i++) {        opt = element.options[i];        currentValue = this.optionValue(opt);        if (single) {          if (currentValue == value) {            opt.selected = true;            return;          }        }        else opt.selected = value.include(currentValue);      }    }  },  selectOne: function(element) {    var index = element.selectedIndex;    return index >= 0 ? this.optionValue(element.options[index]) : null;  },  selectMany: function(element) {    var values, length = element.length;    if (!length) return null;    for (var i = 0, values = []; i < length; i++) {      var opt = element.options[i];      if (opt.selected) values.push(this.optionValue(opt));    }    return values;  },  optionValue: function(opt) {    // extend element because hasAttribute may not be native    return Element.extend(opt).hasAttribute('value') ? opt.value : opt.text;  }};/*--------------------------------------------------------------------------*/Abstract.TimedObserver = Class.create(PeriodicalExecuter, {  initialize: function($super, element, frequency, callback) {    $super(callback, frequency);    this.element   = $(element);    this.lastValue = this.getValue();  },  execute: function() {    var value = this.getValue();    if (Object.isString(this.lastValue) && Object.isString(value) ?        this.lastValue != value : String(this.lastValue) != String(value)) {      this.callback(this.element, value);      this.lastValue = value;    }  }});Form.Element.Observer = Class.create(Abstract.TimedObserver, {  getValue: function() {    return Form.Element.getValue(this.element);  }});Form.Observer = Class.create(Abstract.TimedObserver, {  getValue: function() {    return Form.serialize(this.element);  }});/*--------------------------------------------------------------------------*/Abstract.EventObserver = Class.create({  initialize: function(element, callback) {    this.element  = $(element);    this.callback = callback;    this.lastValue = this.getValue();    if (this.element.tagName.toLowerCase() == 'form')      this.registerFormCallbacks();    else      this.registerCallback(this.element);  },  onElementEvent: function() {    var value = this.getValue();    if (this.lastValue != value) {      this.callback(this.element, value);      this.lastValue = value;    }  },  registerFormCallbacks: function() {    Form.getElements(this.element).each(this.registerCallback, this);  },  registerCallback: function(element) {    if (element.type) {      switch (element.type.toLowerCase()) {        case 'checkbox':        case 'radio':          Event.observe(element, 'click', this.onElementEvent.bind(this));          break;        default:          Event.observe(element, 'change', this.onElementEvent.bind(this));          break;      }    }  }});Form.Element.EventObserver = Class.create(Abstract.EventObserver, {  getValue: function() {    return Form.Element.getValue(this.element);  }});Form.EventObserver = Class.create(Abstract.EventObserver, {  getValue: function() {    return Form.serialize(this.element);  }});if (!window.Event) var Event = { };Object.extend(Event, {  KEY_BACKSPACE: 8,  KEY_TAB:       9,  KEY_RETURN:   13,  KEY_ESC:      27,  KEY_LEFT:     37,  KEY_UP:       38,  KEY_RIGHT:    39,  KEY_DOWN:     40,  KEY_DELETE:   46,  KEY_HOME:     36,  KEY_END:      35,  KEY_PAGEUP:   33,  KEY_PAGEDOWN: 34,  KEY_INSERT:   45,  cache: { },  relatedTarget: function(event) {    var element;    switch(event.type) {      case 'mouseover': element = event.fromElement; break;      case 'mouseout':  element = event.toElement;   break;      default: return null;    }    return Element.extend(element);  }});Event.Methods = (function() {  var isButton;  if (Prototype.Browser.IE) {    var buttonMap = { 0: 1, 1: 4, 2: 2 };    isButton = function(event, code) {      return event.button == buttonMap[code];    };  } else if (Prototype.Browser.WebKit) {    isButton = function(event, code) {      switch (code) {        case 0: return event.which == 1 && !event.metaKey;        case 1: return event.which == 1 && event.metaKey;        default: return false;      }    };  } else {    isButton = function(event, code) {      return event.which ? (event.which === code + 1) : (event.button === code);    };  }  return {    isLeftClick:   function(event) { return isButton(event, 0) },    isMiddleClick: function(event) { return isButton(event, 1) },    isRightClick:  function(event) { return isButton(event, 2) },    element: function(event) {      event = Event.extend(event);      var node          = event.target,          type          = event.type,          currentTarget = event.currentTarget;      if (currentTarget && currentTarget.tagName) {        // Firefox screws up the "click" event when moving between radio buttons        // via arrow keys. It also screws up the "load" and "error" events on images,        // reporting the document as the target instead of the original image.        if (type === 'load' || type === 'error' ||          (type === 'click' && currentTarget.tagName.toLowerCase() === 'input'            && currentTarget.type === 'radio'))              node = currentTarget;      }      if (node.nodeType == Node.TEXT_NODE) node = node.parentNode;      return Element.extend(node);    },    findElement: function(event, expression) {      var element = Event.element(event);      if (!expression) return element;      var elements = [element].concat(element.ancestors());      return Selector.findElement(elements, expression, 0);    },    pointer: function(event) {      var docElement = document.documentElement,      body = document.body || { scrollLeft: 0, scrollTop: 0 };      return {        x: event.pageX || (event.clientX +          (docElement.scrollLeft || body.scrollLeft) -          (docElement.clientLeft || 0)),        y: event.pageY || (event.clientY +          (docElement.scrollTop || body.scrollTop) -          (docElement.clientTop || 0))      };    },    pointerX: function(event) { return Event.pointer(event).x },    pointerY: function(event) { return Event.pointer(event).y },    stop: function(event) {      Event.extend(event);      event.preventDefault();      event.stopPropagation();      event.stopped = true;    }  };})();Event.extend = (function() {  var methods = Object.keys(Event.Methods).inject({ }, function(m, name) {    m[name] = Event.Methods[name].methodize();    return m;  });  if (Prototype.Browser.IE) {    Object.extend(methods, {      stopPropagation: function() { this.cancelBubble = true },      preventDefault:  function() { this.returnValue = false },      inspect: function() { return "[object Event]" }    });    return function(event) {      if (!event) return false;      if (event._extendedByPrototype) return event;      event._extendedByPrototype = Prototype.emptyFunction;      var pointer = Event.pointer(event);      Object.extend(event, {        target: event.srcElement,        relatedTarget: Event.relatedTarget(event),        pageX:  pointer.x,        pageY:  pointer.y      });      return Object.extend(event, methods);    };  } else {    Event.prototype = Event.prototype || document.createEvent("HTMLEvents")['__proto__'];    Object.extend(Event.prototype, methods);    return Prototype.K;  }})();Object.extend(Event, (function() {  var cache = Event.cache;  function getEventID(element) {    if (element._prototypeEventID) return element._prototypeEventID[0];    arguments.callee.id = arguments.callee.id || 1;    return element._prototypeEventID = [++arguments.callee.id];  }  function getDOMEventName(eventName) {    if (eventName && eventName.include(':')) return "dataavailable";    return eventName;  }  function getCacheForID(id) {    return cache[id] = cache[id] || { };  }  function getWrappersForEventName(id, eventName) {    var c = getCacheForID(id);    return c[eventName] = c[eventName] || [];  }  function createWrapper(element, eventName, handler) {    var id = getEventID(element);    var c = getWrappersForEventName(id, eventName);    if (c.pluck("handler").include(handler)) return false;    var wrapper = function(event) {      if (!Event || !Event.extend ||        (event.eventName && event.eventName != eventName))          return false;      Event.extend(event);      handler.call(element, event);    };    wrapper.handler = handler;    c.push(wrapper);    return wrapper;  }  function findWrapper(id, eventName, handler) {    var c = getWrappersForEventName(id, eventName);    return c.find(function(wrapper) { return wrapper.handler == handler });  }  function destroyWrapper(id, eventName, handler) {    var c = getCacheForID(id);    if (!c[eventName]) return false;    c[eventName] = c[eventName].without(findWrapper(id, eventName, handler));  }  function destroyCache() {    for (var id in cache)      for (var eventName in cache[id])        cache[id][eventName] = null;  }  // Internet Explorer needs to remove event handlers on page unload  // in order to avoid memory leaks.  if (window.attachEvent) {    window.attachEvent("onunload", destroyCache);  }  // Safari has a dummy event handler on page unload so that it won't  // use its bfcache. Safari <= 3.1 has an issue with restoring the "document"  // object when page is returned to via the back button using its bfcache.  if (Prototype.Browser.WebKit) {    window.addEventListener('unload', Prototype.emptyFunction, false);  }  return {    observe: function(element, eventName, handler) {      element = $(element);      var name = getDOMEventName(eventName);      var wrapper = createWrapper(element, eventName, handler);      if (!wrapper) return element;      if (element.addEventListener) {        element.addEventListener(name, wrapper, false);      } else {        element.attachEvent("on" + name, wrapper);      }      return element;    },    stopObserving: function(element, eventName, handler) {      element = $(element);      var id = getEventID(element), name = getDOMEventName(eventName);      if (!handler && eventName) {        getWrappersForEventName(id, eventName).each(function(wrapper) {          element.stopObserving(eventName, wrapper.handler);        });        return element;      } else if (!eventName) {        Object.keys(getCacheForID(id)).each(function(eventName) {          element.stopObserving(eventName);        });        return element;      }      var wrapper = findWrapper(id, eventName, handler);      if (!wrapper) return element;      if (element.removeEventListener) {        element.removeEventListener(name, wrapper, false);      } else {        element.detachEvent("on" + name, wrapper);      }      destroyWrapper(id, eventName, handler);      return element;    },    fire: function(element, eventName, memo) {      element = $(element);      if (element == document && document.createEvent && !element.dispatchEvent)        element = document.documentElement;      var event;      if (document.createEvent) {        event = document.createEvent("HTMLEvents");        event.initEvent("dataavailable", true, true);      } else {        event = document.createEventObject();        event.eventType = "ondataavailable";      }      event.eventName = eventName;      event.memo = memo || { };      if (document.createEvent) {        element.dispatchEvent(event);      } else {        element.fireEvent(event.eventType, event);      }      return Event.extend(event);    }  };})());Object.extend(Event, Event.Methods);Element.addMethods({  fire:          Event.fire,  observe:       Event.observe,  stopObserving: Event.stopObserving});Object.extend(document, {  fire:          Element.Methods.fire.methodize(),  observe:       Element.Methods.observe.methodize(),  stopObserving: Element.Methods.stopObserving.methodize(),  loaded:        false});(function() {  /* Support for the DOMContentLoaded event is based on work by Dan Webb,     Matthias Miller, Dean Edwards and John Resig. */  var timer;  function fireContentLoadedEvent() {    if (document.loaded) return;    if (timer) window.clearInterval(timer);    document.fire("dom:loaded");    document.loaded = true;  }  if (document.addEventListener) {    if (Prototype.Browser.WebKit) {      timer = window.setInterval(function() {        if (/loaded|complete/.test(document.readyState))          fireContentLoadedEvent();      }, 0);      Event.observe(window, "load", fireContentLoadedEvent);    } else {      document.addEventListener("DOMContentLoaded",        fireContentLoadedEvent, false);    }  } else {    document.write("<script id=__onDOMContentLoaded defer src=//:><\/script>");    $("__onDOMContentLoaded").onreadystatechange = function() {      if (this.readyState == "complete") {        this.onreadystatechange = null;        fireContentLoadedEvent();      }    };  }})();/*------------------------------- DEPRECATED -------------------------------*/Hash.toQueryString = Object.toQueryString;var Toggle = { display: Element.toggle };Element.Methods.childOf = Element.Methods.descendantOf;var Insertion = {  Before: function(element, content) {    return Element.insert(element, {before:content});  },  Top: function(element, content) {    return Element.insert(element, {top:content});  },  Bottom: function(element, content) {    return Element.insert(element, {bottom:content});  },  After: function(element, content) {    return Element.insert(element, {after:content});  }};var $continue = new Error('"throw $continue" is deprecated, use "return" instead');// This should be moved to script.aculo.us; notice the deprecated methods// further below, that map to the newer Element methods.var Position = {  // set to true if needed, warning: firefox performance problems  // NOT neeeded for page scrolling, only if draggable contained in  // scrollable elements  includeScrollOffsets: false,  // must be called before calling withinIncludingScrolloffset, every time the  // page is scrolled  prepare: function() {    this.deltaX =  window.pageXOffset                || document.documentElement.scrollLeft                || document.body.scrollLeft                || 0;    this.deltaY =  window.pageYOffset                || document.documentElement.scrollTop                || document.body.scrollTop                || 0;  },  // caches x/y coordinate pair to use with overlap  within: function(element, x, y) {    if (this.includeScrollOffsets)      return this.withinIncludingScrolloffsets(element, x, y);    this.xcomp = x;    this.ycomp = y;    this.offset = Element.cumulativeOffset(element);    return (y >= this.offset[1] &&            y <  this.offset[1] + element.offsetHeight &&            x >= this.offset[0] &&            x <  this.offset[0] + element.offsetWidth);  },  withinIncludingScrolloffsets: function(element, x, y) {    var offsetcache = Element.cumulativeScrollOffset(element);    this.xcomp = x + offsetcache[0] - this.deltaX;    this.ycomp = y + offsetcache[1] - this.deltaY;    this.offset = Element.cumulativeOffset(element);    return (this.ycomp >= this.offset[1] &&            this.ycomp <  this.offset[1] + element.offsetHeight &&            this.xcomp >= this.offset[0] &&            this.xcomp <  this.offset[0] + element.offsetWidth);  },  // within must be called directly before  overlap: function(mode, element) {    if (!mode) return 0;    if (mode == 'vertical')      return ((this.offset[1] + element.offsetHeight) - this.ycomp) /        element.offsetHeight;    if (mode == 'horizontal')      return ((this.offset[0] + element.offsetWidth) - this.xcomp) /        element.offsetWidth;  },  // Deprecation layer -- use newer Element methods now (1.5.2).  cumulativeOffset: Element.Methods.cumulativeOffset,  positionedOffset: Element.Methods.positionedOffset,  absolutize: function(element) {    Position.prepare();    return Element.absolutize(element);  },  relativize: function(element) {    Position.prepare();    return Element.relativize(element);  },  realOffset: Element.Methods.cumulativeScrollOffset,  offsetParent: Element.Methods.getOffsetParent,  page: Element.Methods.viewportOffset,  clone: function(source, target, options) {    options = options || { };    return Element.clonePosition(target, source, options);  }};/*--------------------------------------------------------------------------*/if (!document.getElementsByClassName) document.getElementsByClassName = function(instanceMethods){  function iter(name) {    return name.blank() ? null : "[contains(concat(' ', @class, ' '), ' " + name + " ')]";  }  instanceMethods.getElementsByClassName = Prototype.BrowserFeatures.XPath ?  function(element, className) {    className = className.toString().strip();    var cond = /\s/.test(className) ? $w(className).map(iter).join('') : iter(className);    return cond ? document._getElementsByXPath('.//*' + cond, element) : [];  } : function(element, className) {    className = className.toString().strip();    var elements = [], classNames = (/\s/.test(className) ? $w(className) : null);    if (!classNames && !className) return elements;    var nodes = $(element).getElementsByTagName('*');    className = ' ' + className + ' ';    for (var i = 0, child, cn; child = nodes[i]; i++) {      if (child.className && (cn = ' ' + child.className + ' ') && (cn.include(className) ||          (classNames && classNames.all(function(name) {            return !name.toString().blank() && cn.include(' ' + name + ' ');          }))))        elements.push(Element.extend(child));    }    return elements;  };  return function(className, parentElement) {    return $(parentElement || document.body).getElementsByClassName(className);  };}(Element.Methods);/*--------------------------------------------------------------------------*/Element.ClassNames = Class.create();Element.ClassNames.prototype = {  initialize: function(element) {    this.element = $(element);  },  _each: function(iterator) {    this.element.className.split(/\s+/).select(function(name) {      return name.length > 0;    })._each(iterator);  },  set: function(className) {    this.element.className = className;  },  add: function(classNameToAdd) {    if (this.include(classNameToAdd)) return;    this.set($A(this).concat(classNameToAdd).join(' '));  },  remove: function(classNameToRemove) {    if (!this.include(classNameToRemove)) return;    this.set($A(this).without(classNameToRemove).join(' '));  },  toString: function() {    return $A(this).join(' ');  }};Object.extend(Element.ClassNames.prototype, Enumerable);/*--------------------------------------------------------------------------*/Element.addMethods();//--></script>		<!--<script type="text/javascript" src="http://www.univ-nantes.fr/kosmos/agenda/js/scriptaculous/scriptaculous.js"></script>-->		<script type="text/javascript"  style="display:none"><!--// script.aculo.us effects.js v1.8.3, Thu Oct 08 11:23:33 +0200 2009// Copyright (c) 2005-2009 Thomas Fuchs (http://script.aculo.us, http://mir.aculo.us)// Contributors://  Justin Palmer (http://encytemedia.com/)//  Mark Pilgrim (http://diveintomark.org/)//  Martin Bialasinki//// script.aculo.us is freely distributable under the terms of an MIT-style license.// For details, see the script.aculo.us web site: http://script.aculo.us/// converts rgb() and #xxx to #xxxxxx format,// returns self (or first argument) if not convertableString.prototype.parseColor = function() {  var color = '#';  if (this.slice(0,4) == 'rgb(') {    var cols = this.slice(4,this.length-1).split(',');    var i=0; do { color += parseInt(cols[i]).toColorPart() } while (++i<3);  } else {    if (this.slice(0,1) == '#') {      if (this.length==4) for(var i=1;i<4;i++) color += (this.charAt(i) + this.charAt(i)).toLowerCase();      if (this.length==7) color = this.toLowerCase();    }  }  return (color.length==7 ? color : (arguments[0] || this));};/*--------------------------------------------------------------------------*/Element.collectTextNodes = function(element) {  return $A($(element).childNodes).collect( function(node) {    return (node.nodeType==3 ? node.nodeValue :      (node.hasChildNodes() ? Element.collectTextNodes(node) : ''));  }).flatten().join('');};Element.collectTextNodesIgnoreClass = function(element, className) {  return $A($(element).childNodes).collect( function(node) {    return (node.nodeType==3 ? node.nodeValue :      ((node.hasChildNodes() && !Element.hasClassName(node,className)) ?        Element.collectTextNodesIgnoreClass(node, className) : ''));  }).flatten().join('');};Element.setContentZoom = function(element, percent) {  element = $(element);  element.setStyle({fontSize: (percent/100) + 'em'});  if (Prototype.Browser.WebKit) window.scrollBy(0,0);  return element;};Element.getInlineOpacity = function(element){  return $(element).style.opacity || '';};Element.forceRerendering = function(element) {  try {    element = $(element);    var n = document.createTextNode(' ');    element.appendChild(n);    element.removeChild(n);  } catch(e) { }};/*--------------------------------------------------------------------------*/var Effect = {  _elementDoesNotExistError: {    name: 'ElementDoesNotExistError',    message: 'The specified DOM element does not exist, but is required for this effect to operate'  },  Transitions: {    linear: Prototype.K,    sinoidal: function(pos) {      return (-Math.cos(pos*Math.PI)/2) + .5;    },    reverse: function(pos) {      return 1-pos;    },    flicker: function(pos) {      var pos = ((-Math.cos(pos*Math.PI)/4) + .75) + Math.random()/4;      return pos > 1 ? 1 : pos;    },    wobble: function(pos) {      return (-Math.cos(pos*Math.PI*(9*pos))/2) + .5;    },    pulse: function(pos, pulses) {      return (-Math.cos((pos*((pulses||5)-.5)*2)*Math.PI)/2) + .5;    },    spring: function(pos) {      return 1 - (Math.cos(pos * 4.5 * Math.PI) * Math.exp(-pos * 6));    },    none: function(pos) {      return 0;    },    full: function(pos) {      return 1;    }  },  DefaultOptions: {    duration:   1.0,   // seconds    fps:        100,   // 100= assume 66fps max.    sync:       false, // true for combining    from:       0.0,    to:         1.0,    delay:      0.0,    queue:      'parallel'  },  tagifyText: function(element) {    var tagifyStyle = 'position:relative';    if (Prototype.Browser.IE) tagifyStyle += ';zoom:1';    element = $(element);    $A(element.childNodes).each( function(child) {      if (child.nodeType==3) {        child.nodeValue.toArray().each( function(character) {          element.insertBefore(            new Element('span', {style: tagifyStyle}).update(              character == ' ' ? String.fromCharCode(160) : character),              child);        });        Element.remove(child);      }    });  },  multiple: function(element, effect) {    var elements;    if (((typeof element == 'object') ||        Object.isFunction(element)) &&       (element.length))      elements = element;    else      elements = $(element).childNodes;    var options = Object.extend({      speed: 0.1,      delay: 0.0    }, arguments[2] || { });    var masterDelay = options.delay;    $A(elements).each( function(element, index) {      new effect(element, Object.extend(options, { delay: index * options.speed + masterDelay }));    });  },  PAIRS: {    'slide':  ['SlideDown','SlideUp'],    'blind':  ['BlindDown','BlindUp'],    'appear': ['Appear','Fade']  },  toggle: function(element, effect, options) {    element = $(element);    effect  = (effect || 'appear').toLowerCase();        return Effect[ Effect.PAIRS[ effect ][ element.visible() ? 1 : 0 ] ](element, Object.extend({      queue: { position:'end', scope:(element.id || 'global'), limit: 1 }    }, options || {}));  }};Effect.DefaultOptions.transition = Effect.Transitions.sinoidal;/* ------------- core effects ------------- */Effect.ScopedQueue = Class.create(Enumerable, {  initialize: function() {    this.effects  = [];    this.interval = null;  },  _each: function(iterator) {    this.effects._each(iterator);  },  add: function(effect) {    var timestamp = new Date().getTime();    var position = Object.isString(effect.options.queue) ?      effect.options.queue : effect.options.queue.position;    switch(position) {      case 'front':        // move unstarted effects after this effect        this.effects.findAll(function(e){ return e.state=='idle' }).each( function(e) {            e.startOn  += effect.finishOn;            e.finishOn += effect.finishOn;          });        break;      case 'with-last':        timestamp = this.effects.pluck('startOn').max() || timestamp;        break;      case 'end':        // start effect after last queued effect has finished        timestamp = this.effects.pluck('finishOn').max() || timestamp;        break;    }    effect.startOn  += timestamp;    effect.finishOn += timestamp;    if (!effect.options.queue.limit || (this.effects.length < effect.options.queue.limit))      this.effects.push(effect);    if (!this.interval)      this.interval = setInterval(this.loop.bind(this), 15);  },  remove: function(effect) {    this.effects = this.effects.reject(function(e) { return e==effect });    if (this.effects.length == 0) {      clearInterval(this.interval);      this.interval = null;    }  },  loop: function() {    var timePos = new Date().getTime();    for(var i=0, len=this.effects.length;i<len;i++)      this.effects[i] && this.effects[i].loop(timePos);  }});Effect.Queues = {  instances: $H(),  get: function(queueName) {    if (!Object.isString(queueName)) return queueName;    return this.instances.get(queueName) ||      this.instances.set(queueName, new Effect.ScopedQueue());  }};Effect.Queue = Effect.Queues.get('global');Effect.Base = Class.create({  position: null,  start: function(options) {    if (options && options.transition === false) options.transition = Effect.Transitions.linear;    this.options      = Object.extend(Object.extend({ },Effect.DefaultOptions), options || { });    this.currentFrame = 0;    this.state        = 'idle';    this.startOn      = this.options.delay*1000;    this.finishOn     = this.startOn+(this.options.duration*1000);    this.fromToDelta  = this.options.to-this.options.from;    this.totalTime    = this.finishOn-this.startOn;    this.totalFrames  = this.options.fps*this.options.duration;    this.render = (function() {      function dispatch(effect, eventName) {        if (effect.options[eventName + 'Internal'])          effect.options[eventName + 'Internal'](effect);        if (effect.options[eventName])          effect.options[eventName](effect);      }      return function(pos) {        if (this.state === "idle") {          this.state = "running";          dispatch(this, 'beforeSetup');          if (this.setup) this.setup();          dispatch(this, 'afterSetup');        }        if (this.state === "running") {          pos = (this.options.transition(pos) * this.fromToDelta) + this.options.from;          this.position = pos;          dispatch(this, 'beforeUpdate');          if (this.update) this.update(pos);          dispatch(this, 'afterUpdate');        }      };    })();    this.event('beforeStart');    if (!this.options.sync)      Effect.Queues.get(Object.isString(this.options.queue) ?        'global' : this.options.queue.scope).add(this);  },  loop: function(timePos) {    if (timePos >= this.startOn) {      if (timePos >= this.finishOn) {        this.render(1.0);        this.cancel();        this.event('beforeFinish');        if (this.finish) this.finish();        this.event('afterFinish');        return;      }      var pos   = (timePos - this.startOn) / this.totalTime,          frame = (pos * this.totalFrames).round();      if (frame > this.currentFrame) {        this.render(pos);        this.currentFrame = frame;      }    }  },  cancel: function() {    if (!this.options.sync)      Effect.Queues.get(Object.isString(this.options.queue) ?        'global' : this.options.queue.scope).remove(this);    this.state = 'finished';  },  event: function(eventName) {    if (this.options[eventName + 'Internal']) this.options[eventName + 'Internal'](this);    if (this.options[eventName]) this.options[eventName](this);  },  inspect: function() {    var data = $H();    for(property in this)      if (!Object.isFunction(this[property])) data.set(property, this[property]);    return '#<Effect:' + data.inspect() + ',options:' + $H(this.options).inspect() + '>';  }});Effect.Parallel = Class.create(Effect.Base, {  initialize: function(effects) {    this.effects = effects || [];    this.start(arguments[1]);  },  update: function(position) {    this.effects.invoke('render', position);  },  finish: function(position) {    this.effects.each( function(effect) {      effect.render(1.0);      effect.cancel();      effect.event('beforeFinish');      if (effect.finish) effect.finish(position);      effect.event('afterFinish');    });  }});Effect.Tween = Class.create(Effect.Base, {  initialize: function(object, from, to) {    object = Object.isString(object) ? $(object) : object;    var args = $A(arguments), method = args.last(),      options = args.length == 5 ? args[3] : null;    this.method = Object.isFunction(method) ? method.bind(object) :      Object.isFunction(object[method]) ? object[method].bind(object) :      function(value) { object[method] = value };    this.start(Object.extend({ from: from, to: to }, options || { }));  },  update: function(position) {    this.method(position);  }});Effect.Event = Class.create(Effect.Base, {  initialize: function() {    this.start(Object.extend({ duration: 0 }, arguments[0] || { }));  },  update: Prototype.emptyFunction});Effect.Opacity = Class.create(Effect.Base, {  initialize: function(element) {    this.element = $(element);    if (!this.element) throw(Effect._elementDoesNotExistError);    // make this work on IE on elements without 'layout'    if (Prototype.Browser.IE && (!this.element.currentStyle.hasLayout))      this.element.setStyle({zoom: 1});    var options = Object.extend({      from: this.element.getOpacity() || 0.0,      to:   1.0    }, arguments[1] || { });    this.start(options);  },  update: function(position) {    this.element.setOpacity(position);  }});Effect.Move = Class.create(Effect.Base, {  initialize: function(element) {    this.element = $(element);    if (!this.element) throw(Effect._elementDoesNotExistError);    var options = Object.extend({      x:    0,      y:    0,      mode: 'relative'    }, arguments[1] || { });    this.start(options);  },  setup: function() {    this.element.makePositioned();    this.originalLeft = parseFloat(this.element.getStyle('left') || '0');    this.originalTop  = parseFloat(this.element.getStyle('top')  || '0');    if (this.optio</effect== 'absolute') {      this.options.x = this.options.x - this.originalLeft;      this.options.y = this.options.y - this.originalTop;    }  },  update: function(position) {    this.element.setStyle({      left: (this.options.x  * position + this.originalLeft).round() + 'px',      top:  (this.options.y  * position + this.originalTop).round()  + 'px'    });  }});// for backwards compatibilityEffect.MoveBy = function(element, toTop, toLeft) {  return new Effect.Move(element,    Object.extend({ x: toLeft, y: toTop }, arguments[3] || { }));};Effect.Scale = Class.create(Effect.Base, {  initialize: function(element, percent) {    this.element = $(element);    if (!this.element) throw(Effect._elementDoesNotExistError);    var options = Object.extend({      scaleX: true,      scaleY: true,      scaleContent: true,      scaleFromCenter: false,      scaleMode: 'box',        // 'box' or 'contents' or { } with provided values      scaleFrom: 100.0,      scaleTo:   percent    }, arguments[2] || { });    this.start(options);  },  setup: function() {    this.restoreAfterFinish = this.options.restoreAfterFinish || false;    this.elementPositioning = this.element.getStyle('position');    this.originalStyle = { };    ['top','left','width','height','fontSize'].each( function(k) {      this.originalStyle[k] = this.element.style[k];    }.bind(this));    this.originalTop  = this.element.offsetTop;    this.originalLeft = this.element.offsetLeft;    var fontSize = this.element.getStyle('font-size') || '100%';    ['em','px','%','pt'].each( function(fontSizeType) {      if (fontSize.indexOf(fontSizeType)>0) {        this.fontSize     = parseFloat(fontSize);        this.fontSizeType = fontSizeType;      }    }.bind(this));    this.factor = (this.options.scaleTo - this.options.scaleFrom)/100;    this.dims = null;    if (this.options.scaleMode=='box')      this.dims = [this.element.offsetHeight, this.element.offsetWidth];    if (/^content/.test(this.options.scaleMode))      this.dims = [this.element.scrollHeight, this.element.scrollWidth];    if (!this.dims)      this.dims = [this.options.scaleMode.originalHeight,                   this.options.scaleMode.originalWidth];  },  update: function(position) {    var currentScale = (this.options.scaleFrom/100.0) + (this.factor * position);    if (this.options.scaleContent && this.fontSize)      this.element.setStyle({fontSize: this.fontSize * currentScale + this.fontSizeType });    this.setDimensions(this.dims[0] * currentScale, this.dims[1] * currentScale);  },  finish: function(position) {    if (this.restoreAfterFinish) this.element.setStyle(this.originalStyle);  },  setDimensions: function(height, width) {    var d = { };    if (this.options.scaleX) d.width = width.round() + 'px';    if (this.options.scaleY) d.height = height.round() + 'px';    if (this.options.scaleFromCenter) {      var topd  = (height - this.dims[0])/2;      var leftd = (width  - this.dims[1])/2;      if (this.elementPositioning == 'absolute') {        if (this.options.scaleY) d.top = this.originalTop-topd + 'px';        if (this.options.scaleX) d.left = this.originalLeft-leftd + 'px';      } else {        if (this.options.scaleY) d.top = -topd + 'px';        if (this.options.scaleX) d.left = -leftd + 'px';      }    }    this.element.setStyle(d);  }});Effect.Highlight = Class.create(Effect.Base, {  initialize: function(element) {    this.element = $(element);    if (!this.element) throw(Effect._elementDoesNotExistError);    var options = Object.extend({ startcolor: '#ffff99' }, arguments[1] || { });    this.start(options);  },  setup: function() {    // Prevent executing on elements not in the layout flow    if (this.element.getStyle('display')=='none') { this.cancel(); return; }    // Disable background image during the effect    this.oldStyle = { };    if (!this.options.keepBackgroundImage) {      this.oldStyle.backgroundImage = this.element.getStyle('background-image');      this.element.setStyle({backgroundImage: 'none'});    }    if (!this.options.endcolor)      this.options.endcolor = this.element.getStyle('background-color').parseColor('#ffffff');    if (!this.options.restorecolor)      this.options.restorecolor = this.element.getStyle('background-color');    // init color calculations    this._base  = $R(0,2).map(function(i){ return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16) }.bind(this));    this._delta = $R(0,2).map(function(i){ return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i] }.bind(this));  },  update: function(position) {    this.element.setStyle({backgroundColor: $R(0,2).inject('#',function(m,v,i){      return m+((this._base[i]+(this._delta[i]*position)).round().toColorPart()); }.bind(this)) });  },  finish: function() {    this.element.setStyle(Object.extend(this.oldStyle, {      backgroundColor: this.options.restorecolor    }));  }});Effect.ScrollTo = function(element) {  var options = arguments[1] || { },  scrollOffsets = document.viewport.getScrollOffsets(),  elementOffsets = $(element).cumulativeOffset();  if (options.offset) elementOffsets[1] += options.offset;  return new Effect.Tween(null,    scrollOffsets.top,    elementOffsets[1],    options,    function(p){ scrollTo(scrollOffsets.left, p.round()); }  );};/* ------------- combination effects ------------- */Effect.Fade = function(element) {  element = $(element);  var oldOpacity = element.getInlineOpacity();  var options = Object.extend({    from: element.getOpacity() || 1.0,    to:   0.0,    afterFinishInternal: function(effect) {      if (effect.options.to!=0) return;      effect.element.hide().setStyle({opacity: oldOpacity});    }  }, arguments[1] || { });  return new Effect.Opacity(element,options);};Effect.Appear = function(element) {  element = $(element);  var options = Object.extend({  from: (element.getStyle('display') == 'none' ? 0.0 : element.getOpacity() || 0.0),  to:   1.0,  // force Safari to render floated elements properly  afterFinishInternal: function(effect) {    effect.element.forceRerendering();  },  beforeSetup: function(effect) {    effect.element.setOpacity(effect.options.from).show();  }}, arguments[1] || { });  return new Effect.Opacity(element,options);};Effect.Puff = function(element) {  element = $(element);  var oldStyle = {    opacity: element.getInlineOpacity(),    position: element.getStyle('position'),    top:  element.style.top,    left: element.style.left,    width: element.style.width,    height: element.style.height  };  return new Effect.Parallel(   [ new Effect.Scale(element, 200,      { sync: true, scaleFromCenter: true, scaleContent: true, restoreAfterFinish: true }),     new Effect.Opacity(element, { sync: true, to: 0.0 } ) ],     Object.extend({ duration: 1.0,      beforeSetupInternal: function(effect) {        Position.absolutize(effect.effects[0].element);      },      afterFinishInternal: function(effect) {         effect.effects[0].element.hide().setStyle(oldStyle); }     }, arguments[1] || { })   );};Effect.BlindUp = function(element) {  element = $(element);  element.makeClipping();  return new Effect.Scale(element, 0,    Object.extend({ scaleContent: false,      scaleX: false,      restoreAfterFinish: true,      afterFinishInternal: function(effect) {        effect.element.hide().undoClipping();      }    }, arguments[1] || { })  );};Effect.BlindDown = function(element) {  element = $(element);  var elementDimensions = element.getDimensions();  return new Effect.Scale(element, 100, Object.extend({    scaleContent: false,    scaleX: false,    scaleFrom: 0,    scaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},    restoreAfterFinish: true,    afterSetup: function(effect) {      effect.element.makeClipping().setStyle({height: '0px'}).show();    },    afterFinishInternal: function(effect) {      effect.element.undoClipping();    }  }, arguments[1] || { }));};Effect.SwitchOff = function(element) {  element = $(element);  var oldOpacity = element.getInlineOpacity();  return new Effect.Appear(element, Object.extend({    duration: 0.4,    from: 0,    transition: Effect.Transitions.flicker,    afterFinishInternal: function(effect) {      new Effect.Scale(effect.element, 1, {        duration: 0.3, scaleFromCenter: true,        scaleX: false, scaleContent: false, restoreAfterFinish: true,        beforeSetup: function(effect) {          effect.element.makePositioned().makeClipping();        },        afterFinishInternal: function(effect) {          effect.element.hide().undoClipping().undoPositioned().setStyle({opacity: oldOpacity});        }      });    }  }, arguments[1] || { }));};Effect.DropOut = function(element) {  element = $(element);  var oldStyle = {    top: element.getStyle('top'),    left: element.getStyle('left'),    opacity: element.getInlineOpacity() };  return new Effect.Parallel(    [ new Effect.Move(element, {x: 0, y: 100, sync: true }),      new Effect.Opacity(element, { sync: true, to: 0.0 }) ],    Object.extend(      { duration: 0.5,        beforeSetup: function(effect) {          effect.effects[0].element.makePositioned();        },        afterFinishInternal: function(effect) {          effect.effects[0].element.hide().undoPositioned().setStyle(oldStyle);        }      }, arguments[1] || { }));};Effect.Shake = function(element) {  element = $(element);  var options = Object.extend({    distance: 20,    duration: 0.5  }, arguments[1] || {});  var distance = parseFloat(options.distance);  var split = parseFloat(options.duration) / 10.0;  var oldStyle = {    top: element.getStyle('top'),    left: element.getStyle('left') };    return new Effect.Move(element,      { x:  distance, y: 0, duration: split, afterFinishInternal: function(effect) {    new Effect.Move(effect.element,      { x: -distance*2, y: 0, duration: split*2,  afterFinishInternal: function(effect) {    new Effect.Move(effect.element,      { x:  distance*2, y: 0, duration: split*2,  afterFinishInternal: function(effect) {    new Effect.Move(effect.element,      { x: -distance*2, y: 0, duration: split*2,  afterFinishInternal: function(effect) {    new Effect.Move(effect.element,      { x:  distance*2, y: 0, duration: split*2,  afterFinishInternal: function(effect) {    new Effect.Move(effect.element,      { x: -distance, y: 0, duration: split, afterFinishInternal: function(effect) {        effect.element.undoPositioned().setStyle(oldStyle);  }}); }}); }}); }}); }}); }});};Effect.SlideDown = function(element) {	  element = $(element).cleanWhitespace();  // SlideDown need to have the content of the element wrapped in a container element with fixed height!  var oldInnerBottom = element.down().getStyle('bottom');  var elementDimensions = element.getDimensions();  return new Effect.Scale(element, 100, Object.extend({    scaleContent: false,    scaleX: false,    scaleFrom: window.opera ? 0 : 1,    scaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},    restoreAfterFinish: true,    afterSetup: function(effect) {      effect.element.makePositioned();      effect.element.down().makePositioned();      if (window.opera) effect.element.setStyle({top: ''});      effect.element.makeClipping().setStyle({height: '37px'}).show();    },    afterUpdateInternal: function(effect) {      effect.element.down().setStyle({bottom:        (effect.dims[0] - effect.element.clientHeight) + 'px' });    },    afterFinishInternal: function(effect) {      effect.element.undoClipping().undoPositioned();      effect.element.down().undoPositioned().setStyle({bottom: oldInnerBottom}); }    }, arguments[1] || { })  );};Effect.SlideUp = function(element) {  element = $(element).cleanWhitespace();  var oldInnerBottom = element.down().getStyle('bottom');  var elementDimensions = element.getDimensions();  return new Effect.Scale(element, window.opera ? 0 : 1,   Object.extend({ scaleContent: false,    scaleX: false,    scaleMode: 'box',    scaleFrom: 100,    scaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},    restoreAfterFinish: true,    afterSetup: function(effect) {      effect.element.makePositioned();      effect.element.down().makePositioned();      if (window.opera) effect.element.setStyle({top: ''});      effect.element.makeClipping().show();    },    afterUpdateInternal: function(effect) {      effect.element.down().setStyle({bottom:        (effect.dims[0] - effect.element.clientHeight) + 'px' });    },    afterFinishInternal: function(effect) {      effect.element.hide().undoClipping().undoPositioned();      effect.element.down().undoPositioned().setStyle({bottom: oldInnerBottom});    }   }, arguments[1] || { })  );};// Bug in opera makes the TD containing this element expand for a instance after finishEffect.Squish = function(element) {  return new Effect.Scale(element, window.opera ? 1 : 0, {    restoreAfterFinish: true,    beforeSetup: function(effect) {      effect.element.makeClipping();    },    afterFinishInternal: function(effect) {      effect.element.hide().undoClipping();    }  });};Effect.Grow = function(element) {  element = $(element);  var options = Object.extend({    direction: 'center',    moveTransition: Effect.Transitions.sinoidal,    scaleTransition: Effect.Transitions.sinoidal,    opacityTransition: Effect.Transitions.full  }, arguments[1] || { });  var oldStyle = {    top: element.style.top,    left: element.style.left,    height: element.style.height,    width: element.style.width,    opacity: element.getInlineOpacity() };  var dims = element.getDimensions();  var initialMoveX, initialMoveY;  var moveX, moveY;  switch (options.direction) {    case 'top-left':      initialMoveX = initialMoveY = moveX = moveY = 0;      break;    case 'top-right':      initialMoveX = dims.width;      initialMoveY = moveY = 0;      moveX = -dims.width;      break;    case 'bottom-left':      initialMoveX = moveX = 0;      initialMoveY = dims.height;      moveY = -dims.height;      break;    case 'bottom-right':      initialMoveX = dims.width;      initialMoveY = dims.height;      moveX = -dims.width;      moveY = -dims.height;      break;    case 'center':      initialMoveX = dims.width / 2;      initialMoveY = dims.height / 2;      moveX = -dims.width / 2;      moveY = -dims.height / 2;      break;  }  return new Effect.Move(element, {    x: initialMoveX,    y: initialMoveY,    duration: 0.01,    beforeSetup: function(effect) {      effect.element.hide().makeClipping().makePositioned();    },    afterFinishInternal: function(effect) {      new Effect.Parallel(        [ new Effect.Opacity(effect.element, { sync: true, to: 1.0, from: 0.0, transition: options.opacityTransition }),          new Effect.Move(effect.element, { x: moveX, y: moveY, sync: true, transition: options.moveTransition }),          new Effect.Scale(effect.element, 100, {            scaleMode: { originalHeight: dims.height, originalWidth: dims.width },            sync: true, scaleFrom: window.opera ? 1 : 0, transition: options.scaleTransition, restoreAfterFinish: true})        ], Object.extend({             beforeSetup: function(effect) {               effect.effects[0].element.setStyle({height: '0px'}).show();             },             afterFinishInternal: function(effect) {               effect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle);             }           }, options)      );    }  });};Effect.Shrink = function(element) {  element = $(element);  var options = Object.extend({    direction: 'center',    moveTransition: Effect.Transitions.sinoidal,    scaleTransition: Effect.Transitions.sinoidal,    opacityTransition: Effect.Transitions.none  }, arguments[1] || { });  var oldStyle = {    top: element.style.top,    left: element.style.left,    height: element.style.height,    width: element.style.width,    opacity: element.getInlineOpacity() };  var dims = element.getDimensions();  var moveX, moveY;  switch (options.direction) {    case 'top-left':      moveX = moveY = 0;      break;    case 'top-right':      moveX = dims.width;      moveY = 0;      break;    case 'bottom-left':      moveX = 0;      moveY = dims.height;      break;    case 'bottom-right':      moveX = dims.width;      moveY = dims.height;      break;    case 'center':      moveX = dims.width / 2;      moveY = dims.height / 2;      break;  }  return new Effect.Parallel(    [ new Effect.Opacity(element, { sync: true, to: 0.0, from: 1.0, transition: options.opacityTransition }),      new Effect.Scale(element, window.opera ? 1 : 0, { sync: true, transition: options.scaleTransition, restoreAfterFinish: true}),      new Effect.Move(element, { x: moveX, y: moveY, sync: true, transition: options.moveTransition })    ], Object.extend({         beforeStartInternal: function(effect) {           effect.effects[0].element.makePositioned().makeClipping();         },         afterFinishInternal: function(effect) {           effect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle); }       }, options)  );};Effect.Pulsate = function(element) {  element = $(element);  var options    = arguments[1] || { },    oldOpacity = element.getInlineOpacity(),    transition = options.transition || Effect.Transitions.linear,    reverser   = function(pos){      return 1 - transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2) + .5);    };  return new Effect.Opacity(element,    Object.extend(Object.extend({  duration: 2.0, from: 0,      afterFinishInternal: function(effect) { effect.element.setStyle({opacity: oldOpacity}); }    }, options), {transition: reverser}));};Effect.Fold = function(element) {  element = $(element);  var oldStyle = {    top: element.style.top,    left: element.style.left,    width: element.style.width,    height: element.style.height };  element.makeClipping();  return new Effect.Scale(element, 5, Object.extend({    scaleContent: false,    scaleX: false,    afterFinishInternal: function(effect) {    new Effect.Scale(element, 1, {      scaleContent: false,      scaleY: false,      afterFinishInternal: function(effect) {        effect.element.hide().undoClipping().setStyle(oldStyle);      } });  }}, arguments[1] || { }));};Effect.Morph = Class.create(Effect.Base, {  initialize: function(element) {    this.element = $(element);    if (!this.element) throw(Effect._elementDoesNotExistError);    var options = Object.extend({      style: { }    }, arguments[1] || { });    if (!Object.isString(options.style)) this.style = $H(options.style);    else {      if (options.style.include(':'))        this.style = options.style.parseStyle();      else {        this.element.addClassName(options.style);        this.style = $H(this.element.getStyles());        this.element.removeClassName(options.style);        var css = this.element.getStyles();        this.style = this.style.reject(function(style) {          return style.value == css[style.key];        });        options.afterFinishInternal = function(effect) {          effect.element.addClassName(effect.options.style);          effect.transforms.each(function(transform) {            effect.element.style[transform.style] = '';          });        };      }    }    this.start(options);  },  setup: function(){    function parseColor(color){      if (!color || ['rgba(0, 0, 0, 0)','transparent'].include(color)) color = '#ffffff';      color = color.parseColor();      return $R(0,2).map(function(i){        return parseInt( color.slice(i*2+1,i*2+3), 16 );      });    }    this.transforms = this.style.map(function(pair){      var property = pair[0], value = pair[1], unit = null;      if (value.parseColor('#zzzzzz') != '#zzzzzz') {        value = value.parseColor();        unit  = 'color';      } else if (property == 'opacity') {        value = parseFloat(value);        if (Prototype.Browser.IE && (!this.element.currentStyle.hasLayout))          this.element.setStyle({zoom: 1});      } else if (Element.CSS_LENGTH.test(value)) {          var components = value.match(/^([\+\-]?[0-9\.]+)(.*)$/);          value = parseFloat(components[1]);          unit = (components.length == 3) ? components[2] : null;      }      var originalValue = this.element.getStyle(property);      return {        style: property.camelize(),        originalValue: unit=='color' ? parseColor(originalValue) : parseFloat(originalValue || 0),        targetValue: unit=='color' ? parseColor(value) : value,        unit: unit      };    }.bind(this)).reject(function(transform){      return (        (transform.originalValue == transform.targetValue) ||        (          transform.unit != 'color' &&          (isNaN(transform.originalValue) || isNaN(transform.targetValue))        )      );    });  },  update: function(position) {    var style = { }, transform, i = this.transforms.length;    while(i--)      style[(transform = this.transforms[i]).style] =        transform.unit=='color' ? '#'+          (Math.round(transform.originalValue[0]+            (transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart() +          (Math.round(transform.originalValue[1]+            (transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart() +          (Math.round(transform.originalValue[2]+            (transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart() :        (transform.originalValue +          (transform.targetValue - transform.originalValue) * position).toFixed(3) +            (transform.unit === null ? '' : transform.unit);    this.element.setStyle(style, true);  }});Effect.Transform = Class.create({  initialize: function(tracks){    this.tracks  = [];    this.options = arguments[1] || { };    this.addTracks(tracks);  },  addTracks: function(tracks){    tracks.each(function(track){      track = $H(track);      var data = track.values().first();      this.tracks.push($H({        ids:     track.keys().first(),        effect:  Effect.Morph,        options: { style: data }      }));    }.bind(this));    return this;  },  play: function(){    return new Effect.Parallel(      this.tracks.map(function(track){        var ids = track.get('ids'), effect = track.get('effect'), options = track.get('options');        var elements = [$(ids) || $$(ids)].flatten();        return elements.map(function(e){ return new effect(e, Object.extend({ sync:true }, options)) });      }).flatten(),      this.options    );  }});Element.CSS_PROPERTIES = $w(  'backgroundColor backgroundPosition borderBottomColor borderBottomStyle ' +  'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth ' +  'borderRightColor borderRightStyle borderRightWidth borderSpacing ' +  'borderTopColor borderTopStyle borderTopWidth bottom clip color ' +  'fontSize fontWeight height left letterSpacing lineHeight ' +  'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+  'maxWidth minHeight minWidth opacity outlineColor outlineOffset ' +  'outlineWidth paddingBottom paddingLeft paddingRight paddingTop ' +  'right textIndent top width wordSpacing zIndex');Element.CSS_LENGTH = /^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement = document.createElement('div');String.prototype.parseStyle = function(){  var style, styleRules = $H();  if (Prototype.Browser.WebKit)    style = new Element('div',{style:this}).style;  else {    String.__parseStyleElement.innerHTML = '<div style="' + this + '"></div>';    style = String.__parseStyleElement.childNodes[0].style;  }  Element.CSS_PROPERTIES.each(function(property){    if (style[property]) styleRules.set(property, style[property]);  });  if (Prototype.Browser.IE && this.include('opacity'))    styleRules.set('opacity', this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);  return styleRules;};if (document.defaultView && document.defaultView.getComputedStyle) {  Element.getStyles = function(element) {    var css = document.defaultView.getComputedStyle($(element), null);    return Element.CSS_PROPERTIES.inject({ }, function(styles, property) {      styles[property] = css[property];      return styles;    });  };} else {  Element.getStyles = function(element) {    element = $(element);    var css = element.currentStyle, styles;    styles = Element.CSS_PROPERTIES.inject({ }, function(results, property) {      results[property] = css[property];      return results;    });    if (!styles.opacity) styles.opacity = element.getOpacity();    return styles;  };}Effect.Methods = {  morph: function(element, style) {    element = $(element);    new Effect.Morph(element, Object.extend({ style: style }, arguments[2] || { }));    return element;  },  visualEffect: function(element, effect, options) {    element = $(element);    var s = effect.dasherize().camelize(), klass = s.charAt(0).toUpperCase() + s.substring(1);    new Effect[klass](element, options);    return element;  },  highlight: function(element, options) {    element = $(element);    new Effect.Highlight(element, options);    return element;  }};$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+  'pulsate shake puff squish switchOff dropOut').each(  function(effect) {    Effect.Methods[effect] = function(element, options){      element = $(element);      Effect[effect.charAt(0).toUpperCase() + effect.substring(1)](element, options);      return element;    };  });$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(  function(f) { Effect.Methods[f] = Element[f]; });Element.addMethods(Effect.Methods);//--></script>		<script type="text/javascript"  style="display:none"><!--/*	Developed by Robert Nyman, http://www.robertnyman.com	Code/licensing: http://code.google.com/p/getelementsbyclassname/*/	var getElementsByClassName = function (className, tag, elm){	if (document.getElementsByClassName) {		getElementsByClassName = function (className, tag, elm) {			elm = elm || document;			var elements = elm.getElementsByClassName(className),				nodeName = (tag)? new RegExp("\\b" + tag + "\\b", "i") : null,				returnElements = [],				current;			for(var i=0, il=elements.length; i<il; i+=1){				current = elements[i];				if(!nodeName || nodeName.test(current.nodeName)) {					returnElements.push(current);				}			}			return returnElements;		};	}	else if (document.evaluate) {		getElementsByClassName = function (className, tag, elm) {			tag = tag || "*";			elm = elm || document;			var classes = className.split(" "),				classesToCheck = "",				xhtmlNamespace = "http://www.w3.org/1999/xhtml",				namespaceResolver = (document.documentElement.namespaceURI === xhtmlNamespace)? xhtmlNamespace : null,				returnElements = [],				elements,				node;			for(var j=0, jl=classes.length; j<jl; j+=1){				classesToCheck += "[contains(concat(' ', @class, ' '), ' " + classes[j] + " ')]";			}			try	{				elements = document.evaluate(".//" + tag + classesToCheck, elm, namespaceResolver, 0, null);			}			catch (e) {				elements = document.evaluate(".//" + tag + classesToCheck, elm, null, 0, null);			}			while ((node = elements.iterateNext())) {				returnElements.push(node);			}			return returnElements;		};	}	else {		getElementsByClassName = function (className, tag, elm) {			tag = tag || "*";			elm = elm || document;			var classes = className.split(" "),				classesToCheck = [],				elements = (tag === "*" && elm.all)? elm.all : elm.getElementsByTagName(tag),				current,				returnElements = [],				match;			for(var k=0, kl=classes.length; k<kl; k+=1){				classesToCheck.push(new RegExp("(^|\\s)" + classes[k] + "(\\s|$)"));			}			for(var l=0, ll=elements.length; l<ll; l+=1){				current = elements[l];				match = false;				for(var m=0, ml=classesToCheck.length; m<ml; m+=1){					match = classesToCheck[m].test(current.className);					if (!match) {						break;					}				}				if (match) {					returnElements.push(current);				}			}			return returnElements;		};	}	return getElementsByClassName(className, tag, elm);};function Rafraichir(){	for(var i = 0;i<getElementsByClassName('lien_agenda').length;i++){		if(document.getElementById('input_agrandi').value == 1){			getElementsByClassName('lien_agenda')[i].href += "&AGRANDI=1";		}else{			getElementsByClassName('lien_agenda')[i].href += "&AGRANDI=0";		}		if(document.getElementById('input_rechercheOn').value == 1){			getElementsByClassName('lien_agenda')[i].href += "&RECHERCHE_ON=1";		}else{			getElementsByClassName('lien_agenda')[i].href += "&RECHERCHE_ON=0";		}	}}//--></script>		<link rel="start" title="Accueil" href="http://www.univ-nantes.fr/" />		<link rel="alternate" type="application/rss+xml" title="Fil RSS des dix derni&egrave;res actualit&eacute;s" href="http://www.univ-nantes.fr/rss" />		<script type="text/javascript"  style="display:none"><!--//-------------------------------------------------------------------------// Fonction d'affichage d'une adresse email// param: partie droite, partie gauche de l'adresse email a reconstituer//-------------------------------------------------------------------------function afficheMail(droite,gauche,contenu) {	if(!isDefined(contenu)) {		document.write("<a href=\"" + "mail" + "to:" + gauche + "@" + droite +"\">" + gauche + "@" + droite + "</a><img src=\"/images/protection-14x14.png\" title=\"Cette adresse est prot&eacute;g&eacute;e contre le spam\">");	} else {		document.write("<a href=\"" + "mail" + "to:" + gauche + "@" + droite +"\">" + contenu + "</a><img src=\"/images/protection-14x14.png\" title=\"Cette adresse est prot&eacute;g&eacute;e contre le spam\">");		}}function isDefined(variable) {    return (!(!( variable||false )))}function portlet_showhide(id) {        if(document.getElementById(id).style.display == 'none') {                document.getElementById(id).style.display = 'block';                document.getElementById("label_"+id).innerHTML = 'cacher';        } else {                document.getElementById(id).style.display = 'none';                document.getElementById("label_"+id).innerHTML = 'ajouter &agrave; votre site';        }}//--></script>		<script type="text/javascript"  style="display:none"><!--//***********************************************************************************************************************************///	LyteBox v3.22////	 Author: Markus F. Hay//  Website: http://www.dolem.com/lytebox//	   Date: October 2, 2007//	License: Creative Commons Attribution 3.0 License (http://creativecommons.org/licenses/by/3.0/)// Browsers: Tested successfully on WinXP with the following browsers (using no DOCTYPE and Strict/Transitional/Loose DOCTYPES)://				* Firefox: 2.0.0.7, 1.5.0.12//				* Internet Explorer: 7.0, 6.0 SP2, 5.5 SP2//				* Opera: 9.23//// Releases: For up-to-date and complete release information, visit http://www.dolem.com/forum/showthread.php?tid=62//				* v3.22 (10/02/07)//				* v3.21 (09/30/07)//				* v3.20 (07/12/07)//				* v3.10 (05/28/07)//				* v3.00 (05/15/07)//				* v2.02 (11/13/06)////   Credit: LyteBox was originally derived from the Lightbox class (v2.02) that was written by Lokesh Dhakar. For more//			 information please visit http://huddletogether.com/projects/lightbox2///***********************************************************************************************************************************/Array.prototype.removeDuplicates = function () { for (var i = 1; i < this.length; i++) { if (this[i][0] == this[i-1][0]) { this.splice(i,1); } } }Array.prototype.empty = function () { for (var i = 0; i <= this.length; i++) { this.shift(); } }String.prototype.trim = function () { return this.replace(/^\s+|\s+$/g, ''); }function LyteBox() {	/*** Start Global Configuration ***/		this.theme			= 'grey';	// themes: grey (default), red, green, blue, gold		this.hideFlash			= true;		// controls whether or not Flash objects should be hidden		this.outerBorder		= true;		// controls whether to show the outer grey (or theme) border		this.resizeSpeed		= 8;		// controls the speed of the image resizing (1=slowest and 10=fastest)		this.maxOpacity			= 80;		// higher opacity = darker overlay, lower opacity = lighter overlay		this.navType			= 1;		// 1 = "Prev/Next" buttons on top left and left (default), 2 = "<< prev | next >>" links next to image number		this.autoResize			= true;		// controls whether or not images should be resized if larger than the browser window dimensions		this.doAnimations		= true;		// controls whether or not "animate" Lytebox, i.e. resize transition between images, fade in/out effects, etc.				this.borderSize			= 12;		// if you adjust the padding in the CSS, you will need to update this variable -- otherwise, leave this alone...	/*** End Global Configuration ***/		/*** Configure Slideshow Options ***/		this.slideInterval		= 8000;		// Change value (milliseconds) to increase/decrease the time between "slides" (10000 = 10 seconds)		this.showNavigation		= true;		// true to display Next/Prev buttons/text during slideshow, false to hide		this.showClose			= true;		// true to display the Close button, false to hide		this.showDetails		= true;		// true to display image details (caption, count), false to hide		this.showPlayPause		= true;		// true to display pause/play buttons next to close button, false to hide		this.autoEnd			= true;		// true to automatically close Lytebox after the last image is reached, false to keep open		this.pauseOnNextClick	= false;	// true to pause the slideshow when the "Next" button is clicked        this.pauseOnPrevClick 	= true;		// true to pause the slideshow when the "Prev" button is clicked	/*** End Slideshow Configuration ***/		if(this.resizeSpeed > 10) { this.resizeSpeed = 10; }	if(this.resizeSpeed < 1) { resizeSpeed = 1; }	this.resizeDuration = (11 - this.resizeSpeed) * 0.15;	this.resizeWTimerArray		= new Array();	this.resizeWTimerCount		= 0;	this.resizeHTimerArray		= new Array();	this.resizeHTimerCount		= 0;	this.showContentTimerArray	= new Array();	this.showContentTimerCount	= 0;	this.overlayTimerArray		= new Array();	this.overlayTimerCount		= 0;	this.imageTimerArray		= new Array();	this.imageTimerCount		= 0;	this.timerIDArray			= new Array();	this.timerIDCount			= 0;	this.slideshowIDArray		= new Array();	this.slideshowIDCount		= 0;	this.imageArray	 = new Array();	this.activeImage = null;	this.slideArray	 = new Array();	this.activeSlide = null;	this.frameArray	 = new Array();	this.activeFrame = null;	this.checkFrame();	this.isSlideshow = false;	this.isLyteframe = false;	/*@cc_on		/*@if (@_jscript)			this.ie = (document.all && !window.opera) ? true : false;		/*@else @*/			this.ie = false;		/*@end	@*/	this.ie7 = (this.ie && window.XMLHttpRequest);		this.initialize();}LyteBox.prototype.initialize = function() {	this.updateLyteboxItems();	var objBody = this.doc.getElementsByTagName("body").item(0);		if (this.doc.getElementById('lbOverlay')) {		objBody.removeChild(this.doc.getElementById("lbOverlay"));		objBody.removeChild(this.doc.getElementById("lbMain"));	}	var objOverlay = this.doc.createElement("div");		objOverlay.setAttribute('id','lbOverlay');		objOverlay.setAttribute((this.ie ? 'className' : 'class'), this.theme);		if ((this.ie && !this.ie7) || (this.ie7 && this.doc.compatMode == 'BackCompat')) {			objOverlay.style.position = 'absolute';		}		objOverlay.style.display = 'none';		objBody.appendChild(objOverlay);	var objLytebox = this.doc.createElement("div");		objLytebox.setAttribute('id','lbMain');		objLytebox.style.display = 'none';		objBody.appendChild(objLytebox);	var objOuterContainer = this.doc.createElement("div");		objOuterContainer.setAttribute('id','lbOuterContainer');		objOuterContainer.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objLytebox.appendChild(objOuterContainer);	var objIframeContainer = this.doc.createElement("div");		objIframeContainer.setAttribute('id','lbIframeContainer');		objIframeContainer.style.display = 'none';		objOuterContainer.appendChild(objIframeContainer);	var objIframe = this.doc.createElement("iframe");		objIframe.setAttribute('id','lbIframe');		objIframe.setAttribute('name','lbIframe');		objIframe.style.display = 'none';		objIframeContainer.appendChild(objIframe);	var objImageContainer = this.doc.createElement("div");		objImageContainer.setAttribute('id','lbImageContainer');		objOuterContainer.appendChild(objImageContainer);	var objLyteboxImage = this.doc.createElement("img");		objLyteboxImage.setAttribute('id','lbImage');		objImageContainer.appendChild(objLyteboxImage);	var objLoading = this.doc.createElement("div");		objLoading.setAttribute('id','lbLoading');		objOuterContainer.appendChild(objLoading);	var objDetailsContainer = this.doc.createElement("div");		objDetailsContainer.setAttribute('id','lbDetailsContainer');		objDetailsContainer.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objLytebox.appendChild(objDetailsContainer);	var objDetailsData =this.doc.createElement("div");		objDetailsData.setAttribute('id','lbDetailsData');		objDetailsData.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objDetailsContainer.appendChild(objDetailsData);	var objDetails = this.doc.createElement("div");		objDetails.setAttribute('id','lbDetails');		objDetailsData.appendChild(objDetails);	var objCaption = this.doc.createElement("span");		objCaption.setAttribute('id','lbCaption');		objDetails.appendChild(objCaption);	var objHoverNav = this.doc.createElement("div");		objHoverNav.setAttribute('id','lbHoverNav');		objImageContainer.appendChild(objHoverNav);	var objBottomNav = this.doc.createElement("div");		objBottomNav.setAttribute('id','lbBottomNav');		objDetailsData.appendChild(objBottomNav);	var objPrev = this.doc.createElement("a");		objPrev.setAttribute('id','lbPrev');		objPrev.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objPrev.setAttribute('href','#');		objHoverNav.appendChild(objPrev);	var objNext = this.doc.createElement("a");		objNext.setAttribute('id','lbNext');		objNext.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objNext.setAttribute('href','#');		objHoverNav.appendChild(objNext);	var objNumberDisplay = this.doc.createElement("span");		objNumberDisplay.setAttribute('id','lbNumberDisplay');		objDetails.appendChild(objNumberDisplay);	var objNavDisplay = this.doc.createElement("span");		objNavDisplay.setAttribute('id','lbNavDisplay');		objNavDisplay.style.display = 'none';		objDetails.appendChild(objNavDisplay);	var objClose = this.doc.createElement("a");		objClose.setAttribute('id','lbClose');		objClose.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objClose.setAttribute('href','#');		objBottomNav.appendChild(objClose);	var objPause = this.doc.createElement("a");		objPause.setAttribute('id','lbPause');		objPause.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objPause.setAttribute('href','#');		objPause.style.display = 'none';		objBottomNav.appendChild(objPause);	var objPlay = this.doc.createElement("a");		objPlay.setAttribute('id','lbPlay');		objPlay.setAttribute((this.ie ? 'className' : 'class'), this.theme);		objPlay.setAttribute('href','#');		objPlay.style.display = 'none';		objBottomNav.appendChild(objPlay);};LyteBox.prototype.updateLyteboxItems = function() {		var anchors = (this.isFrame) ? window.parent.frames[window.name].document.getElementsByTagName('a') : document.getElementsByTagName('a');	for (var i = 0; i < anchors.length; i++) {		var anchor = anchors[i];		var relAttribute = String(anchor.getAttribute('rel'));		if (anchor.getAttribute('href')) {			if (relAttribute.toLowerCase().match('lytebox')) {				anchor.onclick = function () { myLytebox.start(this, false, false); return false; }			} else if (relAttribute.toLowerCase().match('lyteshow')) {				anchor.onclick = function () { myLytebox.start(this, true, false); return false; }			} else if (relAttribute.toLowerCase().match('lyteframe')) {				anchor.onclick = function () { myLytebox.start(this, false, true); return false; }			}		}	}};LyteBox.prototype.start = function(imageLink, doSlide, doFrame) {	if (this.ie && !this.ie7) {	this.toggleSelects('hide');	}	if (this.hideFlash) { this.toggleFlash('hide'); }	this.isLyteframe = (doFrame ? true : false);	var pageSize	= this.getPageSize();	var objOverlay	= this.doc.getElementById('lbOverlay');	var objBody		= this.doc.getElementsByTagName("body").item(0);	objOverlay.style.height = pageSize[1] + "px";	objOverlay.style.display = '';	this.appear('lbOverlay', (this.doAnimations ? 0 : this.maxOpacity));	var anchors = (this.isFrame) ? window.parent.frames[window.name].document.getElementsByTagName('a') : document.getElementsByTagName('a');	if (this.isLyteframe) {		this.frameArray = [];		this.frameNum = 0;		if ((imageLink.getAttribute('rel') == 'lyteframe')) {			var rev = imageLink.getAttribute('rev');			this.frameArray.push(new Array(imageLink.getAttribute('href'), imageLink.getAttribute('title'), (rev == null || rev == '' ? 'width: 400px; height: 400px; scrolling: auto;' : rev)));		} else {			if (imageLink.getAttribute('rel').indexOf('lyteframe') != -1) {				for (var i = 0; i < anchors.length; i++) {					var anchor = anchors[i];					if (anchor.getAttribute('href') && (anchor.getAttribute('rel') == imageLink.getAttribute('rel'))) {						var rev = anchor.getAttribute('rev');						this.frameArray.push(new Array(anchor.getAttribute('href'), anchor.getAttribute('title'), (rev == null || rev == '' ? 'width: 400px; height: 400px; scrolling: auto;' : rev)));					}				}				this.frameArray.removeDuplicates();				while(this.frameArray[this.frameNum][0] != imageLink.getAttribute('href')) { this.frameNum++; }			}		}	} else {		this.imageArray = [];		this.imageNum = 0;		this.slideArray = [];		this.slideNum = 0;		if ((imageLink.getAttribute('rel') == 'lytebox')) {			this.imageArray.push(new Array(imageLink.getAttribute('href'), imageLink.getAttribute('title')));		} else {			if (imageLink.getAttribute('rel').indexOf('lytebox') != -1) {				for (var i = 0; i < anchors.length; i++) {					var anchor = anchors[i];					if (anchor.getAttribute('href') && (anchor.getAttribute('rel') == imageLink.getAttribute('rel'))) {						this.imageArray.push(new Array(anchor.getAttribute('href'), anchor.getAttribute('title')));					}				}				this.imageArray.removeDuplicates();				while(this.imageArray[this.imageNum][0] != imageLink.getAttribute('href')) { this.imageNum++; }			}			if (imageLink.getAttribute('rel').indexOf('lyteshow') != -1) {				for (var i = 0; i < anchors.length; i++) {					var anchor = anchors[i];					if (anchor.getAttribute('href') && (anchor.getAttribute('rel') == imageLink.getAttribute('rel'))) {						this.slideArray.push(new Array(anchor.getAttribute('href'), anchor.getAttribute('title')));					}				}				this.slideArray.removeDuplicates();				while(this.slideArray[this.slideNum][0] != imageLink.getAttribute('href')) { this.slideNum++; }			}		}	}	var object = this.doc.getElementById('lbMain');		object.style.top = (this.getPageScroll() + (pageSize[3] / 15)) + "px";		object.style.display = '';	if (!this.outerBorder) {		this.doc.getElementById('lbOuterContainer').style.border = 'none';		this.doc.getElementById('lbDetailsContainer').style.border = 'none';	} else {		this.doc.getElementById('lbOuterContainer').style.borderBottom = '';		this.doc.getElementById('lbOuterContainer').setAttribute((this.ie ? 'className' : 'class'), this.theme);	}	this.doc.getElementById('lbOverlay').onclick = function() { myLytebox.end(); return false; }	this.doc.getElementById('lbMain').onclick = function(e) {		var e = e;		if (!e) {			if (window.parent.frames[window.name] && (parent.document.getElementsByTagName('frameset').length <= 0)) {				e = window.parent.window.event;			} else {				e = window.event;			}		}		var id = (e.target ? e.target.id : e.srcElement.id);		if (id == 'lbMain') { myLytebox.end(); return false; }	}	this.doc.getElementById('lbClose').onclick = function() { myLytebox.end(); return false; }	this.doc.getElementById('lbPause').onclick = function() { myLytebox.togglePlayPause("lbPause", "lbPlay"); return false; }	this.doc.getElementById('lbPlay').onclick = function() { myLytebox.togglePlayPause("lbPlay", "lbPause"); return false; }		this.isSlideshow = doSlide;	this.isPaused = (this.slideNum != 0 ? true : false);	if (this.isSlideshow && this.showPlayPause && this.isPaused) {		this.doc.getElementById('lbPlay').style.display = '';		this.doc.getElementById('lbPause').style.display = 'none';	}	if (this.isLyteframe) {		this.changeContent(this.frameNum);	} else {		if (this.isSlideshow) {			this.changeContent(this.slideNum);		} else {			this.changeContent(this.imageNum);		}	}};LyteBox.prototype.changeContent = function(imageNum) {	if (this.isSlideshow) {		for (var i = 0; i < this.slideshowIDCount; i++) { window.clearTimeout(this.slideshowIDArray[i]); }	}	this.activeImage = this.activeSlide = this.activeFrame = imageNum;	if (!this.outerBorder) {		this.doc.getElementById('lbOuterContainer').style.border = 'none';		this.doc.getElementById('lbDetailsContainer').style.border = 'none';	} else {		this.doc.getElementById('lbOuterContainer').style.borderBottom = '';		this.doc.getElementById('lbOuterContainer').setAttribute((this.ie ? 'className' : 'class'), this.theme);	}	this.doc.getElementById('lbLoading').style.display = '';	this.doc.getElementById('lbImage').style.display = 'none';	this.doc.getElementById('lbIframe').style.display = 'none';	this.doc.getElementById('lbPrev').style.display = 'none';	this.doc.getElementById('lbNext').style.display = 'none';	this.doc.getElementById('lbIframeContainer').style.display = 'none';	this.doc.getElementById('lbDetailsContainer').style.display = 'none';	this.doc.getElementById('lbNumberDisplay').style.display = 'none';	if (this.navType == 2 || this.isLyteframe) {		object = this.doc.getElementById('lbNavDisplay');		object.innerHTML = '&nbsp;&nbsp;&nbsp;<span id="lbPrev2_Off" style="display: none;" class="' + this.theme + '">&laquo; prev</span><a href="#" id="lbPrev2" class="' + this.theme + '" style="display: none;">&laquo; prev</a> <b id="lbSpacer" class="' + this.theme + '">||</b> <span id="lbNext2_Off" style="display: none;" class="' + this.theme + '">next &raquo;</span><a href="#" id="lbNext2" class="' + this.theme + '" style="display: none;">next &raquo;</a>';		object.style.display = 'none';	}	if (this.isLyteframe) {		var iframe = myLytebox.doc.getElementById('lbIframe');		var styles = this.frameArray[this.activeFrame][2];		var aStyles = styles.split(';');		for (var i = 0; i < aStyles.length; i++) {			if (aStyles[i].indexOf('width:') >= 0) {				var w = aStyles[i].replace('width:', '');				iframe.width = w.trim();			} else if (aStyles[i].indexOf('height:') >= 0) {				var h = aStyles[i].replace('height:', '');				iframe.height = h.trim();			} else if (aStyles[i].indexOf('scrolling:') >= 0) {				var s = aStyles[i].replace('scrolling:', '');				iframe.scrolling = s.trim();			} else if (aStyles[i].indexOf('border:') >= 0) {				// Not implemented yet, as there are cross-platform issues with setting the border (from a GUI standpoint)				//var b = aStyles[i].replace('border:', '');				//iframe.style.border = b.trim();			}		}		this.resizeContainer(parseInt(iframe.width), parseInt(iframe.height));	} else {		imgPreloader = new Image();		imgPreloader.onload = function() {			var imageWidth = imgPreloader.width;			var imageHeight = imgPreloader.height;			if (myLytebox.autoResize) {				var pagesize = myLytebox.getPageSize();				var x = pagesize[2] - 150;				var y = pagesize[3] - 150;				if (imageWidth > x) {					imageHeight = Math.round(imageHeight * (x / imageWidth));					imageWidth = x; 					if (imageHeight > y) { 						imageWidth = Math.round(imageWidth * (y / imageHeight));						imageHeight = y; 					}				} else if (imageHeight > y) { 					imageWidth = Math.round(imageWidth * (y / imageHeight));					imageHeight = y; 					if (imageWidth > x) {						imageHeight = Math.round(imageHeight * (x / imageWidth));						imageWidth = x;					}				}			}			var lbImage = myLytebox.doc.getElementById('lbImage')			lbImage.src = (myLytebox.isSlideshow ? myLytebox.slideArray[myLytebox.activeSlide][0] : myLytebox.imageArray[myLytebox.activeImage][0]);			lbImage.width = imageWidth;			lbImage.height = imageHeight;			myLytebox.resizeContainer(imageWidth, imageHeight);			imgPreloader.onload = function() {};		}		imgPreloader.src = (this.isSlideshow ? this.slideArray[this.activeSlide][0] : this.imageArray[this.activeImage][0]);	}};LyteBox.prototype.resizeContainer = function(imgWidth, imgHeight) {	this.wCur = this.doc.getElementById('lbOuterContainer').offsetWidth;	this.hCur = this.doc.getElementById('lbOuterContainer').offsetHeight;	this.xScale = ((imgWidth  + (this.borderSize * 2)) / this.wCur) * 100;	this.yScale = ((imgHeight  + (this.borderSize * 2)) / this.hCur) * 100;	var wDiff = (this.wCur - this.borderSize * 2) - imgWidth;	var hDiff = (this.hCur - this.borderSize * 2) - imgHeight;	if (!(hDiff == 0)) {		this.hDone = false;		this.resizeH('lbOuterContainer', this.hCur, imgHeight + this.borderSize*2, this.getPixelRate(this.hCur, imgHeight));	} else {		this.hDone = true;	}	if (!(wDiff == 0)) {		this.wDone = false;		this.resizeW('lbOuterContainer', this.wCur, imgWidth + this.borderSize*2, this.getPixelRate(this.wCur, imgWidth));	} else {		this.wDone = true;	}	if ((hDiff == 0) && (wDiff == 0)) {		if (this.ie){ this.pause(250); } else { this.pause(100); } 	}	this.doc.getElementById('lbPrev').style.height = imgHeight + "px";	this.doc.getElementById('lbNext').style.height = imgHeight + "px";	this.doc.getElementById('lbDetailsContainer').style.width = (imgWidth + (this.borderSize * 2) + (this.ie && this.doc.compatMode == "BackCompat" && this.outerBorder ? 2 : 0)) + "px";	this.showContent();};LyteBox.prototype.showContent = function() {	if (this.wDone && this.hDone) {		for (var i = 0; i < this.showContentTimerCount; i++) { window.clearTimeout(this.showContentTimerArray[i]); }		if (this.outerBorder) {			this.doc.getElementById('lbOuterContainer').style.borderBottom = 'none';		}		this.doc.getElementById('lbLoading').style.display = 'none';		if (this.isLyteframe) {			this.doc.getElementById('lbIframe').style.display = '';			this.appear('lbIframe', (this.doAnimations ? 0 : 100));		} else {			this.doc.getElementById('lbImage').style.display = '';			this.appear('lbImage', (this.doAnimations ? 0 : 100));			this.preloadNeighborImages();		}		if (this.isSlideshow) {			if(this.activeSlide == (this.slideArray.length - 1)) {				if (this.autoEnd) {					this.slideshowIDArray[this.slideshowIDCount++] = setTimeout("myLytebox.end('slideshow')", this.slideInterval);				}			} else {				if (!this.isPaused) {					this.slideshowIDArray[this.slideshowIDCount++] = setTimeout("myLytebox.changeContent("+(this.activeSlide+1)+")", this.slideInterval);				}			}			this.doc.getElementById('lbHoverNav').style.display = (this.showNavigation && this.navType == 1 ? '' : 'none');			this.doc.getElementById('lbClose').style.display = (this.showClose ? '' : 'none');			this.doc.getElementById('lbDetails').style.display = (this.showDetails ? '' : 'none');			this.doc.getElementById('lbPause').style.display = (this.showPlayPause && !this.isPaused ? '' : 'none');			this.doc.getElementById('lbPlay').style.display = (this.showPlayPause && !this.isPaused ? 'none' : '');			this.doc.getElementById('lbNavDisplay').style.display = (this.showNavigation && this.navType == 2 ? '' : 'none');		} else {			this.doc.getElementById('lbHoverNav').style.display = (this.navType == 1 && !this.isLyteframe ? '' : 'none');			if ((this.navType == 2 && !this.isLyteframe && this.imageArray.length > 1) || (this.frameArray.length > 1 && this.isLyteframe)) {				this.doc.getElementById('lbNavDisplay').style.display = '';			} else {				this.doc.getElementById('lbNavDisplay').style.display = 'none';			}			this.doc.getElementById('lbClose').style.display = '';			this.doc.getElementById('lbDetails').style.display = '';			this.doc.getElementById('lbPause').style.display = 'none';			this.doc.getElementById('lbPlay').style.display = 'none';		}		this.doc.getElementById('lbImageContainer').style.display = (this.isLyteframe ? 'none' : '');		this.doc.getElementById('lbIframeContainer').style.display = (this.isLyteframe ? '' : 'none');		try {			this.doc.getElementById('lbIframe').src = this.frameArray[this.activeFrame][0];		} catch(e) { }	} else {		this.showContentTimerArray[this.showContentTimerCount++] = setTimeout("myLytebox.showContent()", 200);	}};LyteBox.prototype.updateDetails = function() {	var object = this.doc.getElementById('lbCaption');	var sTitle = (this.isSlideshow ? this.slideArray[this.activeSlide][1] : (this.isLyteframe ? this.frameArray[this.activeFrame][1] : this.imageArray[this.activeImage][1]));	object.style.display = '';	object.innerHTML = (sTitle == null ? '' : sTitle);	this.updateNav();	this.doc.getElementById('lbDetailsContainer').style.display = '';	object = this.doc.getElementById('lbNumberDisplay');	if (this.isSlideshow && this.slideArray.length > 1) {		object.style.display = '';		object.innerHTML = "Image " + eval(this.activeSlide + 1) + " of " + this.slideArray.length;		this.doc.getElementById('lbNavDisplay').style.display = (this.navType == 2 && this.showNavigation ? '' : 'none');	} else if (this.imageArray.length > 1 && !this.isLyteframe) {		object.style.display = '';		object.innerHTML = "Image " + eval(this.activeImage + 1) + " of " + this.imageArray.length;		this.doc.getElementById('lbNavDisplay').style.display = (this.navType == 2 ? '' : 'none');	} else if (this.frameArray.length > 1 && this.isLyteframe) {		object.style.display = '';		object.innerHTML = "Page " + eval(this.activeFrame + 1) + " of " + this.frameArray.length;		this.doc.getElementById('lbNavDisplay').style.display = '';	} else {		this.doc.getElementById('lbNavDisplay').style.display = 'none';	}	this.appear('lbDetailsContainer', (this.doAnimations ? 0 : 100));};LyteBox.prototype.updateNav = function() {	if (this.isSlideshow) {		if (this.activeSlide != 0) {			var object = (this.navType == 2 ? this.doc.getElementById('lbPrev2') : this.doc.getElementById('lbPrev'));				object.style.display = '';				object.onclick = function() {					if (myLytebox.pauseOnPrevClick) { myLytebox.togglePlayPause("lbPause", "lbPlay"); }					myLytebox.changeContent(myLytebox.activeSlide - 1); return false;				}		} else {			if (this.navType == 2) { this.doc.getElementById('lbPrev2_Off').style.display = ''; }		}		if (this.activeSlide != (this.slideArray.length - 1)) {			var object = (this.navType == 2 ? this.doc.getElementById('lbNext2') : this.doc.getElementById('lbNext'));				object.style.display = '';				object.onclick = function() {					if (myLytebox.pauseOnNextClick) { myLytebox.togglePlayPause("lbPause", "lbPlay"); }					myLytebox.changeContent(myLytebox.activeSlide + 1); return false;				}		} else {			if (this.navType == 2) { this.doc.getElementById('lbNext2_Off').style.display = ''; }		}	} else if (this.isLyteframe) {		if(this.activeFrame != 0) {			var object = this.doc.getElementById('lbPrev2');				object.style.display = '';				object.onclick = function() {					myLytebox.changeContent(myLytebox.activeFrame - 1); return false;				}		} else {			this.doc.getElementById('lbPrev2_Off').style.display = '';		}		if(this.activeFrame != (this.frameArray.length - 1)) {			var object = this.doc.getElementById('lbNext2');				object.style.display = '';				object.onclick = function() {					myLytebox.changeContent(myLytebox.activeFrame + 1); return false;				}		} else {			this.doc.getElementById('lbNext2_Off').style.display = '';		}			} else {		if(this.activeImage != 0) {			var object = (this.navType == 2 ? this.doc.getElementById('lbPrev2') : this.doc.getElementById('lbPrev'));				object.style.display = '';				object.onclick = function() {					myLytebox.changeContent(myLytebox.activeImage - 1); return false;				}		} else {			if (this.navType == 2) { this.doc.getElementById('lbPrev2_Off').style.display = ''; }		}		if(this.activeImage != (this.imageArray.length - 1)) {			var object = (this.navType == 2 ? this.doc.getElementById('lbNext2') : this.doc.getElementById('lbNext'));				object.style.display = '';				object.onclick = function() {					myLytebox.changeContent(myLytebox.activeImage + 1); return false;				}		} else {			if (this.navType == 2) { this.doc.getElementById('lbNext2_Off').style.display = ''; }		}	}	this.enableKeyboardNav();};LyteBox.prototype.enableKeyboardNav = function() { document.onkeydown = this.keyboardAction; };LyteBox.prototype.disableKeyboardNav = function() { document.onkeydown = ''; };LyteBox.prototype.keyboardAction = function(e) {	var keycode = key = escape = null;	keycode	= (e == null) ? event.keyCode : e.which;	key		= String.fromCharCode(keycode).toLowerCase();	escape  = (e == null) ? 27 : e.DOM_VK_ESCAPE;	if ((key == 'x') || (key == 'c') || (keycode == escape)) {		myLytebox.end();	} else if ((key == 'p') || (keycode == 37)) {		if (myLytebox.isSlideshow) {			if(myLytebox.activeSlide != 0) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeSlide - 1);			}		} else if (myLytebox.isLyteframe) {			if(myLytebox.activeFrame != 0) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeFrame - 1);			}		} else {			if(myLytebox.activeImage != 0) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeImage - 1);			}		}	} else if ((key == 'n') || (keycode == 39)) {		if (myLytebox.isSlideshow) {			if(myLytebox.activeSlide != (myLytebox.slideArray.length - 1)) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeSlide + 1);			}		} else if (myLytebox.isLyteframe) {			if(myLytebox.activeFrame != (myLytebox.frameArray.length - 1)) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeFrame + 1);			}		} else {			if(myLytebox.activeImage != (myLytebox.imageArray.length - 1)) {				myLytebox.disableKeyboardNav();				myLytebox.changeContent(myLytebox.activeImage + 1);			}		}	}};LyteBox.prototype.preloadNeighborImages = function() {	if (this.isSlideshow) {		if ((this.slideArray.length - 1) > this.activeSlide) {			preloadNextImage = new Image();			preloadNextImage.src = this.slideArray[this.activeSlide + 1][0];		}		if(this.activeSlide > 0) {			preloadPrevImage = new Image();			preloadPrevImage.src = this.slideArray[this.activeSlide - 1][0];		}	} else {		if ((this.imageArray.length - 1) > this.activeImage) {			preloadNextImage = new Image();			preloadNextImage.src = this.imageArray[this.activeImage + 1][0];		}		if(this.activeImage > 0) {			preloadPrevImage = new Image();			preloadPrevImage.src = this.imageArray[this.activeImage - 1][0];		}	}};LyteBox.prototype.togglePlayPause = function(hideID, showID) {	if (this.isSlideshow && hideID == "lbPause") {		for (var i = 0; i < this.slideshowIDCount; i++) { window.clearTimeout(this.slideshowIDArray[i]); }	}	this.doc.getElementById(hideID).style.display = 'none';	this.doc.getElementById(showID).style.display = '';	if (hideID == "lbPlay") {		this.isPaused = false;		if (this.activeSlide == (this.slideArray.length - 1)) {			this.end();		} else {			this.changeContent(this.activeSlide + 1);		}	} else {		this.isPaused = true;	}};LyteBox.prototype.end = function(caller) {	var closeClick = (caller == 'slideshow' ? false : true);	if (this.isSlideshow && this.isPaused && !closeClick) { return; }	this.disableKeyboardNav();	this.doc.getElementById('lbMain').style.display = 'none';	this.fade('lbOverlay', (this.doAnimations ? this.maxOpacity : 0));	this.toggleSelects('visible');	if (this.hideFlash) { this.toggleFlash('visible'); }	if (this.isSlideshow) {		for (var i = 0; i < this.slideshowIDCount; i++) { window.clearTimeout(this.slideshowIDArray[i]); }	}	if (this.isLyteframe) {		 this.initialize();	}};LyteBox.prototype.checkFrame = function() {	if (window.parent.frames[window.name] && (parent.document.getElementsByTagName('frameset').length <= 0)) {		this.isFrame = true;		this.lytebox = "window.parent." + window.name + ".myLytebox";		this.doc = parent.document;	} else {		this.isFrame = false;		this.lytebox = "myLytebox";		this.doc = document;	}};LyteBox.prototype.getPixelRate = function(cur, img) {	var diff = (img > cur) ? img - cur : cur - img;	if (diff >= 0 && diff <= 100) { return 10; }	if (diff > 100 && diff <= 200) { return 15; }	if (diff > 200 && diff <= 300) { return 20; }	if (diff > 300 && diff <= 400) { return 25; }	if (diff > 400 && diff <= 500) { return 30; }	if (diff > 500 && diff <= 600) { return 35; }	if (diff > 600 && diff <= 700) { return 40; }	if (diff > 700) { return 45; }};LyteBox.prototype.appear = function(id, opacity) {	var object = this.doc.getElementById(id).style;	object.opacity = (opacity / 100);	object.MozOpacity = (opacity / 100);	object.KhtmlOpacity = (opacity / 100);	object.filter = "alpha(opacity=" + (opacity + 10) + ")";	if (opacity == 100 && (id == 'lbImage' || id == 'lbIframe')) {		try { object.removeAttribute("filter"); } catch(e) {}	/* Fix added for IE Alpha Opacity Filter bug. */		this.updateDetails();	} else if (opacity >= this.maxOpacity && id == 'lbOverlay') {		for (var i = 0; i < this.overlayTimerCount; i++) { window.clearTimeout(this.overlayTimerArray[i]); }		return;	} else if (opacity >= 100 && id == 'lbDetailsContainer') {		try { object.removeAttribute("filter"); } catch(e) {}	/* Fix added for IE Alpha Opacity Filter bug. */		for (var i = 0; i < this.imageTimerCount; i++) { window.clearTimeout(this.imageTimerArray[i]); }		this.doc.getElementById('lbOverlay').style.height = this.getPageSize()[1] + "px";	} else {		if (id == 'lbOverlay') {			this.overlayTimerArray[this.overlayTimerCount++] = setTimeout("myLytebox.appear('" + id + "', " + (opacity+20) + ")", 1);		} else {			this.imageTimerArray[this.imageTimerCount++] = setTimeout("myLytebox.appear('" + id + "', " + (opacity+10) + ")", 1);		}	}};LyteBox.prototype.fade = function(id, opacity) {	var object = this.doc.getElementById(id).style;	object.opacity = (opacity / 100);	object.MozOpacity = (opacity / 100);	object.KhtmlOpacity = (opacity / 100);	object.filter = "alpha(opacity=" + opacity + ")";	if (opacity <= 0) {		try {			object.display = 'none';		} catch(err) { }	} else if (id == 'lbOverlay') {		this.overlayTimerArray[this.overlayTimerCount++] = setTimeout("myLytebox.fade('" + id + "', " + (opacity-20) + ")", 1);	} else {		this.timerIDArray[this.timerIDCount++] = setTimeout("myLytebox.fade('" + id + "', " + (opacity-10) + ")", 1);	}};LyteBox.prototype.resizeW = function(id, curW, maxW, pixelrate, speed) {	if (!this.hDone) {		this.resizeWTimerArray[this.resizeWTimerCount++] = setTimeout("myLytebox.resizeW('" + id + "', " + curW + ", " + maxW + ", " + pixelrate + ")", 100);		return;	}	var object = this.doc.getElementById(id);	var timer = speed ? speed : (this.resizeDuration/2);	var newW = (this.doAnimations ? curW : maxW);	object.style.width = (newW) + "px";	if (newW < maxW) {		newW += (newW + pixelrate >= maxW) ? (maxW - newW) : pixelrate;	} else if (newW > maxW) {		newW -= (newW - pixelrate <= maxW) ? (newW - maxW) : pixelrate;	}	this.resizeWTimerArray[this.resizeWTimerCount++] = setTimeout("myLytebox.resizeW('" + id + "', " + newW + ", " + maxW + ", " + pixelrate + ", " + (timer+0.02) + ")", timer+0.02);	if (parseInt(object.style.width) == maxW) {		this.wDone = true;		for (var i = 0; i < this.resizeWTimerCount; i++) { window.clearTimeout(this.resizeWTimerArray[i]); }	}};LyteBox.prototype.resizeH = function(id, curH, maxH, pixelrate, speed) {	var timer = speed ? speed : (this.resizeDuration/2);	var object = this.doc.getElementById(id);	var newH = (this.doAnimations ? curH : maxH);	object.style.height = (newH) + "px";	if (newH < maxH) {		newH += (newH + pixelrate >= maxH) ? (maxH - newH) : pixelrate;	} else if (newH > maxH) {		newH -= (newH - pixelrate <= maxH) ? (newH - maxH) : pixelrate;	}	this.resizeHTimerArray[this.resizeHTimerCount++] = setTimeout("myLytebox.resizeH('" + id + "', " + newH + ", " + maxH + ", " + pixelrate + ", " + (timer+.02) + ")", timer+.02);	if (parseInt(object.style.height) == maxH) {		this.hDone = true;		for (var i = 0; i < this.resizeHTimerCount; i++) { window.clearTimeout(this.resizeHTimerArray[i]); }	}};LyteBox.prototype.getPageScroll = function() {	if (self.pageYOffset) {		return this.isFrame ? parent.pageYOffset : self.pageYOffset;	} else if (this.doc.documentElement && this.doc.documentElement.scrollTop){		return this.doc.documentElement.scrollTop;	} else if (document.body) {		return this.doc.body.scrollTop;	}};LyteBox.prototype.getPageSize = function() {		var xScroll, yScroll, windowWidth, windowHeight;	if (window.innerHeight && window.scrollMaxY) {		xScroll = this.doc.scrollWidth;		yScroll = (this.isFrame ? parent.innerHeight : self.innerHeight) + (this.isFrame ? parent.scrollMaxY : self.scrollMaxY);	} else if (this.doc.body.scrollHeight > this.doc.body.offsetHeight){		xScroll = this.doc.body.scrollWidth;		yScroll = this.doc.body.scrollHeight;	} else {		xScroll = this.doc.getElementsByTagName("html").item(0).offsetWidth;		yScroll = this.doc.getElementsByTagName("html").item(0).offsetHeight;		xScroll = (xScroll < this.doc.body.offsetWidth) ? this.doc.body.offsetWidth : xScroll;		yScroll = (yScroll < this.doc.body.offsetHeight) ? this.doc.body.offsetHeight : yScroll;	}	if (self.innerHeight) {		windowWidth = (this.isFrame) ? parent.innerWidth : self.innerWidth;		windowHeight = (this.isFrame) ? parent.innerHeight : self.innerHeight;	} else if (document.documentElement && document.documentElement.clientHeight) {		windowWidth = this.doc.documentElement.clientWidth;		windowHeight = this.doc.documentElement.clientHeight;	} else if (document.body) {		windowWidth = this.doc.getElementsByTagName("html").item(0).clientWidth;		windowHeight = this.doc.getElementsByTagName("html").item(0).clientHeight;		windowWidth = (windowWidth == 0) ? this.doc.body.clientWidth : windowWidth;		windowHeight = (windowHeight == 0) ? this.doc.body.clientHeight : windowHeight;	}	var pageHeight = (yScroll < windowHeight) ? windowHeight : yScroll;	var pageWidth = (xScroll < windowWidth) ? windowWidth : xScroll;	return new Array(pageWidth, pageHeight, windowWidth, windowHeight);};LyteBox.prototype.toggleFlash = function(state) {	var objects = this.doc.getElementsByTagName("object");	for (var i = 0; i < objects.length; i++) {		objects[i].style.visibility = (state == "hide") ? 'hidden' : 'visible';	}	var embeds = this.doc.getElementsByTagName("embed");	for (var i = 0; i < embeds.length; i++) {		embeds[i].style.visibility = (state == "hide") ? 'hidden' : 'visible';	}	if (this.isFrame) {		for (var i = 0; i < parent.frames.length; i++) {			try {				objects = parent.frames[i].window.document.getElementsByTagName("object");				for (var j = 0; j < objects.length; j++) {					objects[j].style.visibility = (state == "hide") ? 'hidden' : 'visible';				}			} catch(e) { }			try {				embeds = parent.frames[i].window.document.getElementsByTagName("embed");				for (var j = 0; j < embeds.length; j++) {					embeds[j].style.visibility = (state == "hide") ? 'hidden' : 'visible';				}			} catch(e) { }		}	}};LyteBox.prototype.toggleSelects = function(state) {	var selects = this.doc.getElementsByTagName("select");	for (var i = 0; i < selects.length; i++ ) {		selects[i].style.visibility = (state == "hide") ? 'hidden' : 'visible';	}	if (this.isFrame) {		for (var i = 0; i < parent.frames.length; i++) {			try {				selects = parent.frames[i].window.document.getElementsByTagName("select");				for (var j = 0; j < selects.length; j++) {					selects[j].style.visibility = (state == "hide") ? 'hidden' : 'visible';				}			} catch(e) { }		}	}};LyteBox.prototype.pause = function(numberMillis) {	var now = new Date();	var exitTime = now.getTime() + numberMillis;	while (true) {		now = new Date();		if (now.getTime() > exitTime) { return; }	}};if (window.addEventListener) {	window.addEventListener("load",initLytebox,false);} else if (window.attachEvent) {	window.attachEvent("onload",initLytebox);} else {	window.onload = function() {initLytebox();}}function initLytebox() { myLytebox = new LyteBox(); }//--></script>   		<link rel="stylesheet" href="http://www.univ-nantes.fr/jsp/scripts/lytebox/lytebox.css" type="text/css" media="screen" />		<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js"></script>                <script type="text/javascript">                        addthis_pub             = 'UnivNantes';                        addthis_logo_background = '020a23';                        addthis_logo_color      = '020a23';                        addthis_language        = 'fr';                        var addthis_localize = {                                share_caption: "Partager"                        };                </script>        </head>        <script type="text/javascript"  style="display:none"><!--document.write('<body class="pagelibre interieur institutionnel institutionnel" id="body">');//--></script>		<p id="acces_direct"><a href="#contenu_sans_nav_avec_encadres" accesskey="s">Acc&egrave;s direct au contenu</a></p>		<div id="bandeau">		        <script type="text/javascript" src="http://www.univ-nantes.fr/jsp/template/elements_externes.jsp?LANGUE=0&ELEMENT=recherche&RUBRIQUE=ENS"></script>		        <script type="text/javascript"  style="display:none"><!--					 			document.write('<h1><a href="http://www.univ-nantes.fr/36392593/0/fiche___pagelibre/&amp;RF=INSTITUTIONNEL_FR" title="Retour &agrave; la page d\'accueil" accesskey="1"><img src="http://www.univ-nantes.fr/images/logo.png?new=2012050301" alt="Site de l\'Université" /></a></h1>');		//--></script>			<script type="text/javascript" src="http://www.univ-nantes.fr/jsp/template/elements_externes.jsp?LANGUE=0&RUBRIQUE=ENS&ELEMENT=accespratiques"></script>		<script type="text/javascript" src="http://www.univ-nantes.fr/jsp/template/elements_externes.jsp?LANGUE=0&RUBRIQUE=ENS&ELEMENT=langue"></script>					</div> <!-- #bandeau -->		<div id="menu">			                           <script type="text/javascript" src="http://www.univ-nantes.fr/jsp/template/elements_externes.jsp?LANGUE=0&RUBRIQUE=ENS&ELEMENT=menuprincipal"></script>                  			</div><!-- #menu -->						<div id="page">			<p id="fil_ariane">&nbsp;</p>			<div id="contenu_deco" class="contenu_sans_nav_avec_encadres">				<h2>D&eacute;mo</h2>				<div id="bookmarks_texte">				        <script type="text/javascript"  style="display:none"><!--		document.write('				<div class="addthis_toolbox addthis_default_style addthis_16x16_style">');		document.write('					<a class="addthis_button_twitter" tw:via="UnivNantes"></a>');		document.write('					<a class="addthis_button_facebook"></a>');		document.write('					<a class="addthis_button_google_plusone_share"></a>');		document.write('					<a class="addthis_button_email"></a>');		document.write('					<a class="addthis_button_compact"></a>');		document.write('					<a class="addthis_counter addthis_bubble_style"></a>');		document.write('				</div>');//--></script>				</div><!-- #bookmarks_texte -->